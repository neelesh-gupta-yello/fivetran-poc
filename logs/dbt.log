2022-07-30 22:55:08.728042 (MainThread): Running with dbt=0.19.1
2022-07-30 22:55:12.588832 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 22:55:12.676083 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 22:55:12.678490 (MainThread): Tracking: tracking
2022-07-30 22:55:12.679147 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f6aa320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14a8ace10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f6d17b8>]}
2022-07-30 22:55:12.712783 (MainThread): Partial parsing not enabled
2022-07-30 22:55:12.716093 (MainThread): Parsing macros/catalog.sql
2022-07-30 22:55:12.720544 (MainThread): Parsing macros/adapters.sql
2022-07-30 22:55:12.762417 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 22:55:12.766126 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 22:55:12.769683 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 22:55:12.776329 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 22:55:12.795761 (MainThread): Parsing macros/core.sql
2022-07-30 22:55:12.802622 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 22:55:12.817001 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 22:55:12.821379 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 22:55:12.895682 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 22:55:12.932282 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 22:55:12.957262 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 22:55:12.961570 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 22:55:12.970834 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 22:55:12.987025 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 22:55:12.996213 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 22:55:13.005051 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 22:55:13.012736 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 22:55:13.015751 (MainThread): Parsing macros/etc/query.sql
2022-07-30 22:55:13.018993 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 22:55:13.022815 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 22:55:13.034343 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 22:55:13.038338 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 22:55:13.042556 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 22:55:13.090686 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 22:55:13.095124 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 22:55:13.099043 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 22:55:13.103628 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 22:55:13.114288 (MainThread): Partial parsing not enabled
2022-07-30 22:55:13.152646 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 22:55:13.167655 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 22:55:13.292437 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '799dbf0c-58a1-4ec0-92e0-342d8bc7f68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f9a6358>]}
2022-07-30 22:55:13.297984 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '799dbf0c-58a1-4ec0-92e0-342d8bc7f68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f65f6a0>]}
2022-07-30 22:55:13.298224 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 22:55:13.298886 (MainThread): 
2022-07-30 22:55:13.299250 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 22:55:13.300440 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-30 22:55:13.318883 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-30 22:55:13.319025 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-30 22:55:13.319107 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 22:55:14.858382 (ThreadPoolExecutor-0_0): Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/2.2.8 (Darwin-20.5.0-x86_64-i386-64bit) CPython/3.6.13', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "2.2.8", "SVN_REVISION": null, "ACCOUNT_NAME": "zs12696", "LOGIN_NAME": "neeleshguptayello", "CLIENT_ENVIRONMENT": {"APPLICATION": "dbt", "OS": "Darwin", "OS_VERSION": "Darwin-20.5.0-x86_64-i386-64bit", "PYTHON_VERSION": "3.6.13", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC Clang 10.0.0 ", "OCSP_MODE": "FAIL_OPEN", "TRACING": 40, "LOGIN_TIMEOUT": 120, "NETWORK_TIMEOUT": null, "CLIENT_STORE_TEMPORARY_CREDENTIAL": null}, "PASSWORD": "********", "SESSION_PARAMETERS": {"AUTOCOMMIT": false, "CLIENT_SESSION_KEEP_ALIVE_HEARTBEAT_FREQUENCY": 900, "CLIENT_PREFETCH_THREADS": 4}}}
2022-07-30 22:55:14.858582 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3'
2022-07-30 22:55:14.858677 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-30 22:55:14.858741 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 22:55:14.858856 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-07-30 22:55:14.858915 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 22:55:14.859014 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: No close available on handle
2022-07-30 22:55:14.859476 (MainThread): Connection 'master' was properly closed.
2022-07-30 22:55:14.859559 (MainThread): Connection 'list_COMBINE_DW' was properly closed.
2022-07-30 22:55:14.859693 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f97b780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f949a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa14f65f6a0>]}
2022-07-30 22:55:14.859866 (MainThread): Flushing usage events
2022-07-30 22:55:15.266204 (MainThread): Encountered an error:
2022-07-30 22:55:15.266441 (MainThread): Runtime Error
  Database error while listing schemas in database "COMBINE_DW"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3
2022-07-30 22:55:15.323766 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 213, in open
    **creds.auth_args()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 223, in __init__
    self.connect(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 418, in connect
    self.__open_connection()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 615, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 819, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 849, in __authenticate
    session_parameters=self._session_parameters,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/auth.py", line 216, in authenticate
    socket_timeout=self._rest._connection.login_timeout)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 491, in _post_request
    _include_retry_params=_include_retry_params)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 568, in fetch
    **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 677, in _request_exec_wrapper
    raise e
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 610, in _request_exec_wrapper
    method, full_url, headers, data, conn)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 721, in _handle_unknown_error
    'errno': ER_FAILED_TO_REQUEST,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 126, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.OperationalError: 250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 103, in list_schemas
    kwargs={'database': database}
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "COMBINE_DW"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=24aa065b-7b8e-4084-9835-c70d94ffaf63&databaseName=COMBINE_DW&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=2250d44b-affa-46f0-8eac-93f13ecb87b3

2022-07-30 23:00:33.352215 (MainThread): Running with dbt=0.19.1
2022-07-30 23:00:34.227233 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:00:34.295473 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:00:34.299075 (MainThread): Tracking: tracking
2022-07-30 23:00:34.299614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc46b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d68ace10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc482780>]}
2022-07-30 23:00:34.314513 (MainThread): Partial parsing not enabled
2022-07-30 23:00:34.316154 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:00:34.318927 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:00:34.349883 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:00:34.352491 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:00:34.354426 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:00:34.358766 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:00:34.370772 (MainThread): Parsing macros/core.sql
2022-07-30 23:00:34.375096 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:00:34.384696 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:00:34.386688 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:00:34.491144 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:00:34.533250 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:00:34.554896 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:00:34.557005 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:00:34.563834 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:00:34.578766 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:00:34.586428 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:00:34.593122 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:00:34.599218 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:00:34.600485 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:00:34.601746 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:00:34.603798 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:00:34.613507 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:00:34.616434 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:00:34.618430 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:00:34.660786 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:00:34.663111 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:00:34.664871 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:00:34.667089 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:00:34.675492 (MainThread): Partial parsing not enabled
2022-07-30 23:00:34.697287 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:00:34.706905 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:00:34.774185 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a81d464-0872-4be3-8978-65bfcafdee5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc8a5358>]}
2022-07-30 23:00:34.783549 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a81d464-0872-4be3-8978-65bfcafdee5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80da6a2438>]}
2022-07-30 23:00:34.783871 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:00:34.784575 (MainThread): 
2022-07-30 23:00:34.784883 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:00:34.785709 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:00:34.797419 (ThreadPoolExecutor-0_0): Using snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:00:34.797554 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:00:34.797629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:00:35.931319 (ThreadPoolExecutor-0_0): Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/2.2.8 (Darwin-20.5.0-x86_64-i386-64bit) CPython/3.6.13', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "2.2.8", "SVN_REVISION": null, "ACCOUNT_NAME": "zs12696", "LOGIN_NAME": "neeleshguptayello", "CLIENT_ENVIRONMENT": {"APPLICATION": "dbt", "OS": "Darwin", "OS_VERSION": "Darwin-20.5.0-x86_64-i386-64bit", "PYTHON_VERSION": "3.6.13", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC Clang 10.0.0 ", "OCSP_MODE": "FAIL_OPEN", "TRACING": 40, "LOGIN_TIMEOUT": 120, "NETWORK_TIMEOUT": null, "CLIENT_STORE_TEMPORARY_CREDENTIAL": null}, "PASSWORD": "********", "SESSION_PARAMETERS": {"AUTOCOMMIT": false, "CLIENT_SESSION_KEEP_ALIVE_HEARTBEAT_FREQUENCY": 900, "CLIENT_PREFETCH_THREADS": 4}}}
2022-07-30 23:00:35.931504 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1'
2022-07-30 23:00:35.931595 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:00:35.931655 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:00:35.931764 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-07-30 23:00:35.931818 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:00:35.931913 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: No close available on handle
2022-07-30 23:00:35.932463 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:00:35.932544 (MainThread): Connection 'list_FIVETRAN_DATABASE' was properly closed.
2022-07-30 23:00:35.932677 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc854ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc4219b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80dc8d0c88>]}
2022-07-30 23:00:35.932828 (MainThread): Flushing usage events
2022-07-30 23:00:36.347004 (MainThread): Encountered an error:
2022-07-30 23:00:36.347284 (MainThread): Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1
2022-07-30 23:00:36.357254 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 213, in open
    **creds.auth_args()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 223, in __init__
    self.connect(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 418, in connect
    self.__open_connection()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 615, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 819, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 849, in __authenticate
    session_parameters=self._session_parameters,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/auth.py", line 216, in authenticate
    socket_timeout=self._rest._connection.login_timeout)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 491, in _post_request
    _include_retry_params=_include_retry_params)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 568, in fetch
    **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 677, in _request_exec_wrapper
    raise e
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 610, in _request_exec_wrapper
    method, full_url, headers, data, conn)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 721, in _handle_unknown_error
    'errno': ER_FAILED_TO_REQUEST,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 126, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.OperationalError: 250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 103, in list_schemas
    kwargs={'database': database}
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=e6b142bf-6708-4dbd-ad12-776f40c71b15&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=3896a094-301c-46d1-afe9-3ce27ae919d1

2022-07-30 23:04:00.673319 (MainThread): Running with dbt=0.19.1
2022-07-30 23:04:01.607455 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:04:01.671139 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:04:01.675044 (MainThread): Tracking: tracking
2022-07-30 23:04:01.675691 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e64faeb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e64faf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e64facf8>]}
2022-07-30 23:04:01.688983 (MainThread): Partial parsing not enabled
2022-07-30 23:04:01.690567 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:04:01.693235 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:04:01.724113 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:04:01.726437 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:04:01.728217 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:04:01.734022 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:04:01.747588 (MainThread): Parsing macros/core.sql
2022-07-30 23:04:01.751837 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:04:01.761014 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:04:01.763070 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:04:01.866459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:04:01.906809 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:04:01.928455 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:04:01.930661 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:04:01.936874 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:04:01.951047 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:04:01.958298 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:04:01.964345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:04:01.969669 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:04:01.970835 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:04:01.972207 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:04:01.974502 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:04:01.983338 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:04:01.985547 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:04:01.987460 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:04:02.028401 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:04:02.030692 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:04:02.032676 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:04:02.034519 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:04:02.042753 (MainThread): Partial parsing not enabled
2022-07-30 23:04:02.063694 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:04:02.073641 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:04:02.140163 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef4352e7-5c3d-4e44-9a21-1563bf4e0f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e680e2b0>]}
2022-07-30 23:04:02.144877 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef4352e7-5c3d-4e44-9a21-1563bf4e0f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e46a9710>]}
2022-07-30 23:04:02.145233 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:04:02.146073 (MainThread): 
2022-07-30 23:04:02.146427 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:04:02.147290 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:04:02.158897 (ThreadPoolExecutor-0_0): Using snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:04:02.159035 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:04:02.159114 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:04:03.347846 (ThreadPoolExecutor-0_0): Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/2.2.8 (Darwin-20.5.0-x86_64-i386-64bit) CPython/3.6.13', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "2.2.8", "SVN_REVISION": null, "ACCOUNT_NAME": "zs12696", "LOGIN_NAME": "FIVETRAN_USER", "CLIENT_ENVIRONMENT": {"APPLICATION": "dbt", "OS": "Darwin", "OS_VERSION": "Darwin-20.5.0-x86_64-i386-64bit", "PYTHON_VERSION": "3.6.13", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC Clang 10.0.0 ", "OCSP_MODE": "FAIL_OPEN", "TRACING": 40, "LOGIN_TIMEOUT": 120, "NETWORK_TIMEOUT": null, "CLIENT_STORE_TEMPORARY_CREDENTIAL": null}, "PASSWORD": "********", "SESSION_PARAMETERS": {"AUTOCOMMIT": false, "CLIENT_SESSION_KEEP_ALIVE_HEARTBEAT_FREQUENCY": 900, "CLIENT_PREFETCH_THREADS": 4}}}
2022-07-30 23:04:03.348020 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545'
2022-07-30 23:04:03.348115 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:04:03.348175 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:04:03.348282 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-07-30 23:04:03.348337 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:04:03.348430 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: No close available on handle
2022-07-30 23:04:03.348953 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:04:03.349081 (MainThread): Connection 'list_FIVETRAN_DATABASE' was properly closed.
2022-07-30 23:04:03.349242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e67db5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e67a0438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e6c203c8>]}
2022-07-30 23:04:03.349497 (MainThread): Flushing usage events
2022-07-30 23:04:03.742134 (MainThread): Encountered an error:
2022-07-30 23:04:03.742515 (MainThread): Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545
2022-07-30 23:04:03.753447 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 213, in open
    **creds.auth_args()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 223, in __init__
    self.connect(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 418, in connect
    self.__open_connection()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 615, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 819, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 849, in __authenticate
    session_parameters=self._session_parameters,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/auth.py", line 216, in authenticate
    socket_timeout=self._rest._connection.login_timeout)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 491, in _post_request
    _include_retry_params=_include_retry_params)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 568, in fetch
    **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 677, in _request_exec_wrapper
    raise e
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 610, in _request_exec_wrapper
    method, full_url, headers, data, conn)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 721, in _handle_unknown_error
    'errno': ER_FAILED_TO_REQUEST,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 126, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.OperationalError: 250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 103, in list_schemas
    kwargs={'database': database}
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=79fe0d93-9141-4517-8502-8d5bf613c93a&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=10fa477d-7e29-4dfa-84c0-72d9fc06e545

2022-07-30 23:08:13.492790 (MainThread): Running with dbt=0.19.1
2022-07-30 23:08:14.447865 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:08:14.512428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:08:14.515885 (MainThread): Tracking: tracking
2022-07-30 23:08:14.516582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a59d671d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a548ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a59d87780>]}
2022-07-30 23:08:14.530307 (MainThread): Partial parsing not enabled
2022-07-30 23:08:14.531983 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:08:14.534626 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:08:14.565111 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:08:14.567577 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:08:14.569424 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:08:14.573903 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:08:14.586814 (MainThread): Parsing macros/core.sql
2022-07-30 23:08:14.590921 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:08:14.599743 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:08:14.601724 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:08:14.706007 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:08:14.746737 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:08:14.768304 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:08:14.770394 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:08:14.776882 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:08:14.792001 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:08:14.799231 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:08:14.805537 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:08:14.811241 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:08:14.812530 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:08:14.813785 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:08:14.815572 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:08:14.824421 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:08:14.827013 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:08:14.828935 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:08:14.870107 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:08:14.872161 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:08:14.873797 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:08:14.875766 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:08:14.884386 (MainThread): Partial parsing not enabled
2022-07-30 23:08:14.908326 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:08:14.918862 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:08:14.985175 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc9a83bd-1c98-4575-ace4-c014df83cef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5a066320>]}
2022-07-30 23:08:14.993489 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc9a83bd-1c98-4575-ace4-c014df83cef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a59ee25c0>]}
2022-07-30 23:08:14.993758 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:08:14.994443 (MainThread): 
2022-07-30 23:08:14.994743 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:08:14.995562 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:08:15.006967 (ThreadPoolExecutor-0_0): Using snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:08:15.007089 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:08:15.007163 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:08:16.210463 (ThreadPoolExecutor-0_0): Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/2.2.8 (Darwin-20.5.0-x86_64-i386-64bit) CPython/3.6.13', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "2.2.8", "SVN_REVISION": null, "ACCOUNT_NAME": "zs12696", "LOGIN_NAME": "FIVETRAN_USER", "CLIENT_ENVIRONMENT": {"APPLICATION": "dbt", "OS": "Darwin", "OS_VERSION": "Darwin-20.5.0-x86_64-i386-64bit", "PYTHON_VERSION": "3.6.13", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC Clang 10.0.0 ", "OCSP_MODE": "FAIL_OPEN", "TRACING": 40, "LOGIN_TIMEOUT": 120, "NETWORK_TIMEOUT": null, "CLIENT_STORE_TEMPORARY_CREDENTIAL": null}, "PASSWORD": "********", "SESSION_PARAMETERS": {"AUTOCOMMIT": false, "CLIENT_SESSION_KEEP_ALIVE_HEARTBEAT_FREQUENCY": 900, "CLIENT_PREFETCH_THREADS": 4}}}
2022-07-30 23:08:16.210644 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7'
2022-07-30 23:08:16.210728 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:08:16.210783 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:08:16.210885 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-07-30 23:08:16.210936 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:08:16.211025 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: No close available on handle
2022-07-30 23:08:16.211637 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:08:16.211710 (MainThread): Connection 'list_FIVETRAN_DATABASE' was properly closed.
2022-07-30 23:08:16.211850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a59ee25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5a02a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5a379358>]}
2022-07-30 23:08:16.211995 (MainThread): Flushing usage events
2022-07-30 23:08:16.639937 (MainThread): Encountered an error:
2022-07-30 23:08:16.640200 (MainThread): Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7
2022-07-30 23:08:16.650342 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 213, in open
    **creds.auth_args()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 223, in __init__
    self.connect(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 418, in connect
    self.__open_connection()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 615, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 819, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 849, in __authenticate
    session_parameters=self._session_parameters,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/auth.py", line 216, in authenticate
    socket_timeout=self._rest._connection.login_timeout)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 491, in _post_request
    _include_retry_params=_include_retry_params)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 568, in fetch
    **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 677, in _request_exec_wrapper
    raise e
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 610, in _request_exec_wrapper
    method, full_url, headers, data, conn)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 721, in _handle_unknown_error
    'errno': ER_FAILED_TO_REQUEST,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 126, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.OperationalError: 250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 103, in list_schemas
    kwargs={'database': database}
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=da910689-adc5-4334-adbf-885dad0dcf27&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=FIVETRAN_ROLE&request_guid=cc6f9567-8232-4eba-acd6-564390afe7e7

2022-07-30 23:09:43.744587 (MainThread): Running with dbt=0.19.1
2022-07-30 23:09:44.760101 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:09:44.822511 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:09:44.824722 (MainThread): Tracking: tracking
2022-07-30 23:09:44.825314 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6644fcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc618ace10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66488be0>]}
2022-07-30 23:09:44.839410 (MainThread): Partial parsing not enabled
2022-07-30 23:09:44.842297 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:09:44.844914 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:09:44.874940 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:09:44.877272 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:09:44.878968 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:09:44.883116 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:09:44.898182 (MainThread): Parsing macros/core.sql
2022-07-30 23:09:44.902824 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:09:44.912505 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:09:44.914467 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:09:44.998421 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:09:45.033754 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:09:45.054768 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:09:45.057000 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:09:45.063388 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:09:45.076921 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:09:45.083917 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:09:45.090612 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:09:45.095558 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:09:45.096676 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:09:45.097891 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:09:45.099624 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:09:45.108616 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:09:45.111087 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:09:45.112905 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:09:45.155376 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:09:45.157452 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:09:45.159349 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:09:45.161340 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:09:45.169347 (MainThread): Partial parsing not enabled
2022-07-30 23:09:45.191169 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:09:45.200596 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:09:45.266845 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61bdeb3d-da76-414f-81dd-ecbff07841d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66965358>]}
2022-07-30 23:09:45.271971 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61bdeb3d-da76-414f-81dd-ecbff07841d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66425a20>]}
2022-07-30 23:09:45.272386 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:09:45.273338 (MainThread): 
2022-07-30 23:09:45.273763 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:09:45.274592 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:09:45.285719 (ThreadPoolExecutor-0_0): Using snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:09:45.285821 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:09:45.285894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:09:46.393744 (ThreadPoolExecutor-0_0): Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159, headers:{'Content-Type': 'application/json', 'accept': 'application/snowflake', 'User-Agent': 'PythonConnector/2.2.8 (Darwin-20.5.0-x86_64-i386-64bit) CPython/3.6.13', 'Content-Encoding': 'gzip'}, data: {"data": {"CLIENT_APP_ID": "PythonConnector", "CLIENT_APP_VERSION": "2.2.8", "SVN_REVISION": null, "ACCOUNT_NAME": "zs12696", "LOGIN_NAME": "FIVETRAN_USER", "CLIENT_ENVIRONMENT": {"APPLICATION": "dbt", "OS": "Darwin", "OS_VERSION": "Darwin-20.5.0-x86_64-i386-64bit", "PYTHON_VERSION": "3.6.13", "PYTHON_RUNTIME": "CPython", "PYTHON_COMPILER": "GCC Clang 10.0.0 ", "OCSP_MODE": "FAIL_OPEN", "TRACING": 40, "LOGIN_TIMEOUT": 120, "NETWORK_TIMEOUT": null, "CLIENT_STORE_TEMPORARY_CREDENTIAL": null}, "PASSWORD": "********", "SESSION_PARAMETERS": {"AUTOCOMMIT": false, "CLIENT_SESSION_KEEP_ALIVE_HEARTBEAT_FREQUENCY": 900, "CLIENT_PREFETCH_THREADS": 4}}}
2022-07-30 23:09:46.393929 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159'
2022-07-30 23:09:46.394018 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:09:46.394079 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:09:46.394190 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-07-30 23:09:46.394246 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-07-30 23:09:46.394340 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: No close available on handle
2022-07-30 23:09:46.394837 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:09:46.394918 (MainThread): Connection 'list_FIVETRAN_DATABASE' was properly closed.
2022-07-30 23:09:46.395045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc668bb358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc669326a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6698ef98>]}
2022-07-30 23:09:46.395199 (MainThread): Flushing usage events
2022-07-30 23:09:46.787007 (MainThread): Encountered an error:
2022-07-30 23:09:46.787335 (MainThread): Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159
2022-07-30 23:09:46.797130 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 213, in open
    **creds.auth_args()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 223, in __init__
    self.connect(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 418, in connect
    self.__open_connection()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 615, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 819, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/connection.py", line 849, in __authenticate
    session_parameters=self._session_parameters,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/auth.py", line 216, in authenticate
    socket_timeout=self._rest._connection.login_timeout)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 491, in _post_request
    _include_retry_params=_include_retry_params)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 568, in fetch
    **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 677, in _request_exec_wrapper
    raise e
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 610, in _request_exec_wrapper
    method, full_url, headers, data, conn)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/network.py", line 721, in _handle_unknown_error
    'errno': ER_FAILED_TO_REQUEST,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 126, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.OperationalError: 250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 103, in list_schemas
    kwargs={'database': database}
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 425, in result
    return self.__get_result()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/_base.py", line 384, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "FIVETRAN_DATABASE"
  Database Error
    250003: Failed to get the response. Hanging? method: post, url: https://zs12696.us-east-2.snowflakecomputing.com:443/session/v1/login-request?request_id=4b90bd63-4831-46d2-bb78-a6449d24fc28&databaseName=FIVETRAN_DATABASE&schemaName=PUBLIC&warehouse=FIVETRAN_WAREHOUSE&roleName=FIVETRAN_ROLE&request_guid=d2895009-e037-4c7d-adec-fd1feea59159

2022-07-30 23:18:48.366354 (MainThread): Running with dbt=0.19.1
2022-07-30 23:18:49.288037 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:18:49.353664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:18:49.359905 (MainThread): Tracking: tracking
2022-07-30 23:18:49.360556 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b2da7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2adfbbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b2dd0ba8>]}
2022-07-30 23:18:49.374570 (MainThread): Partial parsing not enabled
2022-07-30 23:18:49.376429 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:18:49.379679 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:18:49.411356 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:18:49.413913 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:18:49.415834 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:18:49.420445 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:18:49.433077 (MainThread): Parsing macros/core.sql
2022-07-30 23:18:49.438495 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:18:49.448400 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:18:49.450725 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:18:49.554380 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:18:49.594166 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:18:49.616074 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:18:49.618566 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:18:49.625285 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:18:49.640192 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:18:49.647329 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:18:49.654103 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:18:49.659712 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:18:49.661617 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:18:49.663213 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:18:49.665308 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:18:49.675197 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:18:49.677992 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:18:49.680219 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:18:49.723520 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:18:49.726189 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:18:49.728357 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:18:49.730579 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:18:49.741432 (MainThread): Partial parsing not enabled
2022-07-30 23:18:49.764407 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:18:49.775710 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:18:49.842181 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17098481-6488-4aa0-9531-74b096bfbaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b30a6320>]}
2022-07-30 23:18:49.846780 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17098481-6488-4aa0-9531-74b096bfbaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b100b240>]}
2022-07-30 23:18:49.847062 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:18:49.847737 (MainThread): 
2022-07-30 23:18:49.848032 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:18:49.848885 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:18:49.860654 (ThreadPoolExecutor-0_0): Using snowflake connection "list_FIVETRAN_DATABASE".
2022-07-30 23:18:49.860795 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE"} */

    show terse schemas in database FIVETRAN_DATABASE
    limit 10000
2022-07-30 23:18:49.860872 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:18:50.904385 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 6 in 1.04 seconds
2022-07-30 23:18:50.906262 (ThreadPoolExecutor-0_0): On list_FIVETRAN_DATABASE: Close
2022-07-30 23:18:51.024718 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_FIVETRAN_DATABASE_PUBLIC".
2022-07-30 23:18:51.033014 (ThreadPoolExecutor-1_0): Using snowflake connection "list_FIVETRAN_DATABASE_PUBLIC".
2022-07-30 23:18:51.033153 (ThreadPoolExecutor-1_0): On list_FIVETRAN_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_FIVETRAN_DATABASE_PUBLIC"} */

    show terse objects in FIVETRAN_DATABASE.PUBLIC
2022-07-30 23:18:51.033243 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-30 23:18:51.706495 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.67 seconds
2022-07-30 23:18:51.706966 (ThreadPoolExecutor-1_0): On list_FIVETRAN_DATABASE_PUBLIC: Close
2022-07-30 23:18:51.836466 (MainThread): Using snowflake connection "master".
2022-07-30 23:18:51.836618 (MainThread): On master: BEGIN
2022-07-30 23:18:51.836697 (MainThread): Opening a new connection, currently in state init
2022-07-30 23:18:52.367573 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-30 23:18:52.367771 (MainThread): On master: COMMIT
2022-07-30 23:18:52.367919 (MainThread): Using snowflake connection "master".
2022-07-30 23:18:52.367994 (MainThread): On master: COMMIT
2022-07-30 23:18:52.501809 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:18:52.501991 (MainThread): On master: Close
2022-07-30 23:18:52.631514 (MainThread): 18:18:52 | Concurrency: 8 threads (target='dev')
2022-07-30 23:18:52.631700 (MainThread): 18:18:52 | 
2022-07-30 23:18:52.632908 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-30 23:18:52.633165 (Thread-1): 18:18:52 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-30 23:18:52.633438 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:18:52.633545 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-30 23:18:52.635956 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:18:52.636606 (Thread-1): finished collecting timing info
2022-07-30 23:18:52.665219 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:18:52.666644 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:18:52.666808 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-07-30 23:18:52.666931 (Thread-1): Opening a new connection, currently in state closed
2022-07-30 23:18:53.221719 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2022-07-30 23:18:53.221890 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:18:53.221972 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table FIVETRAN_DATABASE.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-30 23:18:53.312188 (Thread-1): Snowflake query id: 01a5f656-0000-af4d-0002-a3d60001511e
2022-07-30 23:18:53.312324 (Thread-1): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
2022-07-30 23:18:53.312450 (Thread-1): finished collecting timing info
2022-07-30 23:18:53.312568 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2022-07-30 23:18:53.436902 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-07-30 23:18:53.558538 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2022-07-30 23:18:53.578777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17098481-6488-4aa0-9531-74b096bfbaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b33217f0>]}
2022-07-30 23:18:53.579109 (Thread-1): 18:18:53 | 1 of 2 ERROR creating table model PUBLIC.my_first_dbt_model.......... [ERROR in 0.95s]
2022-07-30 23:18:53.579232 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-30 23:18:53.579618 (Thread-2): Began running node model.my_new_project.my_second_dbt_model
2022-07-30 23:18:53.579758 (Thread-2): 18:18:53 | 2 of 2 SKIP relation PUBLIC.my_second_dbt_model...................... [SKIP]
2022-07-30 23:18:53.579870 (Thread-2): Finished running node model.my_new_project.my_second_dbt_model
2022-07-30 23:18:53.653229 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:18:53.653827 (MainThread): Using snowflake connection "master".
2022-07-30 23:18:53.654076 (MainThread): On master: BEGIN
2022-07-30 23:18:53.654314 (MainThread): Opening a new connection, currently in state closed
2022-07-30 23:18:54.166905 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-30 23:18:54.167369 (MainThread): On master: COMMIT
2022-07-30 23:18:54.167750 (MainThread): Using snowflake connection "master".
2022-07-30 23:18:54.167904 (MainThread): On master: COMMIT
2022-07-30 23:18:54.312813 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-30 23:18:54.313259 (MainThread): On master: Close
2022-07-30 23:18:54.787790 (MainThread): 18:18:54 | 
2022-07-30 23:18:54.788037 (MainThread): 18:18:54 | Finished running 1 table model, 1 view model in 4.94s.
2022-07-30 23:18:54.788194 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:18:54.788304 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-30 23:18:54.797276 (MainThread): 
2022-07-30 23:18:54.797478 (MainThread): Completed with 1 error and 0 warnings:
2022-07-30 23:18:54.797613 (MainThread): 
2022-07-30 23:18:54.797733 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2022-07-30 23:18:54.797841 (MainThread):   003001 (42501): SQL access control error:
2022-07-30 23:18:54.797939 (MainThread):   Insufficient privileges to operate on schema 'PUBLIC'
2022-07-30 23:18:54.798035 (MainThread):   compiled SQL at target/run/my_new_project/models/example/my_first_dbt_model.sql
2022-07-30 23:18:54.798139 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2022-07-30 23:18:54.798325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b2f04240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2adfbbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b309c048>]}
2022-07-30 23:18:54.798544 (MainThread): Flushing usage events
2022-07-30 23:20:30.837641 (MainThread): Running with dbt=0.19.1
2022-07-30 23:20:31.741651 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:20:31.805986 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:20:31.809635 (MainThread): Tracking: tracking
2022-07-30 23:20:31.810381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b618d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b66d80b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b66d807f0>]}
2022-07-30 23:20:31.823401 (MainThread): Partial parsing not enabled
2022-07-30 23:20:31.824955 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:20:31.827689 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:20:31.858585 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:20:31.861160 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:20:31.862933 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:20:31.867186 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:20:31.879861 (MainThread): Parsing macros/core.sql
2022-07-30 23:20:31.884053 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:20:31.893044 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:20:31.894925 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:20:31.997260 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:20:32.036848 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:20:32.058256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:20:32.060347 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:20:32.066898 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:20:32.081027 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:20:32.088167 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:20:32.094640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:20:32.099588 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:20:32.100699 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:20:32.101894 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:20:32.103630 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:20:32.113000 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:20:32.115284 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:20:32.117269 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:20:32.161812 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:20:32.163932 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:20:32.165647 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:20:32.167476 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:20:32.175910 (MainThread): Partial parsing not enabled
2022-07-30 23:20:32.196828 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:20:32.206234 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:20:32.272755 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e2bafe-a448-4ce8-a4ce-4763790dafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67166550>]}
2022-07-30 23:20:32.279208 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e2bafe-a448-4ce8-a4ce-4763790dafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b66d1f550>]}
2022-07-30 23:20:32.279488 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:20:32.280183 (MainThread): 
2022-07-30 23:20:32.280483 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:20:32.281302 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-30 23:20:32.292771 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-30 23:20:32.292892 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-30 23:20:32.292969 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:20:32.943380 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.65 seconds
2022-07-30 23:20:32.946808 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-30 23:20:33.071116 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:20:33.077525 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:20:33.077671 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-30 23:20:33.077750 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-30 23:20:33.818372 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.74 seconds
2022-07-30 23:20:33.819399 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-30 23:20:33.950678 (MainThread): Using snowflake connection "master".
2022-07-30 23:20:33.950853 (MainThread): On master: BEGIN
2022-07-30 23:20:33.950957 (MainThread): Opening a new connection, currently in state init
2022-07-30 23:20:34.753786 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2022-07-30 23:20:34.754239 (MainThread): On master: COMMIT
2022-07-30 23:20:34.754596 (MainThread): Using snowflake connection "master".
2022-07-30 23:20:34.754751 (MainThread): On master: COMMIT
2022-07-30 23:20:34.889826 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:20:34.890295 (MainThread): On master: Close
2022-07-30 23:20:35.014163 (MainThread): 18:20:35 | Concurrency: 8 threads (target='dev')
2022-07-30 23:20:35.014429 (MainThread): 18:20:35 | 
2022-07-30 23:20:35.016344 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-30 23:20:35.016710 (Thread-1): 18:20:35 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-30 23:20:35.017112 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:20:35.017300 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-30 23:20:35.020116 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:20:35.023046 (Thread-1): finished collecting timing info
2022-07-30 23:20:35.060781 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:20:35.063847 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:20:35.063968 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-07-30 23:20:35.064045 (Thread-1): Opening a new connection, currently in state closed
2022-07-30 23:20:35.729189 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2022-07-30 23:20:35.729350 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:20:35.729424 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-30 23:20:36.722782 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2022-07-30 23:20:36.725042 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:20:36.725324 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:20:36.725488 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:20:36.796589 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-30 23:20:36.810508 (Thread-1): finished collecting timing info
2022-07-30 23:20:36.810722 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-07-30 23:20:36.925348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e2bafe-a448-4ce8-a4ce-4763790dafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6737b4a8>]}
2022-07-30 23:20:36.925848 (Thread-1): 18:20:36 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.91s]
2022-07-30 23:20:36.926040 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-30 23:20:36.926537 (Thread-2): Began running node model.my_new_project.my_second_dbt_model
2022-07-30 23:20:36.926834 (Thread-2): 18:20:36 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-30 23:20:36.927228 (Thread-2): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:20:36.927382 (Thread-2): Compiling model.my_new_project.my_second_dbt_model
2022-07-30 23:20:36.930348 (Thread-2): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:20:36.930814 (Thread-2): finished collecting timing info
2022-07-30 23:20:36.952225 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:20:36.953058 (Thread-2): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:20:36.953160 (Thread-2): On model.my_new_project.my_second_dbt_model: BEGIN
2022-07-30 23:20:36.953245 (Thread-2): Opening a new connection, currently in state init
2022-07-30 23:20:37.462809 (Thread-2): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-30 23:20:37.463024 (Thread-2): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:20:37.463139 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-30 23:20:37.669528 (Thread-2): SQL status: SUCCESS 1 in 0.21 seconds
2022-07-30 23:20:37.670693 (Thread-2): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:20:37.670831 (Thread-2): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:20:37.670899 (Thread-2): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:20:37.752806 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-30 23:20:37.753523 (Thread-2): finished collecting timing info
2022-07-30 23:20:37.753656 (Thread-2): On model.my_new_project.my_second_dbt_model: Close
2022-07-30 23:20:37.877048 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e2bafe-a448-4ce8-a4ce-4763790dafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b673dca90>]}
2022-07-30 23:20:37.877555 (Thread-2): 18:20:37 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.95s]
2022-07-30 23:20:37.877750 (Thread-2): Finished running node model.my_new_project.my_second_dbt_model
2022-07-30 23:20:37.885027 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:20:37.885439 (MainThread): Using snowflake connection "master".
2022-07-30 23:20:37.885610 (MainThread): On master: BEGIN
2022-07-30 23:20:37.885765 (MainThread): Opening a new connection, currently in state closed
2022-07-30 23:20:38.415068 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-30 23:20:38.415392 (MainThread): On master: COMMIT
2022-07-30 23:20:38.415655 (MainThread): Using snowflake connection "master".
2022-07-30 23:20:38.415810 (MainThread): On master: COMMIT
2022-07-30 23:20:38.550543 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:20:38.550872 (MainThread): On master: Close
2022-07-30 23:20:38.669839 (MainThread): 18:20:38 | 
2022-07-30 23:20:38.670154 (MainThread): 18:20:38 | Finished running 1 table model, 1 view model in 6.39s.
2022-07-30 23:20:38.670350 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:20:38.670639 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-30 23:20:38.670789 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-30 23:20:38.681605 (MainThread): 
2022-07-30 23:20:38.681787 (MainThread): Completed successfully
2022-07-30 23:20:38.681903 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-07-30 23:20:38.682076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b674ade48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b67147be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b66ec4278>]}
2022-07-30 23:20:38.682270 (MainThread): Flushing usage events
2022-07-30 23:56:25.155938 (MainThread): Running with dbt=0.19.1
2022-07-30 23:56:26.641671 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:56:26.721026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:56:26.724628 (MainThread): Tracking: tracking
2022-07-30 23:56:26.725334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b59e6ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b55212e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b59e9dba8>]}
2022-07-30 23:56:26.745589 (MainThread): Partial parsing not enabled
2022-07-30 23:56:26.747569 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:56:26.751637 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:56:26.787192 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:56:26.790092 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:56:26.792911 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:56:26.797290 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:56:26.810721 (MainThread): Parsing macros/core.sql
2022-07-30 23:56:26.815147 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:56:26.825177 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:56:26.827480 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:56:26.906815 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:56:26.945421 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:56:26.969055 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:56:26.972290 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:56:26.980877 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:56:26.996998 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:56:27.005051 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:56:27.012465 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:56:27.018698 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:56:27.020289 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:56:27.022251 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:56:27.024542 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:56:27.035080 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:56:27.037883 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:56:27.040404 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:56:27.089175 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:56:27.091633 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:56:27.093862 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:56:27.096536 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:56:27.105435 (MainThread): Partial parsing not enabled
2022-07-30 23:56:27.129907 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:56:27.140854 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:56:27.145074 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:56:27.155166 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b59fac518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b59fe2908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b59fe2940>]}
2022-07-30 23:56:27.155419 (MainThread): Flushing usage events
2022-07-30 23:56:27.665204 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-30 23:56:27.665417 (MainThread): Encountered an error:
2022-07-30 23:56:27.665558 (MainThread): Compilation Error in model candidates (models/yello_dw/candidates.sql)
  Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
    line 15
      {% endif %}
2022-07-30 23:56:27.700064 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 15, in template
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
  line 15
    {% endif %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    native=native,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 504, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/yello_dw/candidates.sql)
  Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
    line 15
      {% endif %}

2022-07-30 23:57:16.483153 (MainThread): Running with dbt=0.19.1
2022-07-30 23:57:17.633034 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:57:17.702040 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:57:17.706368 (MainThread): Tracking: tracking
2022-07-30 23:57:17.706984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db56f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d69d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db584780>]}
2022-07-30 23:57:17.720379 (MainThread): Partial parsing not enabled
2022-07-30 23:57:17.722306 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:57:17.725058 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:57:17.756227 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:57:17.759334 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:57:17.761284 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:57:17.765541 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:57:17.777914 (MainThread): Parsing macros/core.sql
2022-07-30 23:57:17.782742 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:57:17.792478 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:57:17.794806 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:57:17.877080 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:57:17.914626 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:57:17.936713 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:57:17.939027 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:57:17.946077 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:57:17.960422 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:57:17.968003 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:57:17.974358 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:57:17.979990 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:57:17.981379 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:57:17.982839 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:57:17.985002 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:57:17.994314 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:57:17.996622 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:57:17.998757 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:57:18.040912 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:57:18.043802 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:57:18.045970 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:57:18.048315 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:57:18.056594 (MainThread): Partial parsing not enabled
2022-07-30 23:57:18.078513 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:57:18.088836 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:57:18.092739 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:57:18.160195 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0912388-b8a8-4203-8142-6aec471e2bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db865dd8>]}
2022-07-30 23:57:18.166060 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0912388-b8a8-4203-8142-6aec471e2bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db7b3710>]}
2022-07-30 23:57:18.166498 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:57:18.167297 (MainThread): 
2022-07-30 23:57:18.167626 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:57:18.168500 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-30 23:57:18.180627 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-30 23:57:18.180760 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-30 23:57:18.180839 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:57:19.019969 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.84 seconds
2022-07-30 23:57:19.023538 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-30 23:57:19.143892 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:57:19.150284 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:57:19.150420 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-30 23:57:19.150499 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-30 23:57:19.616444 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.47 seconds
2022-07-30 23:57:19.637632 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-30 23:57:19.747890 (MainThread): Using snowflake connection "master".
2022-07-30 23:57:19.748098 (MainThread): On master: BEGIN
2022-07-30 23:57:19.748226 (MainThread): Opening a new connection, currently in state init
2022-07-30 23:57:20.235364 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-30 23:57:20.235679 (MainThread): On master: COMMIT
2022-07-30 23:57:20.235948 (MainThread): Using snowflake connection "master".
2022-07-30 23:57:20.236104 (MainThread): On master: COMMIT
2022-07-30 23:57:20.367452 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:57:20.367958 (MainThread): On master: Close
2022-07-30 23:57:20.480326 (MainThread): 18:57:20 | Concurrency: 8 threads (target='dev')
2022-07-30 23:57:20.480591 (MainThread): 18:57:20 | 
2022-07-30 23:57:20.482609 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-30 23:57:20.482873 (Thread-2): Began running node model.my_new_project.candidates
2022-07-30 23:57:20.483238 (Thread-1): 18:57:20 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-30 23:57:20.483548 (Thread-2): 18:57:20 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-30 23:57:20.484001 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:57:20.484362 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:57:20.484528 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-30 23:57:20.484682 (Thread-2): Compiling model.my_new_project.candidates
2022-07-30 23:57:20.493094 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:57:20.496411 (Thread-2): finished collecting timing info
2022-07-30 23:57:20.498033 (Thread-2): Unhandled error while executing model.my_new_project.candidates
not all arguments converted during string formatting
2022-07-30 23:57:20.498511 (Thread-1): finished collecting timing info
2022-07-30 23:57:20.528915 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:57:20.530213 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:57:20.530320 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-07-30 23:57:20.530392 (Thread-1): Opening a new connection, currently in state closed
2022-07-30 23:57:20.498250 (Thread-2): 
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
TypeError: not all arguments converted during string formatting
2022-07-30 23:57:20.541687 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0912388-b8a8-4203-8142-6aec471e2bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db7b31d0>]}
2022-07-30 23:57:20.542020 (Thread-2): 18:57:20 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.06s]
2022-07-30 23:57:20.542143 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-30 23:57:21.012350 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2022-07-30 23:57:21.012509 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:57:21.012584 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-30 23:57:21.945273 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2022-07-30 23:57:21.946333 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:57:21.946471 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:57:21.946541 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:57:22.016661 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-30 23:57:22.029925 (Thread-1): finished collecting timing info
2022-07-30 23:57:22.030105 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-07-30 23:57:22.144455 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0912388-b8a8-4203-8142-6aec471e2bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dbd51748>]}
2022-07-30 23:57:22.144972 (Thread-1): 18:57:22 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.66s]
2022-07-30 23:57:22.145174 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-30 23:57:22.145664 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-07-30 23:57:22.145961 (Thread-3): 18:57:22 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-30 23:57:22.146466 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:57:22.146651 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-07-30 23:57:22.149279 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:57:22.150168 (Thread-3): finished collecting timing info
2022-07-30 23:57:22.173087 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:57:22.174280 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:57:22.174414 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-07-30 23:57:22.174509 (Thread-3): Opening a new connection, currently in state init
2022-07-30 23:57:22.663660 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-30 23:57:22.663812 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:57:22.663973 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-30 23:57:22.875637 (Thread-3): SQL status: SUCCESS 1 in 0.21 seconds
2022-07-30 23:57:22.876646 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:57:22.876789 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:57:22.876856 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:57:22.950727 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-30 23:57:22.951468 (Thread-3): finished collecting timing info
2022-07-30 23:57:22.951608 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-07-30 23:57:23.055837 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0912388-b8a8-4203-8142-6aec471e2bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d8d3a780>]}
2022-07-30 23:57:23.056350 (Thread-3): 18:57:23 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.91s]
2022-07-30 23:57:23.056554 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-07-30 23:57:23.153251 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:57:23.153887 (MainThread): Using snowflake connection "master".
2022-07-30 23:57:23.154142 (MainThread): On master: BEGIN
2022-07-30 23:57:23.154377 (MainThread): Opening a new connection, currently in state closed
2022-07-30 23:57:23.651948 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-30 23:57:23.652401 (MainThread): On master: COMMIT
2022-07-30 23:57:23.652735 (MainThread): Using snowflake connection "master".
2022-07-30 23:57:23.652892 (MainThread): On master: COMMIT
2022-07-30 23:57:23.797340 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-30 23:57:23.797650 (MainThread): On master: Close
2022-07-30 23:57:23.920003 (MainThread): 18:57:23 | 
2022-07-30 23:57:23.920262 (MainThread): 18:57:23 | Finished running 2 table models, 1 view model in 5.75s.
2022-07-30 23:57:23.920426 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:57:23.920536 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-30 23:57:23.920635 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-30 23:57:23.920730 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-30 23:57:23.929278 (MainThread): 
2022-07-30 23:57:23.929467 (MainThread): Completed with 1 error and 0 warnings:
2022-07-30 23:57:23.929598 (MainThread): 
2022-07-30 23:57:23.929721 (MainThread): not all arguments converted during string formatting
2022-07-30 23:57:23.929843 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-30 23:57:23.930038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db6af4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6db6e5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dbf39278>]}
2022-07-30 23:57:23.930266 (MainThread): Flushing usage events
2022-07-30 23:59:08.285080 (MainThread): Running with dbt=0.19.1
2022-07-30 23:59:09.429479 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:59:09.496522 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:59:09.499350 (MainThread): Tracking: tracking
2022-07-30 23:59:09.500056 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbd4f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf69d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbd78ba8>]}
2022-07-30 23:59:09.513547 (MainThread): Partial parsing not enabled
2022-07-30 23:59:09.515207 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:59:09.518043 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:59:09.555210 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:59:09.559111 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:59:09.561178 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:59:09.565669 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:59:09.578469 (MainThread): Parsing macros/core.sql
2022-07-30 23:59:09.583084 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:59:09.593764 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:59:09.596276 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:59:09.678721 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:59:09.713443 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:59:09.736397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:59:09.738780 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:59:09.745822 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:59:09.761155 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:59:09.768753 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:59:09.776354 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:59:09.782212 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:59:09.783832 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:59:09.785311 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:59:09.787312 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:59:09.797377 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:59:09.800210 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:59:09.802422 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:59:09.847661 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:59:09.849934 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:59:09.851865 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:59:09.853947 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:59:09.863160 (MainThread): Partial parsing not enabled
2022-07-30 23:59:09.885862 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:09.896780 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:09.900608 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:59:09.903325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbfad4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbfe1898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbfe18d0>]}
2022-07-30 23:59:09.903552 (MainThread): Flushing usage events
2022-07-30 23:59:10.321937 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-30 23:59:10.322130 (MainThread): Encountered an error:
2022-07-30 23:59:10.322269 (MainThread): Compilation Error in model candidates (models/yello_dw/candidates.sql)
  expected token ',', got 'candidates'
    line 7
      {% set table = 'candidates'%}
2022-07-30 23:59:10.330915 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 7, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'candidates'
  line 7
    {% set table = 'candidates'%}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    native=native,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 504, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/yello_dw/candidates.sql)
  expected token ',', got 'candidates'
    line 7
      {% set table = 'candidates'%}

2022-07-30 23:59:44.912956 (MainThread): Running with dbt=0.19.1
2022-07-30 23:59:45.800181 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-30 23:59:45.864339 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-30 23:59:45.868445 (MainThread): Tracking: tracking
2022-07-30 23:59:45.869154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1de491d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d98d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1de4b9400>]}
2022-07-30 23:59:45.883570 (MainThread): Partial parsing not enabled
2022-07-30 23:59:45.885207 (MainThread): Parsing macros/catalog.sql
2022-07-30 23:59:45.888033 (MainThread): Parsing macros/adapters.sql
2022-07-30 23:59:45.918429 (MainThread): Parsing macros/materializations/merge.sql
2022-07-30 23:59:45.920741 (MainThread): Parsing macros/materializations/view.sql
2022-07-30 23:59:45.922564 (MainThread): Parsing macros/materializations/table.sql
2022-07-30 23:59:45.926971 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-30 23:59:45.939037 (MainThread): Parsing macros/core.sql
2022-07-30 23:59:45.944603 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-30 23:59:45.954114 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-30 23:59:45.956064 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-30 23:59:46.060740 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-30 23:59:46.104645 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-30 23:59:46.125830 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-30 23:59:46.127951 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-30 23:59:46.134247 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-30 23:59:46.148259 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-30 23:59:46.155719 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-30 23:59:46.162172 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-30 23:59:46.167601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-30 23:59:46.168808 (MainThread): Parsing macros/etc/query.sql
2022-07-30 23:59:46.170091 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-30 23:59:46.171848 (MainThread): Parsing macros/etc/datetime.sql
2022-07-30 23:59:46.181032 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-30 23:59:46.183273 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-30 23:59:46.185580 (MainThread): Parsing macros/adapters/common.sql
2022-07-30 23:59:46.226739 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-30 23:59:46.228804 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-30 23:59:46.230496 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-30 23:59:46.232668 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-30 23:59:46.240873 (MainThread): Partial parsing not enabled
2022-07-30 23:59:46.262415 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:46.272112 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:46.276252 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:59:46.349563 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a2ce6b-230b-4a82-8a6f-9f53f1145f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1de8c0ac8>]}
2022-07-30 23:59:46.359765 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a2ce6b-230b-4a82-8a6f-9f53f1145f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dc67e1d0>]}
2022-07-30 23:59:46.360075 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-30 23:59:46.360903 (MainThread): 
2022-07-30 23:59:46.361218 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:59:46.362149 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-30 23:59:46.375119 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-30 23:59:46.375291 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-30 23:59:46.375376 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-30 23:59:47.199313 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2022-07-30 23:59:47.203694 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-30 23:59:47.320321 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:59:47.328404 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-30 23:59:47.328573 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-30 23:59:47.328673 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-30 23:59:48.010041 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.68 seconds
2022-07-30 23:59:48.011589 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-30 23:59:48.127236 (MainThread): Using snowflake connection "master".
2022-07-30 23:59:48.127464 (MainThread): On master: BEGIN
2022-07-30 23:59:48.127591 (MainThread): Opening a new connection, currently in state init
2022-07-30 23:59:48.643391 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-30 23:59:48.643853 (MainThread): On master: COMMIT
2022-07-30 23:59:48.644155 (MainThread): Using snowflake connection "master".
2022-07-30 23:59:48.644317 (MainThread): On master: COMMIT
2022-07-30 23:59:48.777842 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:59:48.778196 (MainThread): On master: Close
2022-07-30 23:59:48.894481 (MainThread): 18:59:48 | Concurrency: 8 threads (target='dev')
2022-07-30 23:59:48.894758 (MainThread): 18:59:48 | 
2022-07-30 23:59:48.896800 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-30 23:59:48.897180 (Thread-1): 18:59:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-30 23:59:48.897409 (Thread-2): Began running node model.my_new_project.candidates
2022-07-30 23:59:48.897838 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:48.898043 (Thread-2): 18:59:48 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-30 23:59:48.898212 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-30 23:59:48.898527 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-30 23:59:48.901510 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:59:48.901621 (Thread-2): Compiling model.my_new_project.candidates
2022-07-30 23:59:48.908835 (Thread-2): Using snowflake connection "model.my_new_project.candidates".
2022-07-30 23:59:48.909024 (Thread-2): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-30 23:59:48.909140 (Thread-2): Opening a new connection, currently in state init
2022-07-30 23:59:48.911038 (Thread-1): finished collecting timing info
2022-07-30 23:59:48.945825 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-30 23:59:48.947506 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:48.947672 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-07-30 23:59:48.947774 (Thread-1): Opening a new connection, currently in state closed
2022-07-30 23:59:49.596972 (Thread-2): Snowflake query id: 01a5f67f-0000-af49-0002-a3d6000141aa
2022-07-30 23:59:49.597228 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-30 23:59:49.598384 (Thread-2): finished collecting timing info
2022-07-30 23:59:49.598529 (Thread-2): On model.my_new_project.candidates: Close
2022-07-30 23:59:49.622343 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2022-07-30 23:59:49.622524 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:49.622603 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-30 23:59:49.667545 (Thread-2): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-30 23:59:49.679577 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a2ce6b-230b-4a82-8a6f-9f53f1145f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dee46710>]}
2022-07-30 23:59:49.679944 (Thread-2): 18:59:49 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.78s]
2022-07-30 23:59:49.680068 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-30 23:59:50.334395 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2022-07-30 23:59:50.336120 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:59:50.336352 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-30 23:59:50.336464 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-30 23:59:50.413642 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-30 23:59:50.426607 (Thread-1): finished collecting timing info
2022-07-30 23:59:50.426828 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-07-30 23:59:51.009848 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a2ce6b-230b-4a82-8a6f-9f53f1145f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1decca518>]}
2022-07-30 23:59:51.025122 (Thread-1): 18:59:51 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.11s]
2022-07-30 23:59:51.026333 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-30 23:59:51.027697 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-07-30 23:59:51.028398 (Thread-3): 18:59:51 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-30 23:59:51.029169 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:51.029379 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-07-30 23:59:51.033663 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:59:51.034905 (Thread-3): finished collecting timing info
2022-07-30 23:59:51.056386 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-30 23:59:51.057690 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:51.057794 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-07-30 23:59:51.057880 (Thread-3): Opening a new connection, currently in state init
2022-07-30 23:59:51.539587 (Thread-3): SQL status: SUCCESS 1 in 0.48 seconds
2022-07-30 23:59:51.539758 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:51.539831 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-30 23:59:51.748401 (Thread-3): SQL status: SUCCESS 1 in 0.21 seconds
2022-07-30 23:59:51.749514 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:59:51.749664 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-30 23:59:51.749740 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-30 23:59:51.824936 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-30 23:59:51.825835 (Thread-3): finished collecting timing info
2022-07-30 23:59:51.826020 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-07-30 23:59:51.943315 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a2ce6b-230b-4a82-8a6f-9f53f1145f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dee32d30>]}
2022-07-30 23:59:51.943884 (Thread-3): 18:59:51 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.91s]
2022-07-30 23:59:51.944092 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-07-30 23:59:51.978002 (MainThread): Acquiring new snowflake connection "master".
2022-07-30 23:59:51.978449 (MainThread): Using snowflake connection "master".
2022-07-30 23:59:51.978625 (MainThread): On master: BEGIN
2022-07-30 23:59:51.978785 (MainThread): Opening a new connection, currently in state closed
2022-07-30 23:59:52.475329 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-30 23:59:52.475701 (MainThread): On master: COMMIT
2022-07-30 23:59:52.475990 (MainThread): Using snowflake connection "master".
2022-07-30 23:59:52.476148 (MainThread): On master: COMMIT
2022-07-30 23:59:52.608145 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-30 23:59:52.608651 (MainThread): On master: Close
2022-07-30 23:59:52.727077 (MainThread): 18:59:52 | 
2022-07-30 23:59:52.727345 (MainThread): 18:59:52 | Finished running 2 table models, 1 view model in 6.37s.
2022-07-30 23:59:52.727498 (MainThread): Connection 'master' was properly closed.
2022-07-30 23:59:52.727606 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-30 23:59:52.727705 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-30 23:59:52.727801 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-30 23:59:52.743936 (MainThread): 
2022-07-30 23:59:52.744179 (MainThread): Completed with 1 error and 0 warnings:
2022-07-30 23:59:52.744316 (MainThread): 
2022-07-30 23:59:52.744443 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-30 23:59:52.744554 (MainThread):   001003 (42000): SQL compilation error:
2022-07-30 23:59:52.744653 (MainThread):   syntax error line 1 at position 75 unexpected '%'.
2022-07-30 23:59:52.744753 (MainThread):   syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-30 23:59:52.744865 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-30 23:59:52.745079 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dec94630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1de8d1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dee53cf8>]}
2022-07-30 23:59:52.745330 (MainThread): Flushing usage events
2022-07-31 00:00:26.932094 (MainThread): Running with dbt=0.19.1
2022-07-31 00:00:27.782845 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:00:27.847768 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-07-31 00:00:27.850527 (MainThread): Tracking: tracking
2022-07-31 00:00:27.851068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161c4a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15d012e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161c89be0>]}
2022-07-31 00:00:27.864326 (MainThread): Partial parsing not enabled
2022-07-31 00:00:27.865878 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:00:27.868454 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:00:27.898642 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:00:27.901142 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:00:27.903002 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:00:27.907205 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:00:27.919961 (MainThread): Parsing macros/core.sql
2022-07-31 00:00:27.924035 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:00:27.933367 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:00:27.935947 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:00:28.024277 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:00:28.063902 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:00:28.085892 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:00:28.088119 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:00:28.094664 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:00:28.108615 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:00:28.115863 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:00:28.122180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:00:28.127310 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:00:28.128437 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:00:28.129677 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:00:28.131416 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:00:28.140790 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:00:28.143248 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:00:28.145266 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:00:28.186791 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:00:28.188853 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:00:28.190627 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:00:28.192412 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:00:28.200207 (MainThread): Partial parsing not enabled
2022-07-31 00:00:28.221006 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:00:28.230650 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:00:28.234082 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:00:28.301824 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd86df32e-5b58-4b33-9fc9-d62f441237bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe162081b00>]}
2022-07-31 00:00:28.306368 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd86df32e-5b58-4b33-9fc9-d62f441237bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe15fed5748>]}
2022-07-31 00:00:28.306626 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:00:28.307359 (MainThread): 
2022-07-31 00:00:28.307638 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:00:28.308455 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:00:28.319674 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:00:28.319808 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:00:28.319885 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:00:29.132549 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.81 seconds
2022-07-31 00:00:29.136191 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:00:29.251668 (MainThread): 19:00:29 | Concurrency: 8 threads (target='dev')
2022-07-31 00:00:29.251932 (MainThread): 19:00:29 | 
2022-07-31 00:00:29.253706 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-31 00:00:29.253925 (Thread-2): Began running node model.my_new_project.candidates
2022-07-31 00:00:29.254255 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:00:29.254600 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:00:29.254758 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-31 00:00:29.254870 (Thread-2): Compiling model.my_new_project.candidates
2022-07-31 00:00:29.257765 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-31 00:00:29.263083 (Thread-2): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:00:29.263322 (Thread-2): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:00:29.263423 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:00:29.265172 (Thread-1): finished collecting timing info
2022-07-31 00:00:29.265340 (Thread-1): finished collecting timing info
2022-07-31 00:00:29.265668 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-31 00:00:29.266457 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-07-31 00:00:29.266590 (Thread-4): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:00:29.266707 (Thread-5): Began running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:00:29.267242 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:00:29.267513 (Thread-4): Acquiring new snowflake connection "test.my_new_project.not_null_my_first_dbt_model_id".
2022-07-31 00:00:29.267859 (Thread-5): Acquiring new snowflake connection "test.my_new_project.unique_my_first_dbt_model_id".
2022-07-31 00:00:29.267990 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-07-31 00:00:29.268186 (Thread-4): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:00:29.268319 (Thread-5): Compiling test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:00:29.270804 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-31 00:00:29.277226 (Thread-4): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2022-07-31 00:00:29.283206 (Thread-5): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2022-07-31 00:00:29.284017 (Thread-5): finished collecting timing info
2022-07-31 00:00:29.284157 (Thread-5): finished collecting timing info
2022-07-31 00:00:29.284269 (Thread-3): finished collecting timing info
2022-07-31 00:00:29.284352 (Thread-4): finished collecting timing info
2022-07-31 00:00:29.284635 (Thread-5): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:00:29.284755 (Thread-3): finished collecting timing info
2022-07-31 00:00:29.284857 (Thread-4): finished collecting timing info
2022-07-31 00:00:29.285178 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-07-31 00:00:29.285410 (Thread-4): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:00:29.285930 (Thread-6): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:00:29.286044 (Thread-7): Began running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:00:29.286320 (Thread-6): Acquiring new snowflake connection "test.my_new_project.not_null_my_second_dbt_model_id".
2022-07-31 00:00:29.286548 (Thread-7): Acquiring new snowflake connection "test.my_new_project.unique_my_second_dbt_model_id".
2022-07-31 00:00:29.286628 (Thread-6): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:00:29.286711 (Thread-7): Compiling test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:00:29.290033 (Thread-6): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2022-07-31 00:00:29.293861 (Thread-7): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2022-07-31 00:00:29.294466 (Thread-6): finished collecting timing info
2022-07-31 00:00:29.294610 (Thread-7): finished collecting timing info
2022-07-31 00:00:29.294730 (Thread-6): finished collecting timing info
2022-07-31 00:00:29.294838 (Thread-7): finished collecting timing info
2022-07-31 00:00:29.295179 (Thread-6): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:00:29.295709 (Thread-7): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:00:29.938256 (Thread-2): Snowflake query id: 01a5f680-0000-af49-0002-a3d6000141ba
2022-07-31 00:00:29.938396 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:00:29.939747 (Thread-2): finished collecting timing info
2022-07-31 00:00:29.939908 (Thread-2): On model.my_new_project.candidates: Close
2022-07-31 00:00:30.020032 (Thread-2): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:00:30.025544 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-31 00:00:30.025838 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:00:30.025943 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-31 00:00:30.026010 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:00:30.026067 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-31 00:00:30.026119 (MainThread): Connection 'test.my_new_project.not_null_my_first_dbt_model_id' was properly closed.
2022-07-31 00:00:30.026169 (MainThread): Connection 'test.my_new_project.unique_my_first_dbt_model_id' was properly closed.
2022-07-31 00:00:30.026219 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2022-07-31 00:00:30.026267 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2022-07-31 00:00:30.026394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161fa1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe161ec42e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16001b0b8>]}
2022-07-31 00:00:30.026555 (MainThread): Flushing usage events
2022-07-31 00:00:30.378178 (MainThread): Encountered an error:
2022-07-31 00:00:30.378508 (MainThread): Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:00:30.380346 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 384, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 339, in execute_nodes
    self.run_queue(pool)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 267, in run_queue
    self._raise_set_error()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 222, in _raise_set_error
    raise self._raise_next_tick
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.

2022-07-31 00:01:45.302577 (MainThread): Running with dbt=0.19.1
2022-07-31 00:01:46.287260 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:01:46.356064 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:01:46.366089 (MainThread): Tracking: tracking
2022-07-31 00:01:46.366692 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc25abcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd8d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc25cbba8>]}
2022-07-31 00:01:46.380728 (MainThread): Partial parsing not enabled
2022-07-31 00:01:46.382420 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:01:46.385118 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:01:46.417725 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:01:46.420282 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:01:46.422133 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:01:46.426589 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:01:46.439135 (MainThread): Parsing macros/core.sql
2022-07-31 00:01:46.444135 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:01:46.453466 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:01:46.455915 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:01:46.534459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:01:46.571788 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:01:46.592932 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:01:46.595303 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:01:46.602019 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:01:46.616024 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:01:46.623326 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:01:46.629786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:01:46.634998 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:01:46.636379 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:01:46.638176 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:01:46.640478 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:01:46.650108 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:01:46.652512 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:01:46.654761 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:01:46.702080 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:01:46.705293 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:01:46.707326 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:01:46.709729 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:01:46.718465 (MainThread): Partial parsing not enabled
2022-07-31 00:01:46.744623 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:01:46.755485 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:01:46.759678 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:01:46.831342 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018d2d80-e36f-4c47-8d75-eba18a60f127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc28c3b00>]}
2022-07-31 00:01:46.846201 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018d2d80-e36f-4c47-8d75-eba18a60f127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2726518>]}
2022-07-31 00:01:46.846451 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:01:46.847333 (MainThread): 
2022-07-31 00:01:46.847617 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:01:46.848509 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:01:46.859920 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:01:46.860030 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:01:46.860107 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:01:48.789208 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.93 seconds
2022-07-31 00:01:48.794231 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:01:48.904469 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:01:48.913032 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:01:48.913195 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:01:48.913305 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:01:49.555027 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.64 seconds
2022-07-31 00:01:49.556531 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:01:49.673631 (MainThread): Using snowflake connection "master".
2022-07-31 00:01:49.673844 (MainThread): On master: BEGIN
2022-07-31 00:01:49.673977 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:01:50.188042 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:01:50.188494 (MainThread): On master: COMMIT
2022-07-31 00:01:50.188905 (MainThread): Using snowflake connection "master".
2022-07-31 00:01:50.189066 (MainThread): On master: COMMIT
2022-07-31 00:01:50.316896 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:01:50.317224 (MainThread): On master: Close
2022-07-31 00:01:50.437941 (MainThread): 19:01:50 | Concurrency: 8 threads (target='dev')
2022-07-31 00:01:50.438339 (MainThread): 19:01:50 | 
2022-07-31 00:01:50.440600 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-31 00:01:50.440851 (Thread-2): Began running node model.my_new_project.candidates
2022-07-31 00:01:50.441172 (Thread-1): 19:01:50 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 00:01:50.441441 (Thread-2): 19:01:50 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:01:50.442185 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:01:50.442349 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-31 00:01:50.442491 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:01:50.443477 (Thread-2): Compiling model.my_new_project.candidates
2022-07-31 00:01:50.445556 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-31 00:01:50.452685 (Thread-2): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:01:50.453001 (Thread-2): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:01:50.453180 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:01:50.455037 (Thread-1): finished collecting timing info
2022-07-31 00:01:50.487116 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-31 00:01:50.488789 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:01:50.488937 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-07-31 00:01:50.489030 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:01:51.134094 (Thread-2): Snowflake query id: 01a5f681-0000-af49-0002-a3d6000141ce
2022-07-31 00:01:51.134247 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:01:51.136389 (Thread-2): finished collecting timing info
2022-07-31 00:01:51.136549 (Thread-2): On model.my_new_project.candidates: Close
2022-07-31 00:01:51.164275 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2022-07-31 00:01:51.164502 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:01:51.164575 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 00:01:51.205591 (Thread-2): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:01:51.219628 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018d2d80-e36f-4c47-8d75-eba18a60f127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2d4b828>]}
2022-07-31 00:01:51.219945 (Thread-2): 19:01:51 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.78s]
2022-07-31 00:01:51.220060 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-31 00:01:51.827669 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2022-07-31 00:01:51.828717 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-31 00:01:51.828852 (Thread-1): Using snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:01:51.828925 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-07-31 00:01:51.901958 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 00:01:51.910940 (Thread-1): finished collecting timing info
2022-07-31 00:01:51.911119 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-07-31 00:01:52.031428 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018d2d80-e36f-4c47-8d75-eba18a60f127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2cd2828>]}
2022-07-31 00:01:52.031974 (Thread-1): 19:01:52 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.59s]
2022-07-31 00:01:52.032169 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-31 00:01:52.032668 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-07-31 00:01:52.032964 (Thread-3): 19:01:52 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 00:01:52.033348 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:01:52.033505 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-07-31 00:01:52.036842 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-31 00:01:52.037880 (Thread-3): finished collecting timing info
2022-07-31 00:01:52.055804 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-31 00:01:52.056840 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:01:52.056935 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-07-31 00:01:52.057009 (Thread-3): Opening a new connection, currently in state init
2022-07-31 00:01:52.551744 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 00:01:52.551943 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:01:52.552025 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 00:01:52.763071 (Thread-3): SQL status: SUCCESS 1 in 0.21 seconds
2022-07-31 00:01:52.764039 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-31 00:01:52.764175 (Thread-3): Using snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:01:52.764246 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-07-31 00:01:52.835917 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 00:01:52.837033 (Thread-3): finished collecting timing info
2022-07-31 00:01:52.837287 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-07-31 00:01:52.967993 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018d2d80-e36f-4c47-8d75-eba18a60f127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2d600f0>]}
2022-07-31 00:01:52.968505 (Thread-3): 19:01:52 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.93s]
2022-07-31 00:01:52.968698 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-07-31 00:01:53.006594 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:01:53.007043 (MainThread): Using snowflake connection "master".
2022-07-31 00:01:53.007219 (MainThread): On master: BEGIN
2022-07-31 00:01:53.007339 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:01:53.502652 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:01:53.503116 (MainThread): On master: COMMIT
2022-07-31 00:01:53.503526 (MainThread): Using snowflake connection "master".
2022-07-31 00:01:53.503685 (MainThread): On master: COMMIT
2022-07-31 00:01:53.633191 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:01:53.633657 (MainThread): On master: Close
2022-07-31 00:01:53.753702 (MainThread): 19:01:53 | 
2022-07-31 00:01:53.753984 (MainThread): 19:01:53 | Finished running 2 table models, 1 view model in 6.91s.
2022-07-31 00:01:53.754139 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:01:53.754239 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-31 00:01:53.754326 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:01:53.754409 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-31 00:01:53.759583 (MainThread): 
2022-07-31 00:01:53.759770 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:01:53.759899 (MainThread): 
2022-07-31 00:01:53.760019 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:01:53.760128 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:01:53.760234 (MainThread):   syntax error line 1 at position 75 unexpected '%'.
2022-07-31 00:01:53.760328 (MainThread):   syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:01:53.760467 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 00:01:53.760664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2c427f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2d2f048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc2d2f5c0>]}
2022-07-31 00:01:53.760884 (MainThread): Flushing usage events
2022-07-31 00:04:02.074219 (MainThread): Running with dbt=0.19.1
2022-07-31 00:04:03.410446 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:04:03.485402 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-07-31 00:04:03.488772 (MainThread): Tracking: tracking
2022-07-31 00:04:03.489537 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a6451400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a18d2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a6478ba8>]}
2022-07-31 00:04:03.503236 (MainThread): Partial parsing not enabled
2022-07-31 00:04:03.504814 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:04:03.507679 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:04:03.538854 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:04:03.541326 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:04:03.543643 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:04:03.548300 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:04:03.560918 (MainThread): Parsing macros/core.sql
2022-07-31 00:04:03.565738 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:04:03.575565 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:04:03.577980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:04:03.682677 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:04:03.723930 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:04:03.745900 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:04:03.748306 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:04:03.755042 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:04:03.769306 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:04:03.777016 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:04:03.784013 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:04:03.790401 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:04:03.791953 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:04:03.793465 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:04:03.795533 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:04:03.805297 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:04:03.808418 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:04:03.834444 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:04:03.885531 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:04:03.887944 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:04:03.889837 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:04:03.892235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:04:03.900942 (MainThread): Partial parsing not enabled
2022-07-31 00:04:03.922593 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:04:03.933279 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:04:03.937242 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:04.005399 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12cec378-d29e-41d0-86cf-7eacf84cabba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a65d0f60>]}
2022-07-31 00:04:04.014794 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12cec378-d29e-41d0-86cf-7eacf84cabba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a6408588>]}
2022-07-31 00:04:04.015077 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:04:04.015963 (MainThread): 
2022-07-31 00:04:04.016307 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:04:04.017226 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:04.028631 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:04.028787 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:04:04.028869 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:04:04.947778 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.92 seconds
2022-07-31 00:04:04.953227 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:04:05.071472 (MainThread): 19:04:05 | Concurrency: 8 threads (target='dev')
2022-07-31 00:04:05.071678 (MainThread): 19:04:05 | 
2022-07-31 00:04:05.072988 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-31 00:04:05.073124 (Thread-2): Began running node model.my_new_project.candidates
2022-07-31 00:04:05.073458 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:04:05.073737 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:05.073846 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-31 00:04:05.073943 (Thread-2): Compiling model.my_new_project.candidates
2022-07-31 00:04:05.079257 (Thread-2): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:05.081408 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-31 00:04:05.081508 (Thread-2): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:04:05.081722 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:04:05.083251 (Thread-1): finished collecting timing info
2022-07-31 00:04:05.083584 (Thread-1): finished collecting timing info
2022-07-31 00:04:05.084231 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-31 00:04:05.084851 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-07-31 00:04:05.085007 (Thread-3): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:05.085120 (Thread-4): Began running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:05.085405 (Thread-5): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:04:05.085663 (Thread-3): Acquiring new snowflake connection "test.my_new_project.not_null_my_first_dbt_model_id".
2022-07-31 00:04:05.085945 (Thread-4): Acquiring new snowflake connection "test.my_new_project.unique_my_first_dbt_model_id".
2022-07-31 00:04:05.086066 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-07-31 00:04:05.086170 (Thread-3): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:05.086256 (Thread-4): Compiling test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:05.088673 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-31 00:04:05.094747 (Thread-3): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2022-07-31 00:04:05.100571 (Thread-4): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2022-07-31 00:04:05.101518 (Thread-5): finished collecting timing info
2022-07-31 00:04:05.101688 (Thread-5): finished collecting timing info
2022-07-31 00:04:05.102002 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-07-31 00:04:05.102387 (Thread-7): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:05.102527 (Thread-6): Began running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:05.102769 (Thread-7): Acquiring new snowflake connection "test.my_new_project.not_null_my_second_dbt_model_id".
2022-07-31 00:04:05.102999 (Thread-6): Acquiring new snowflake connection "test.my_new_project.unique_my_second_dbt_model_id".
2022-07-31 00:04:05.103118 (Thread-7): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:05.103213 (Thread-6): Compiling test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:05.106245 (Thread-7): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2022-07-31 00:04:05.110925 (Thread-6): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2022-07-31 00:04:05.112528 (Thread-3): finished collecting timing info
2022-07-31 00:04:05.113443 (Thread-3): finished collecting timing info
2022-07-31 00:04:05.113706 (Thread-4): finished collecting timing info
2022-07-31 00:04:05.114680 (Thread-3): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:05.114899 (Thread-4): finished collecting timing info
2022-07-31 00:04:05.115576 (Thread-4): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:05.120543 (Thread-6): finished collecting timing info
2022-07-31 00:04:05.120779 (Thread-6): finished collecting timing info
2022-07-31 00:04:05.120920 (Thread-7): finished collecting timing info
2022-07-31 00:04:05.121344 (Thread-6): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:05.121585 (Thread-7): finished collecting timing info
2022-07-31 00:04:05.122354 (Thread-7): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:05.577793 (Thread-2): Snowflake query id: 01a5f684-0000-af49-0002-a3d6000141e6
2022-07-31 00:04:05.577939 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:05.579806 (Thread-2): finished collecting timing info
2022-07-31 00:04:05.579947 (Thread-2): On model.my_new_project.candidates: Close
2022-07-31 00:04:05.653048 (Thread-2): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:05.666198 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-31 00:04:05.666489 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:04:05.666583 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-31 00:04:05.666647 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:04:05.666705 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-31 00:04:05.666761 (MainThread): Connection 'test.my_new_project.not_null_my_first_dbt_model_id' was properly closed.
2022-07-31 00:04:05.666815 (MainThread): Connection 'test.my_new_project.unique_my_first_dbt_model_id' was properly closed.
2022-07-31 00:04:05.666867 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2022-07-31 00:04:05.666919 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2022-07-31 00:04:05.667048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a65ac2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a63f7b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a6dc00b8>]}
2022-07-31 00:04:05.667215 (MainThread): Flushing usage events
2022-07-31 00:04:05.984016 (MainThread): Encountered an error:
2022-07-31 00:04:05.984195 (MainThread): Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:05.986607 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 384, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 339, in execute_nodes
    self.run_queue(pool)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 267, in run_queue
    self._raise_set_error()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 222, in _raise_set_error
    raise self._raise_next_tick
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.

2022-07-31 00:04:41.578930 (MainThread): Running with dbt=0.19.1
2022-07-31 00:04:42.496671 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:04:42.561688 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-07-31 00:04:42.564990 (MainThread): Tracking: tracking
2022-07-31 00:04:42.565789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257c50ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2528ace10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257c89780>]}
2022-07-31 00:04:42.580048 (MainThread): Partial parsing not enabled
2022-07-31 00:04:42.581887 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:04:42.584633 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:04:42.615044 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:04:42.617566 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:04:42.619331 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:04:42.623634 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:04:42.635809 (MainThread): Parsing macros/core.sql
2022-07-31 00:04:42.640143 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:04:42.649489 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:04:42.651493 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:04:42.757981 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:04:42.799078 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:04:42.820685 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:04:42.822805 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:04:42.829184 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:04:42.842960 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:04:42.850633 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:04:42.857121 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:04:42.862270 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:04:42.863459 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:04:42.864760 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:04:42.866587 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:04:42.875568 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:04:42.877719 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:04:42.879598 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:04:42.920838 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:04:42.922923 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:04:42.924627 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:04:42.926677 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:04:42.934799 (MainThread): Partial parsing not enabled
2022-07-31 00:04:42.956397 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:04:42.966573 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:04:42.970022 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:43.039795 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1a8292-5ff3-4398-a40b-13beae6b4531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25806cf98>]}
2022-07-31 00:04:43.046212 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1a8292-5ff3-4398-a40b-13beae6b4531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258030710>]}
2022-07-31 00:04:43.046548 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:04:43.047484 (MainThread): 
2022-07-31 00:04:43.047805 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:04:43.048663 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:43.059927 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:43.060055 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:04:43.060133 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:04:43.832583 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.77 seconds
2022-07-31 00:04:43.836778 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:04:43.962417 (MainThread): 19:04:43 | Concurrency: 8 threads (target='dev')
2022-07-31 00:04:43.962697 (MainThread): 19:04:43 | 
2022-07-31 00:04:43.964723 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-07-31 00:04:43.965218 (Thread-1): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:04:43.965454 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-07-31 00:04:43.966272 (Thread-2): Began running node model.my_new_project.candidates
2022-07-31 00:04:43.966647 (Thread-2): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:43.966798 (Thread-2): Compiling model.my_new_project.candidates
2022-07-31 00:04:43.974673 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-07-31 00:04:43.975381 (Thread-2): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:43.975638 (Thread-2): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:04:43.975765 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:04:43.977879 (Thread-1): finished collecting timing info
2022-07-31 00:04:43.978095 (Thread-1): finished collecting timing info
2022-07-31 00:04:43.978470 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-07-31 00:04:43.979608 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-07-31 00:04:43.980126 (Thread-5): Began running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:43.980702 (Thread-3): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:04:43.980920 (Thread-4): Began running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:43.981261 (Thread-5): Acquiring new snowflake connection "test.my_new_project.not_null_my_first_dbt_model_id".
2022-07-31 00:04:43.981471 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-07-31 00:04:43.981945 (Thread-4): Acquiring new snowflake connection "test.my_new_project.unique_my_first_dbt_model_id".
2022-07-31 00:04:43.982187 (Thread-5): Compiling test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:43.985379 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-07-31 00:04:43.985579 (Thread-4): Compiling test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:43.993332 (Thread-5): Writing injected SQL for node "test.my_new_project.not_null_my_first_dbt_model_id"
2022-07-31 00:04:44.000928 (Thread-4): Writing injected SQL for node "test.my_new_project.unique_my_first_dbt_model_id"
2022-07-31 00:04:44.001302 (Thread-3): finished collecting timing info
2022-07-31 00:04:44.001546 (Thread-3): finished collecting timing info
2022-07-31 00:04:44.002955 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-07-31 00:04:44.004164 (Thread-5): finished collecting timing info
2022-07-31 00:04:44.004515 (Thread-4): finished collecting timing info
2022-07-31 00:04:44.005103 (Thread-5): finished collecting timing info
2022-07-31 00:04:44.005751 (Thread-7): Began running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:44.005974 (Thread-6): Began running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:44.006188 (Thread-4): finished collecting timing info
2022-07-31 00:04:44.007396 (Thread-7): Acquiring new snowflake connection "test.my_new_project.not_null_my_second_dbt_model_id".
2022-07-31 00:04:44.007902 (Thread-5): Finished running node test.my_new_project.not_null_my_first_dbt_model_id
2022-07-31 00:04:44.008083 (Thread-6): Acquiring new snowflake connection "test.my_new_project.unique_my_second_dbt_model_id".
2022-07-31 00:04:44.008525 (Thread-4): Finished running node test.my_new_project.unique_my_first_dbt_model_id
2022-07-31 00:04:44.008762 (Thread-7): Compiling test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:44.009205 (Thread-6): Compiling test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:44.015756 (Thread-7): Writing injected SQL for node "test.my_new_project.not_null_my_second_dbt_model_id"
2022-07-31 00:04:44.019452 (Thread-6): Writing injected SQL for node "test.my_new_project.unique_my_second_dbt_model_id"
2022-07-31 00:04:44.020683 (Thread-6): finished collecting timing info
2022-07-31 00:04:44.020935 (Thread-6): finished collecting timing info
2022-07-31 00:04:44.021074 (Thread-7): finished collecting timing info
2022-07-31 00:04:44.021458 (Thread-6): Finished running node test.my_new_project.unique_my_second_dbt_model_id
2022-07-31 00:04:44.021673 (Thread-7): finished collecting timing info
2022-07-31 00:04:44.022161 (Thread-7): Finished running node test.my_new_project.not_null_my_second_dbt_model_id
2022-07-31 00:04:44.756958 (Thread-2): Snowflake query id: 01a5f684-0000-af4d-0002-a3d60001519e
2022-07-31 00:04:44.757129 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:44.758405 (Thread-2): finished collecting timing info
2022-07-31 00:04:44.758555 (Thread-2): On model.my_new_project.candidates: Close
2022-07-31 00:04:44.825320 (Thread-2): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:44.831127 (Thread-2): Finished running node model.my_new_project.candidates
2022-07-31 00:04:44.831448 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:04:44.831529 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-07-31 00:04:44.831586 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:04:44.831640 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-07-31 00:04:44.831692 (MainThread): Connection 'test.my_new_project.not_null_my_first_dbt_model_id' was properly closed.
2022-07-31 00:04:44.831742 (MainThread): Connection 'test.my_new_project.unique_my_first_dbt_model_id' was properly closed.
2022-07-31 00:04:44.831790 (MainThread): Connection 'test.my_new_project.not_null_my_second_dbt_model_id' was properly closed.
2022-07-31 00:04:44.831837 (MainThread): Connection 'test.my_new_project.unique_my_second_dbt_model_id' was properly closed.
2022-07-31 00:04:44.831977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257dab2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257fdef28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257fa2400>]}
2022-07-31 00:04:44.832145 (MainThread): Flushing usage events
2022-07-31 00:04:45.127406 (MainThread): Encountered an error:
2022-07-31 00:04:45.127627 (MainThread): Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:45.128913 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 384, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 339, in execute_nodes
    self.run_queue(pool)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 267, in run_queue
    self._raise_set_error()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 222, in _raise_set_error
    raise self._raise_next_tick
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.

2022-07-31 00:04:55.546971 (MainThread): Running with dbt=0.19.1
2022-07-31 00:04:56.377628 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:04:56.439213 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-07-31 00:04:56.442065 (MainThread): Tracking: tracking
2022-07-31 00:04:56.442730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f987d913e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9882538470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9882538c18>]}
2022-07-31 00:04:56.456572 (MainThread): Partial parsing not enabled
2022-07-31 00:04:56.458045 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:04:56.460580 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:04:56.490531 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:04:56.492769 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:04:56.494425 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:04:56.498765 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:04:56.511139 (MainThread): Parsing macros/core.sql
2022-07-31 00:04:56.515216 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:04:56.523994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:04:56.525962 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:04:56.608590 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:04:56.645284 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:04:56.666122 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:04:56.668148 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:04:56.674656 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:04:56.688611 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:04:56.695558 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:04:56.701588 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:04:56.706666 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:04:56.707877 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:04:56.709125 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:04:56.710867 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:04:56.719677 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:04:56.721919 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:04:56.723721 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:04:56.767823 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:04:56.769842 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:04:56.771837 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:04:56.773866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:04:56.781594 (MainThread): Partial parsing not enabled
2022-07-31 00:04:56.801930 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:04:56.811636 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:04:56.814947 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:56.881563 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c8309c-884e-407d-9ee6-8be37eeafcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9882829b00>]}
2022-07-31 00:04:56.888614 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c8309c-884e-407d-9ee6-8be37eeafcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98825470f0>]}
2022-07-31 00:04:56.888863 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:04:56.889464 (MainThread): 
2022-07-31 00:04:56.889750 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:04:56.890600 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:56.901719 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:04:56.901819 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:04:56.901890 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:04:57.670143 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.77 seconds
2022-07-31 00:04:57.673884 (ThreadPoolExecutor-0_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:04:57.791155 (MainThread): 19:04:57 | Concurrency: 8 threads (target='dev')
2022-07-31 00:04:57.791407 (MainThread): 19:04:57 | 
2022-07-31 00:04:57.793285 (Thread-1): Began running node model.my_new_project.candidates
2022-07-31 00:04:57.793720 (Thread-1): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:57.793898 (Thread-1): Compiling model.my_new_project.candidates
2022-07-31 00:04:57.800182 (Thread-1): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:04:57.800303 (Thread-1): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:04:57.800393 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:04:58.270338 (Thread-1): Snowflake query id: 01a5f684-0000-af49-0002-a3d6000141f2
2022-07-31 00:04:58.282386 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:58.286919 (Thread-1): finished collecting timing info
2022-07-31 00:04:58.306356 (Thread-1): On model.my_new_project.candidates: Close
2022-07-31 00:04:58.377502 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:58.385742 (Thread-1): Finished running node model.my_new_project.candidates
2022-07-31 00:04:58.386098 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:04:58.386211 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:04:58.386385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98825470f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9882829828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9882c10978>]}
2022-07-31 00:04:58.386606 (MainThread): Flushing usage events
2022-07-31 00:04:58.691426 (MainThread): Encountered an error:
2022-07-31 00:04:58.691765 (MainThread): Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:04:58.693478 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 384, in execute_with_hooks
    res = self.execute_nodes()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 339, in execute_nodes
    self.run_queue(pool)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 267, in run_queue
    self._raise_set_error()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 222, in _raise_set_error
    raise self._raise_next_tick
dbt.exceptions.RuntimeException: Runtime Error
  Database Error in model candidates (models/yello_dw/candidates.sql)
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 75 unexpected '%'.
    syntax error line 1 at position 87 unexpected '<EOF>'.

2022-07-31 00:05:13.999883 (MainThread): Running with dbt=0.19.1
2022-07-31 00:05:14.828524 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:05:14.893807 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:05:14.898227 (MainThread): Tracking: tracking
2022-07-31 00:05:14.899160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe848d2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe89584b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe895847f0>]}
2022-07-31 00:05:14.913211 (MainThread): Partial parsing not enabled
2022-07-31 00:05:14.914625 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:05:14.917157 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:05:14.947308 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:05:14.949568 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:05:14.951266 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:05:14.955443 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:05:14.967475 (MainThread): Parsing macros/core.sql
2022-07-31 00:05:14.971529 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:05:14.980760 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:05:14.982755 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:05:15.066224 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:05:15.102305 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:05:15.123401 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:05:15.125439 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:05:15.131631 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:05:15.145305 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:05:15.152190 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:05:15.158429 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:05:15.163303 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:05:15.164413 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:05:15.165721 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:05:15.167467 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:05:15.176384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:05:15.178551 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:05:15.180379 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:05:15.221521 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:05:15.223729 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:05:15.225409 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:05:15.227230 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:05:15.235287 (MainThread): Partial parsing not enabled
2022-07-31 00:05:15.255975 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:05:15.265018 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:05:15.268261 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:05:15.335258 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '354b4252-b938-4b1f-a843-6cf4635f1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe899bea58>]}
2022-07-31 00:05:15.341150 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '354b4252-b938-4b1f-a843-6cf4635f1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe87819390>]}
2022-07-31 00:05:15.341403 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:05:15.342380 (MainThread): 
2022-07-31 00:05:15.342714 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:05:15.343427 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:05:15.355873 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:05:15.356010 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:05:15.356085 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:05:16.104990 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.75 seconds
2022-07-31 00:05:16.109252 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:05:16.220955 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:05:16.226778 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:05:16.226893 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:05:16.226968 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:05:16.698827 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.47 seconds
2022-07-31 00:05:16.700332 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:05:16.820439 (MainThread): Using snowflake connection "master".
2022-07-31 00:05:16.820644 (MainThread): On master: BEGIN
2022-07-31 00:05:16.820771 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:05:17.488753 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2022-07-31 00:05:17.489211 (MainThread): On master: COMMIT
2022-07-31 00:05:17.489613 (MainThread): Using snowflake connection "master".
2022-07-31 00:05:17.489767 (MainThread): On master: COMMIT
2022-07-31 00:05:17.674021 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-07-31 00:05:17.674525 (MainThread): On master: Close
2022-07-31 00:05:17.796598 (MainThread): 19:05:17 | Concurrency: 8 threads (target='dev')
2022-07-31 00:05:17.796864 (MainThread): 19:05:17 | 
2022-07-31 00:05:17.798920 (Thread-1): Began running node model.my_new_project.candidates
2022-07-31 00:05:17.799298 (Thread-1): 19:05:17 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:05:17.799737 (Thread-1): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:05:17.799909 (Thread-1): Compiling model.my_new_project.candidates
2022-07-31 00:05:17.806294 (Thread-1): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:05:17.806434 (Thread-1): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select table_schema from information_schema.tables where table_schema like %poc_client%
2022-07-31 00:05:17.806538 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:05:18.295137 (Thread-1): Snowflake query id: 01a5f685-0000-af4d-0002-a3d6000151aa
2022-07-31 00:05:18.295539 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:05:18.297933 (Thread-1): finished collecting timing info
2022-07-31 00:05:18.298213 (Thread-1): On model.my_new_project.candidates: Close
2022-07-31 00:05:18.366969 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 75 unexpected '%'.
syntax error line 1 at position 87 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 75 unexpected '%'.
  syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:05:18.375245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '354b4252-b938-4b1f-a843-6cf4635f1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe89828eb8>]}
2022-07-31 00:05:18.375672 (Thread-1): 19:05:18 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.58s]
2022-07-31 00:05:18.375832 (Thread-1): Finished running node model.my_new_project.candidates
2022-07-31 00:05:18.411521 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:05:18.411954 (MainThread): Using snowflake connection "master".
2022-07-31 00:05:18.412123 (MainThread): On master: BEGIN
2022-07-31 00:05:18.412279 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:05:18.915785 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:05:18.916244 (MainThread): On master: COMMIT
2022-07-31 00:05:18.916645 (MainThread): Using snowflake connection "master".
2022-07-31 00:05:18.916800 (MainThread): On master: COMMIT
2022-07-31 00:05:19.045739 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:05:19.046069 (MainThread): On master: Close
2022-07-31 00:05:19.158479 (MainThread): 19:05:19 | 
2022-07-31 00:05:19.158731 (MainThread): 19:05:19 | Finished running 1 table model in 3.82s.
2022-07-31 00:05:19.158889 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:05:19.158998 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:05:19.174696 (MainThread): 
2022-07-31 00:05:19.174939 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:05:19.175116 (MainThread): 
2022-07-31 00:05:19.175319 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:05:19.175462 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:05:19.175571 (MainThread):   syntax error line 1 at position 75 unexpected '%'.
2022-07-31 00:05:19.175671 (MainThread):   syntax error line 1 at position 87 unexpected '<EOF>'.
2022-07-31 00:05:19.175784 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:05:19.175977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe89828eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe89c1dc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe89c1dcf8>]}
2022-07-31 00:05:19.176202 (MainThread): Flushing usage events
2022-07-31 00:11:34.651557 (MainThread): Running with dbt=0.19.1
2022-07-31 00:11:35.881246 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:11:35.948292 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:11:35.951018 (MainThread): Tracking: tracking
2022-07-31 00:11:35.951670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368d0b0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368d0b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368d30b70>]}
2022-07-31 00:11:35.964656 (MainThread): Partial parsing not enabled
2022-07-31 00:11:35.966237 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:11:35.969294 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:11:35.999646 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:11:36.002211 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:11:36.004169 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:11:36.008492 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:11:36.021770 (MainThread): Parsing macros/core.sql
2022-07-31 00:11:36.027047 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:11:36.036720 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:11:36.039275 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:11:36.122155 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:11:36.160837 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:11:36.182548 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:11:36.185175 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:11:36.191552 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:11:36.208495 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:11:36.216087 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:11:36.223149 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:11:36.228415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:11:36.229842 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:11:36.231738 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:11:36.234251 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:11:36.243704 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:11:36.246621 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:11:36.249538 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:11:36.300685 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:11:36.303644 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:11:36.305966 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:11:36.308315 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:11:36.316367 (MainThread): Partial parsing not enabled
2022-07-31 00:11:36.338449 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_first_dbt_model".
2022-07-31 00:11:36.349161 (MainThread): Acquiring new snowflake connection "model.my_new_project.my_second_dbt_model".
2022-07-31 00:11:36.353154 (MainThread): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:11:36.421917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c30eea-93b8-42b2-8a77-34b4c2933ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36913fb00>]}
2022-07-31 00:11:36.426443 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c30eea-93b8-42b2-8a77-34b4c2933ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc366d4ceb8>]}
2022-07-31 00:11:36.426711 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:11:36.427315 (MainThread): 
2022-07-31 00:11:36.427656 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:11:36.428491 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:11:36.439944 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:11:36.440072 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:11:36.440148 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:11:37.291572 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2022-07-31 00:11:37.297231 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:11:37.419965 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:11:37.427989 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:11:37.428138 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:11:37.428248 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:11:37.920762 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.49 seconds
2022-07-31 00:11:37.922250 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:11:38.039994 (MainThread): Using snowflake connection "master".
2022-07-31 00:11:38.040179 (MainThread): On master: BEGIN
2022-07-31 00:11:38.040284 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:11:38.721553 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2022-07-31 00:11:38.722008 (MainThread): On master: COMMIT
2022-07-31 00:11:38.722366 (MainThread): Using snowflake connection "master".
2022-07-31 00:11:38.722521 (MainThread): On master: COMMIT
2022-07-31 00:11:38.851013 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:11:38.851449 (MainThread): On master: Close
2022-07-31 00:11:39.184065 (MainThread): 19:11:39 | Concurrency: 8 threads (target='dev')
2022-07-31 00:11:39.184326 (MainThread): 19:11:39 | 
2022-07-31 00:11:39.186252 (Thread-1): Began running node model.my_new_project.candidates
2022-07-31 00:11:39.186616 (Thread-1): 19:11:39 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:11:39.187031 (Thread-1): Acquiring new snowflake connection "model.my_new_project.candidates".
2022-07-31 00:11:39.187173 (Thread-1): Compiling model.my_new_project.candidates
2022-07-31 00:11:39.193358 (Thread-1): Using snowflake connection "model.my_new_project.candidates".
2022-07-31 00:11:39.193475 (Thread-1): On model.my_new_project.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.my_new_project.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:11:39.193565 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:11:39.670256 (Thread-1): Snowflake query id: 01a5f68b-0000-af49-0002-a3d60001423e
2022-07-31 00:11:39.670605 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:11:39.673982 (Thread-1): finished collecting timing info
2022-07-31 00:11:39.674328 (Thread-1): On model.my_new_project.candidates: Close
2022-07-31 00:11:39.743096 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:11:39.762114 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c30eea-93b8-42b2-8a77-34b4c2933ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368fa8ac8>]}
2022-07-31 00:11:39.762515 (Thread-1): 19:11:39 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.58s]
2022-07-31 00:11:39.762675 (Thread-1): Finished running node model.my_new_project.candidates
2022-07-31 00:11:39.819686 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:11:39.820254 (MainThread): Using snowflake connection "master".
2022-07-31 00:11:39.820423 (MainThread): On master: BEGIN
2022-07-31 00:11:39.820578 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:11:40.326584 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:11:40.327032 (MainThread): On master: COMMIT
2022-07-31 00:11:40.327340 (MainThread): Using snowflake connection "master".
2022-07-31 00:11:40.327496 (MainThread): On master: COMMIT
2022-07-31 00:11:40.446987 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:11:40.447206 (MainThread): On master: Close
2022-07-31 00:11:40.607404 (MainThread): 19:11:40 | 
2022-07-31 00:11:40.607661 (MainThread): 19:11:40 | Finished running 1 table model in 4.18s.
2022-07-31 00:11:40.607819 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:11:40.607928 (MainThread): Connection 'model.my_new_project.candidates' was properly closed.
2022-07-31 00:11:40.616674 (MainThread): 
2022-07-31 00:11:40.616865 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:11:40.616999 (MainThread): 
2022-07-31 00:11:40.617249 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:11:40.617389 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:11:40.617497 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:11:40.617597 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:11:40.617702 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:11:40.617890 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368fa8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368fa8ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc368fa8b38>]}
2022-07-31 00:11:40.618115 (MainThread): Flushing usage events
2022-07-31 00:13:05.111504 (MainThread): Running with dbt=0.19.1
2022-07-31 00:13:06.009276 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:13:06.074301 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:13:06.078191 (MainThread): Tracking: tracking
2022-07-31 00:13:06.079097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa90d3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae5787f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae578be0>]}
2022-07-31 00:13:06.092649 (MainThread): Partial parsing not enabled
2022-07-31 00:13:06.094275 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:13:06.097106 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:13:06.127052 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:13:06.129410 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:13:06.131157 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:13:06.135304 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:13:06.147699 (MainThread): Parsing macros/core.sql
2022-07-31 00:13:06.151867 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:13:06.160882 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:13:06.162786 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:13:06.281073 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:13:06.330103 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:13:06.353701 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:13:06.355852 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:13:06.362347 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:13:06.376787 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:13:06.384212 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:13:06.391122 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:13:06.396740 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:13:06.397922 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:13:06.399145 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:13:06.400915 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:13:06.409592 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:13:06.412053 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:13:06.414000 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:13:06.455301 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:13:06.457429 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:13:06.459117 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:13:06.461023 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:13:06.469015 (MainThread): Partial parsing not enabled
2022-07-31 00:13:06.490771 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:13:06.501676 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:13:06.505091 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:06.574226 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:13:06.574625 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfffb704-af1d-449d-9460-d06d6746f33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c8a90>]}
2022-07-31 00:13:06.580914 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfffb704-af1d-449d-9460-d06d6746f33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae555048>]}
2022-07-31 00:13:06.581205 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:13:06.581832 (MainThread): 
2022-07-31 00:13:06.582149 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:13:06.582976 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:13:06.595013 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:13:06.595155 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:13:06.595230 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:13:07.536608 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2022-07-31 00:13:07.542348 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:13:07.665630 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:13:07.674031 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:13:07.674173 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:13:07.674269 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:13:08.306561 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.63 seconds
2022-07-31 00:13:08.308199 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:13:08.428859 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:08.429079 (MainThread): On master: BEGIN
2022-07-31 00:13:08.429199 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:13:08.934863 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:13:08.935316 (MainThread): On master: COMMIT
2022-07-31 00:13:08.935641 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:08.935785 (MainThread): On master: COMMIT
2022-07-31 00:13:09.071244 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 00:13:09.071609 (MainThread): On master: Close
2022-07-31 00:13:09.184038 (MainThread): 19:13:09 | Concurrency: 8 threads (target='dev')
2022-07-31 00:13:09.184314 (MainThread): 19:13:09 | 
2022-07-31 00:13:09.186377 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:13:09.186752 (Thread-1): 19:13:09 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:13:09.187106 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:09.187249 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:13:09.193677 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:09.193798 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:13:09.193897 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:13:09.719712 (Thread-1): Snowflake query id: 01a5f68d-0000-af4d-0002-a3d6000151f2
2022-07-31 00:13:09.720030 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:09.722258 (Thread-1): finished collecting timing info
2022-07-31 00:13:09.722549 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:13:09.792802 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:09.801292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfffb704-af1d-449d-9460-d06d6746f33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae8675f8>]}
2022-07-31 00:13:09.801715 (Thread-1): 19:13:09 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.61s]
2022-07-31 00:13:09.801874 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:13:09.803254 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:13:09.803501 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:09.803601 (MainThread): On master: BEGIN
2022-07-31 00:13:09.803692 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:13:10.327839 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:13:10.328283 (MainThread): On master: COMMIT
2022-07-31 00:13:10.328585 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:10.328733 (MainThread): On master: COMMIT
2022-07-31 00:13:10.460650 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:13:10.461056 (MainThread): On master: Close
2022-07-31 00:13:10.580482 (MainThread): 19:13:10 | 
2022-07-31 00:13:10.580750 (MainThread): 19:13:10 | Finished running 1 table model in 4.00s.
2022-07-31 00:13:10.580905 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:13:10.581007 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:13:10.592366 (MainThread): 
2022-07-31 00:13:10.592577 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:13:10.592704 (MainThread): 
2022-07-31 00:13:10.592819 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:13:10.593024 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:13:10.593161 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:13:10.593263 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:10.593367 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:13:10.593567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae5a8a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c8cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c8a90>]}
2022-07-31 00:13:10.593852 (MainThread): Flushing usage events
2022-07-31 00:13:35.206612 (MainThread): Running with dbt=0.19.1
2022-07-31 00:13:36.133005 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:13:36.200878 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:13:36.203365 (MainThread): Tracking: tracking
2022-07-31 00:13:36.203910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc748813e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74d58bc88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74d58b400>]}
2022-07-31 00:13:36.238058 (MainThread): Partial parsing not enabled
2022-07-31 00:13:36.239709 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:13:36.242322 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:13:36.276306 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:13:36.279316 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:13:36.281638 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:13:36.286711 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:13:36.301731 (MainThread): Parsing macros/core.sql
2022-07-31 00:13:36.306690 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:13:36.315818 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:13:36.317802 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:13:36.392841 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:13:36.427865 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:13:36.450009 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:13:36.452256 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:13:36.458783 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:13:36.473367 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:13:36.480242 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:13:36.487006 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:13:36.492251 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:13:36.493408 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:13:36.494802 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:13:36.496663 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:13:36.506155 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:13:36.508590 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:13:36.510479 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:13:36.554366 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:13:36.556562 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:13:36.558501 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:13:36.560703 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:13:36.569355 (MainThread): Partial parsing not enabled
2022-07-31 00:13:36.590851 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:13:36.602509 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:13:36.606604 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:36.679597 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:13:36.680000 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e082f666-973a-41b4-8d84-52f1949d358c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74d883b00>]}
2022-07-31 00:13:36.684890 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e082f666-973a-41b4-8d84-52f1949d358c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74d5a3630>]}
2022-07-31 00:13:36.685118 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:13:36.685802 (MainThread): 
2022-07-31 00:13:36.686075 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:13:36.686895 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:13:36.700127 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:13:36.700253 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:13:36.700328 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:13:37.463027 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.76 seconds
2022-07-31 00:13:37.467012 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:13:37.579044 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:13:37.585593 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:13:37.585725 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:13:37.585804 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:13:38.081267 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.50 seconds
2022-07-31 00:13:38.083631 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:13:38.193590 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:38.193768 (MainThread): On master: BEGIN
2022-07-31 00:13:38.193875 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:13:38.695257 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:13:38.695579 (MainThread): On master: COMMIT
2022-07-31 00:13:38.695845 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:38.696005 (MainThread): On master: COMMIT
2022-07-31 00:13:38.824853 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:13:38.825246 (MainThread): On master: Close
2022-07-31 00:13:38.939017 (MainThread): 19:13:38 | Concurrency: 8 threads (target='dev')
2022-07-31 00:13:38.939279 (MainThread): 19:13:38 | 
2022-07-31 00:13:38.941253 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:13:38.941609 (Thread-1): 19:13:38 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:13:38.942003 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:38.942167 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:13:38.948831 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:13:38.948993 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:13:38.949098 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:13:39.687196 (Thread-1): Snowflake query id: 01a5f68d-0000-af4d-0002-a3d6000151fe
2022-07-31 00:13:39.687670 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:39.691207 (Thread-1): finished collecting timing info
2022-07-31 00:13:39.691536 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:13:39.766114 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:39.774893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e082f666-973a-41b4-8d84-52f1949d358c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74dd517f0>]}
2022-07-31 00:13:39.775294 (Thread-1): 19:13:39 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.83s]
2022-07-31 00:13:39.775450 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:13:39.876701 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:13:39.877308 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:39.877558 (MainThread): On master: BEGIN
2022-07-31 00:13:39.877787 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:13:40.393008 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:13:40.393330 (MainThread): On master: COMMIT
2022-07-31 00:13:40.393711 (MainThread): Using snowflake connection "master".
2022-07-31 00:13:40.393904 (MainThread): On master: COMMIT
2022-07-31 00:13:40.578131 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-07-31 00:13:40.578596 (MainThread): On master: Close
2022-07-31 00:13:40.701194 (MainThread): 19:13:40 | 
2022-07-31 00:13:40.701484 (MainThread): 19:13:40 | Finished running 1 table model in 4.02s.
2022-07-31 00:13:40.701769 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:13:40.702007 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:13:40.710467 (MainThread): 
2022-07-31 00:13:40.710650 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:13:40.710772 (MainThread): 
2022-07-31 00:13:40.710882 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:13:40.710981 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:13:40.711070 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:13:40.711157 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:13:40.711251 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:13:40.711420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74dbf6048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74db88ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc74db88630>]}
2022-07-31 00:13:40.711619 (MainThread): Flushing usage events
2022-07-31 00:34:37.779914 (MainThread): Running with dbt=0.19.1
2022-07-31 00:34:38.807015 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:34:38.874828 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:34:38.878183 (MainThread): Tracking: tracking
2022-07-31 00:34:38.879005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edb7bce48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1584828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1584b70>]}
2022-07-31 00:34:38.892324 (MainThread): Partial parsing not enabled
2022-07-31 00:34:38.893688 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:34:38.896204 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:34:38.928235 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:34:38.930692 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:34:38.932575 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:34:38.936970 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:34:38.951959 (MainThread): Parsing macros/core.sql
2022-07-31 00:34:38.956569 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:34:38.966083 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:34:38.968193 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:34:39.053637 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:34:39.090640 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:34:39.112015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:34:39.114058 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:34:39.120284 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:34:39.135968 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:34:39.143477 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:34:39.149934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:34:39.154997 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:34:39.156127 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:34:39.157670 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:34:39.159576 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:34:39.168279 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:34:39.170435 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:34:39.172222 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:34:39.212012 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:34:39.214147 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:34:39.216071 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:34:39.217866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:34:39.226504 (MainThread): Partial parsing not enabled
2022-07-31 00:34:39.246439 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:34:39.255829 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:34:39.259944 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:34:39.330050 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:34:39.330433 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986f83c1-5c8b-4d60-aa46-0cb869fa6fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1885b00>]}
2022-07-31 00:34:39.341036 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986f83c1-5c8b-4d60-aa46-0cb869fa6fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee17a1860>]}
2022-07-31 00:34:39.341445 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:34:39.342186 (MainThread): 
2022-07-31 00:34:39.342490 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:34:39.343241 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:34:39.354705 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:34:39.354831 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:34:39.354913 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:34:40.202225 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.85 seconds
2022-07-31 00:34:40.206514 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:34:40.329322 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:34:40.338207 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:34:40.338374 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:34:40.338485 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:34:40.826763 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.49 seconds
2022-07-31 00:34:40.828250 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:34:40.941552 (MainThread): Using snowflake connection "master".
2022-07-31 00:34:40.941761 (MainThread): On master: BEGIN
2022-07-31 00:34:40.941889 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:34:41.604473 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2022-07-31 00:34:41.604830 (MainThread): On master: COMMIT
2022-07-31 00:34:41.605093 (MainThread): Using snowflake connection "master".
2022-07-31 00:34:41.605248 (MainThread): On master: COMMIT
2022-07-31 00:34:41.730794 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:34:41.731132 (MainThread): On master: Close
2022-07-31 00:34:41.847173 (MainThread): 19:34:41 | Concurrency: 8 threads (target='dev')
2022-07-31 00:34:41.847467 (MainThread): 19:34:41 | 
2022-07-31 00:34:41.849351 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:34:41.849712 (Thread-1): 19:34:41 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:34:41.850109 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:34:41.850279 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:34:41.857462 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:34:41.857650 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:34:41.857832 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:34:42.340358 (Thread-1): Snowflake query id: 01a5f6a2-0000-af4d-0002-a3d60001520e
2022-07-31 00:34:42.340741 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:34:42.343119 (Thread-1): finished collecting timing info
2022-07-31 00:34:42.343420 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:34:42.425893 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:34:42.435885 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986f83c1-5c8b-4d60-aa46-0cb869fa6fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1b55e48>]}
2022-07-31 00:34:42.436299 (Thread-1): 19:34:42 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.59s]
2022-07-31 00:34:42.436464 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:34:42.475324 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:34:42.475762 (MainThread): Using snowflake connection "master".
2022-07-31 00:34:42.475932 (MainThread): On master: BEGIN
2022-07-31 00:34:42.476085 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:34:42.993033 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:34:42.993361 (MainThread): On master: COMMIT
2022-07-31 00:34:42.993631 (MainThread): Using snowflake connection "master".
2022-07-31 00:34:42.993789 (MainThread): On master: COMMIT
2022-07-31 00:34:43.142044 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-07-31 00:34:43.142368 (MainThread): On master: Close
2022-07-31 00:34:43.261785 (MainThread): 19:34:43 | 
2022-07-31 00:34:43.262047 (MainThread): 19:34:43 | Finished running 1 table model in 3.92s.
2022-07-31 00:34:43.262217 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:34:43.262328 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:34:43.278348 (MainThread): 
2022-07-31 00:34:43.278599 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:34:43.278758 (MainThread): 
2022-07-31 00:34:43.278925 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:34:43.279109 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:34:43.279338 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:34:43.279504 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:34:43.279648 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:34:43.279878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1c064a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1c06748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1c06c18>]}
2022-07-31 00:34:43.280153 (MainThread): Flushing usage events
2022-07-31 00:36:32.030844 (MainThread): Running with dbt=0.19.1
2022-07-31 00:36:32.943709 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:36:33.008237 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:36:33.010848 (MainThread): Tracking: tracking
2022-07-31 00:36:33.011589 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacb7bbe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0591be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0591470>]}
2022-07-31 00:36:33.025277 (MainThread): Partial parsing not enabled
2022-07-31 00:36:33.027008 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:36:33.030359 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:36:33.061400 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:36:33.064074 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:36:33.065880 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:36:33.070256 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:36:33.082555 (MainThread): Parsing macros/core.sql
2022-07-31 00:36:33.086757 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:36:33.096228 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:36:33.098251 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:36:33.201031 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:36:33.242297 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:36:33.263501 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:36:33.265615 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:36:33.271872 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:36:33.285932 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:36:33.292990 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:36:33.299786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:36:33.304852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:36:33.306076 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:36:33.307397 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:36:33.309176 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:36:33.317889 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:36:33.320164 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:36:33.322151 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:36:33.363569 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:36:33.365834 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:36:33.367533 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:36:33.369308 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:36:33.379747 (MainThread): Partial parsing not enabled
2022-07-31 00:36:33.401542 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:36:33.411205 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:36:33.414662 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:36:33.481237 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:36:33.481671 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87da3e7-840f-4498-b241-13e5e3364012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad097ea58>]}
2022-07-31 00:36:33.485917 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87da3e7-840f-4498-b241-13e5e3364012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace49e128>]}
2022-07-31 00:36:33.486192 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:36:33.486907 (MainThread): 
2022-07-31 00:36:33.487209 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:36:33.487972 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:36:33.499876 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:36:33.500036 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:36:33.500122 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:36:34.433675 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.93 seconds
2022-07-31 00:36:34.439070 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:36:34.558473 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:36:34.567648 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:36:34.567856 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:36:34.567969 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:36:35.225996 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.66 seconds
2022-07-31 00:36:35.227899 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:36:35.350142 (MainThread): Using snowflake connection "master".
2022-07-31 00:36:35.350372 (MainThread): On master: BEGIN
2022-07-31 00:36:35.350496 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:36:35.850900 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:36:35.851239 (MainThread): On master: COMMIT
2022-07-31 00:36:35.851505 (MainThread): Using snowflake connection "master".
2022-07-31 00:36:35.851661 (MainThread): On master: COMMIT
2022-07-31 00:36:35.973630 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:36:35.974021 (MainThread): On master: Close
2022-07-31 00:36:36.088193 (MainThread): 19:36:36 | Concurrency: 8 threads (target='dev')
2022-07-31 00:36:36.088472 (MainThread): 19:36:36 | 
2022-07-31 00:36:36.090506 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:36:36.090887 (Thread-1): 19:36:36 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:36:36.091407 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:36:36.091597 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:36:36.098930 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:36:36.099129 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:36:36.099242 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:36:36.638796 (Thread-1): Snowflake query id: 01a5f6a4-0000-af4d-0002-a3d600015222
2022-07-31 00:36:36.638990 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:36:36.640568 (Thread-1): finished collecting timing info
2022-07-31 00:36:36.640759 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:36:36.712811 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:36:36.721524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87da3e7-840f-4498-b241-13e5e3364012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0d07fd0>]}
2022-07-31 00:36:36.722023 (Thread-1): 19:36:36 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.63s]
2022-07-31 00:36:36.722194 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:36:36.823477 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:36:36.824115 (MainThread): Using snowflake connection "master".
2022-07-31 00:36:36.824368 (MainThread): On master: BEGIN
2022-07-31 00:36:36.824608 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:36:37.345903 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:36:37.346373 (MainThread): On master: COMMIT
2022-07-31 00:36:37.346710 (MainThread): Using snowflake connection "master".
2022-07-31 00:36:37.346866 (MainThread): On master: COMMIT
2022-07-31 00:36:37.481406 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:36:37.481846 (MainThread): On master: Close
2022-07-31 00:36:37.601097 (MainThread): 19:36:37 | 
2022-07-31 00:36:37.601401 (MainThread): 19:36:37 | Finished running 1 table model in 4.11s.
2022-07-31 00:36:37.601614 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:36:37.601778 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:36:37.611446 (MainThread): 
2022-07-31 00:36:37.611670 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:36:37.611808 (MainThread): 
2022-07-31 00:36:37.611934 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:36:37.612048 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:36:37.612151 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:36:37.612251 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:36:37.612361 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:36:37.612557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0aa2eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacbceae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0d502e8>]}
2022-07-31 00:36:37.612793 (MainThread): Flushing usage events
2022-07-31 00:37:40.041293 (MainThread): Running with dbt=0.19.1
2022-07-31 00:37:41.029954 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:37:41.095617 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:37:41.099315 (MainThread): Tracking: tracking
2022-07-31 00:37:41.100129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8345e2ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8345e2cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8345e2c88>]}
2022-07-31 00:37:41.115462 (MainThread): Partial parsing not enabled
2022-07-31 00:37:41.116963 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:37:41.119628 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:37:41.149658 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:37:41.152038 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:37:41.153816 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:37:41.158338 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:37:41.170796 (MainThread): Parsing macros/core.sql
2022-07-31 00:37:41.175108 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:37:41.184005 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:37:41.185912 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:37:41.290166 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:37:41.331153 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:37:41.352287 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:37:41.354440 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:37:41.360976 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:37:41.376001 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:37:41.383265 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:37:41.389771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:37:41.395376 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:37:41.396613 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:37:41.397876 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:37:41.399629 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:37:41.408479 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:37:41.410608 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:37:41.412395 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:37:41.453648 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:37:41.456137 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:37:41.458128 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:37:41.460012 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:37:41.468008 (MainThread): Partial parsing not enabled
2022-07-31 00:37:41.489229 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:37:41.499732 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:37:41.503149 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:37:41.507007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8346f05f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8347249e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc834724a20>]}
2022-07-31 00:37:41.507197 (MainThread): Flushing usage events
2022-07-31 00:37:41.907213 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:37:41.907555 (MainThread): Encountered an error:
2022-07-31 00:37:41.907806 (MainThread): Compilation Error in model candidates (models/yello_dw/candidates.sql)
  Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
    line 34
      {% endif %}
2022-07-31 00:37:41.919613 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 34, in template
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
  line 34
    {% endif %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    native=native,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 504, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/yello_dw/candidates.sql)
  Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endfor' or 'else'. The innermost block that needs to be closed is 'for'.
    line 34
      {% endif %}

2022-07-31 00:38:06.576755 (MainThread): Running with dbt=0.19.1
2022-07-31 00:38:07.551658 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:38:07.616761 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:38:07.619054 (MainThread): Tracking: tracking
2022-07-31 00:38:07.619751 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b24111d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ad913dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b2430780>]}
2022-07-31 00:38:07.634337 (MainThread): Partial parsing not enabled
2022-07-31 00:38:07.635876 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:38:07.638485 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:38:07.669413 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:38:07.671684 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:38:07.673427 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:38:07.677827 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:38:07.690652 (MainThread): Parsing macros/core.sql
2022-07-31 00:38:07.695282 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:38:07.704712 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:38:07.706866 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:38:07.813097 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:38:07.852354 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:38:07.873924 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:38:07.876092 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:38:07.882460 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:38:07.896974 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:38:07.904694 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:38:07.911259 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:38:07.916205 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:38:07.917367 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:38:07.918644 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:38:07.920425 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:38:07.930820 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:38:07.934588 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:38:07.936614 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:38:07.979539 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:38:07.981621 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:38:07.983279 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:38:07.985272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:38:07.993610 (MainThread): Partial parsing not enabled
2022-07-31 00:38:08.015936 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:38:08.026628 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:38:08.031078 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:08.108897 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:38:08.109369 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77654a1-5c35-4641-a2ba-7c009ad50880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b2838470>]}
2022-07-31 00:38:08.119852 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77654a1-5c35-4641-a2ba-7c009ad50880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b27fb978>]}
2022-07-31 00:38:08.120154 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:38:08.120819 (MainThread): 
2022-07-31 00:38:08.121128 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:38:08.121956 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:38:08.134112 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:38:08.134266 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:38:08.134346 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:38:08.977204 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.84 seconds
2022-07-31 00:38:08.980559 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:38:09.113501 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:38:09.122043 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:38:09.122203 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:38:09.122310 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:38:09.638903 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.52 seconds
2022-07-31 00:38:09.639939 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:38:09.757036 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:09.757246 (MainThread): On master: BEGIN
2022-07-31 00:38:09.757363 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:38:10.254155 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:38:10.254512 (MainThread): On master: COMMIT
2022-07-31 00:38:10.254783 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:10.254941 (MainThread): On master: COMMIT
2022-07-31 00:38:10.385156 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:38:10.385656 (MainThread): On master: Close
2022-07-31 00:38:10.499334 (MainThread): 19:38:10 | Concurrency: 8 threads (target='dev')
2022-07-31 00:38:10.499635 (MainThread): 19:38:10 | 
2022-07-31 00:38:10.501701 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:38:10.502078 (Thread-1): 19:38:10 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:38:10.502488 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:10.502641 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:38:10.512832 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:10.512968 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:38:10.513074 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:38:11.010115 (Thread-1): Snowflake query id: 01a5f6a6-0000-af49-0002-a3d60001428a
2022-07-31 00:38:11.010367 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:11.013545 (Thread-1): finished collecting timing info
2022-07-31 00:38:11.013780 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:38:11.075795 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:11.091479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77654a1-5c35-4641-a2ba-7c009ad50880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b284ee10>]}
2022-07-31 00:38:11.091922 (Thread-1): 19:38:11 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.59s]
2022-07-31 00:38:11.092067 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:38:11.126558 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:38:11.127320 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:11.127607 (MainThread): On master: BEGIN
2022-07-31 00:38:11.127853 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:38:11.649503 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:38:11.649908 (MainThread): On master: COMMIT
2022-07-31 00:38:11.650183 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:11.650340 (MainThread): On master: COMMIT
2022-07-31 00:38:11.781279 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:38:11.781760 (MainThread): On master: Close
2022-07-31 00:38:11.901206 (MainThread): 19:38:11 | 
2022-07-31 00:38:11.901493 (MainThread): 19:38:11 | Finished running 1 table model in 3.78s.
2022-07-31 00:38:11.901668 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:38:11.901782 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:38:11.918667 (MainThread): 
2022-07-31 00:38:11.918908 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:38:11.919045 (MainThread): 
2022-07-31 00:38:11.919172 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:38:11.919284 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:38:11.919386 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:38:11.919484 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:11.919589 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:38:11.919792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b27857f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ad913dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b2575978>]}
2022-07-31 00:38:11.920136 (MainThread): Flushing usage events
2022-07-31 00:38:34.407514 (MainThread): Running with dbt=0.19.1
2022-07-31 00:38:35.304549 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:38:35.368588 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:38:35.372639 (MainThread): Tracking: tracking
2022-07-31 00:38:35.373372 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba92112e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97486828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97486c18>]}
2022-07-31 00:38:35.387848 (MainThread): Partial parsing not enabled
2022-07-31 00:38:35.389748 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:38:35.392511 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:38:35.423573 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:38:35.425899 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:38:35.427606 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:38:35.431764 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:38:35.444502 (MainThread): Parsing macros/core.sql
2022-07-31 00:38:35.448648 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:38:35.457988 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:38:35.459956 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:38:35.562889 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:38:35.601880 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:38:35.623529 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:38:35.625698 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:38:35.632192 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:38:35.651595 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:38:35.659424 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:38:35.665997 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:38:35.671521 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:38:35.672924 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:38:35.674203 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:38:35.675999 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:38:35.684756 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:38:35.686891 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:38:35.689306 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:38:35.734222 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:38:35.736543 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:38:35.738420 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:38:35.740313 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:38:35.748515 (MainThread): Partial parsing not enabled
2022-07-31 00:38:35.769964 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:38:35.779527 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:38:35.782889 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:35.852092 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:38:35.852577 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0dd231f-0edc-43dd-8ef2-76e5a75559f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba976c3438>]}
2022-07-31 00:38:35.857662 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0dd231f-0edc-43dd-8ef2-76e5a75559f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba9783bbe0>]}
2022-07-31 00:38:35.857939 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:38:35.858581 (MainThread): 
2022-07-31 00:38:35.858886 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:38:35.859693 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:38:35.871330 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:38:35.871480 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:38:35.871557 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:38:36.660789 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.79 seconds
2022-07-31 00:38:36.666458 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:38:36.779549 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:38:36.788348 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:38:36.788621 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:38:36.788744 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:38:37.412712 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.62 seconds
2022-07-31 00:38:37.414264 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:38:37.537490 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:37.537746 (MainThread): On master: BEGIN
2022-07-31 00:38:37.537897 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:38:38.060925 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 00:38:38.061272 (MainThread): On master: COMMIT
2022-07-31 00:38:38.061534 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:38.061688 (MainThread): On master: COMMIT
2022-07-31 00:38:38.183773 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:38:38.184262 (MainThread): On master: Close
2022-07-31 00:38:38.301860 (MainThread): 19:38:38 | Concurrency: 8 threads (target='dev')
2022-07-31 00:38:38.302173 (MainThread): 19:38:38 | 
2022-07-31 00:38:38.304403 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:38:38.304792 (Thread-1): 19:38:38 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:38:38.305202 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:38.305375 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:38:38.315736 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:38:38.315887 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:38:38.315994 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:38:38.798822 (Thread-1): Snowflake query id: 01a5f6a6-0000-af49-0002-a3d60001429a
2022-07-31 00:38:38.799231 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:38.801420 (Thread-1): finished collecting timing info
2022-07-31 00:38:38.801706 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:38:38.862840 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:38.870839 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0dd231f-0edc-43dd-8ef2-76e5a75559f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97809cc0>]}
2022-07-31 00:38:38.871287 (Thread-1): 19:38:38 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.57s]
2022-07-31 00:38:38.871458 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:38:38.923396 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:38:38.923860 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:38.924032 (MainThread): On master: BEGIN
2022-07-31 00:38:38.924196 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:38:39.431257 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:38:39.431604 (MainThread): On master: COMMIT
2022-07-31 00:38:39.431871 (MainThread): Using snowflake connection "master".
2022-07-31 00:38:39.432029 (MainThread): On master: COMMIT
2022-07-31 00:38:39.560643 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:38:39.560997 (MainThread): On master: Close
2022-07-31 00:38:39.686664 (MainThread): 19:38:39 | 
2022-07-31 00:38:39.686946 (MainThread): 19:38:39 | Finished running 1 table model in 3.83s.
2022-07-31 00:38:39.687229 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:38:39.687440 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:38:39.697061 (MainThread): 
2022-07-31 00:38:39.697279 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:38:39.697409 (MainThread): 
2022-07-31 00:38:39.697533 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:38:39.697642 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:38:39.697739 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:38:39.697835 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:38:39.697938 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:38:39.698134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba976c32e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba976ac588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba97b6be10>]}
2022-07-31 00:38:39.698357 (MainThread): Flushing usage events
2022-07-31 00:39:51.024290 (MainThread): Running with dbt=0.19.1
2022-07-31 00:39:51.909874 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:39:51.975344 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:39:51.977804 (MainThread): Tracking: tracking
2022-07-31 00:39:51.978411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa8d2dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aff5c07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aff5c0828>]}
2022-07-31 00:39:51.992913 (MainThread): Partial parsing not enabled
2022-07-31 00:39:51.994630 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:39:51.997359 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:39:52.028053 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:39:52.030596 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:39:52.032330 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:39:52.036477 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:39:52.048797 (MainThread): Parsing macros/core.sql
2022-07-31 00:39:52.052935 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:39:52.062288 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:39:52.064483 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:39:52.170374 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:39:52.209433 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:39:52.230859 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:39:52.232955 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:39:52.239085 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:39:52.253350 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:39:52.260866 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:39:52.267378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:39:52.272533 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:39:52.273946 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:39:52.275301 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:39:52.277202 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:39:52.285980 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:39:52.288153 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:39:52.289959 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:39:52.331614 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:39:52.333729 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:39:52.335477 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:39:52.337396 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:39:52.345340 (MainThread): Partial parsing not enabled
2022-07-31 00:39:52.366458 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:39:52.378118 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:39:52.381918 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:39:52.455799 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:39:52.456202 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3721c87-07e6-4892-ae48-1d5056e488f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aff720ac8>]}
2022-07-31 00:39:52.462664 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3721c87-07e6-4892-ae48-1d5056e488f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aff97d9b0>]}
2022-07-31 00:39:52.462952 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:39:52.463594 (MainThread): 
2022-07-31 00:39:52.463897 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:39:52.464695 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:39:52.476306 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:39:52.476449 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:39:52.476531 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:39:53.317165 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.84 seconds
2022-07-31 00:39:53.321107 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:39:53.436421 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:39:53.445180 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:39:53.445368 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:39:53.445480 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:39:53.941106 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.50 seconds
2022-07-31 00:39:53.942749 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:39:54.056457 (MainThread): Using snowflake connection "master".
2022-07-31 00:39:54.056690 (MainThread): On master: BEGIN
2022-07-31 00:39:54.056862 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:39:54.691881 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2022-07-31 00:39:54.692208 (MainThread): On master: COMMIT
2022-07-31 00:39:54.692406 (MainThread): Using snowflake connection "master".
2022-07-31 00:39:54.692507 (MainThread): On master: COMMIT
2022-07-31 00:39:54.823798 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:39:54.824061 (MainThread): On master: Close
2022-07-31 00:39:54.936430 (MainThread): 19:39:54 | Concurrency: 8 threads (target='dev')
2022-07-31 00:39:54.936713 (MainThread): 19:39:54 | 
2022-07-31 00:39:54.938730 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:39:54.939112 (Thread-1): 19:39:54 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:39:54.939509 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:39:54.939682 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:39:54.949659 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:39:54.949818 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:39:54.949924 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:39:55.435949 (Thread-1): Snowflake query id: 01a5f6a7-0000-af49-0002-a3d6000142ae
2022-07-31 00:39:55.436355 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:39:55.438884 (Thread-1): finished collecting timing info
2022-07-31 00:39:55.439182 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:39:55.507363 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:39:55.515974 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3721c87-07e6-4892-ae48-1d5056e488f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8affc1b400>]}
2022-07-31 00:39:55.516419 (Thread-1): 19:39:55 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.58s]
2022-07-31 00:39:55.516589 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:39:55.557757 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:39:55.558153 (MainThread): Using snowflake connection "master".
2022-07-31 00:39:55.558298 (MainThread): On master: BEGIN
2022-07-31 00:39:55.558422 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:39:56.088869 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-31 00:39:56.089371 (MainThread): On master: COMMIT
2022-07-31 00:39:56.089725 (MainThread): Using snowflake connection "master".
2022-07-31 00:39:56.089884 (MainThread): On master: COMMIT
2022-07-31 00:39:56.230104 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 00:39:56.230464 (MainThread): On master: Close
2022-07-31 00:39:56.350484 (MainThread): 19:39:56 | 
2022-07-31 00:39:56.350758 (MainThread): 19:39:56 | Finished running 1 table model in 3.89s.
2022-07-31 00:39:56.350915 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:39:56.351047 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:39:56.363093 (MainThread): 
2022-07-31 00:39:56.363328 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:39:56.363480 (MainThread): 
2022-07-31 00:39:56.363614 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:39:56.363729 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:39:56.363832 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:39:56.363929 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:39:56.364050 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:39:56.364248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afabcbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8afa8d2dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aff7032e8>]}
2022-07-31 00:39:56.364477 (MainThread): Flushing usage events
2022-07-31 00:40:11.167122 (MainThread): Running with dbt=0.19.1
2022-07-31 00:40:12.028294 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:40:12.093640 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:40:12.096977 (MainThread): Tracking: tracking
2022-07-31 00:40:12.097594 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23e0d2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2435914a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd243591860>]}
2022-07-31 00:40:12.110945 (MainThread): Partial parsing not enabled
2022-07-31 00:40:12.112454 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:40:12.115231 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:40:12.147253 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:40:12.149564 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:40:12.151293 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:40:12.155730 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:40:12.168731 (MainThread): Parsing macros/core.sql
2022-07-31 00:40:12.173004 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:40:12.182878 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:40:12.185141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:40:12.270575 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:40:12.307791 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:40:12.331933 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:40:12.334212 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:40:12.341467 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:40:12.357375 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:40:12.365777 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:40:12.372724 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:40:12.378776 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:40:12.379985 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:40:12.381214 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:40:12.383029 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:40:12.392956 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:40:12.395329 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:40:12.397230 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:40:12.439264 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:40:12.441352 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:40:12.443281 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:40:12.445132 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:40:12.453230 (MainThread): Partial parsing not enabled
2022-07-31 00:40:12.475252 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:40:12.485181 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:40:12.488629 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:40:12.561631 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:40:12.562112 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a54db0f-d850-48fd-99fb-95a813739bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd243976518>]}
2022-07-31 00:40:12.566676 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a54db0f-d850-48fd-99fb-95a813739bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd24393abe0>]}
2022-07-31 00:40:12.567007 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:40:12.567814 (MainThread): 
2022-07-31 00:40:12.568267 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:40:12.569052 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:40:12.581396 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:40:12.581515 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:40:12.581588 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:40:13.363971 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.78 seconds
2022-07-31 00:40:13.367247 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:40:13.529027 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:40:13.537553 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:40:13.537696 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:40:13.537800 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:40:14.042669 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.50 seconds
2022-07-31 00:40:14.044338 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:40:14.160122 (MainThread): Using snowflake connection "master".
2022-07-31 00:40:14.160328 (MainThread): On master: BEGIN
2022-07-31 00:40:14.160450 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:40:14.829948 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2022-07-31 00:40:14.830253 (MainThread): On master: COMMIT
2022-07-31 00:40:14.830513 (MainThread): Using snowflake connection "master".
2022-07-31 00:40:14.830667 (MainThread): On master: COMMIT
2022-07-31 00:40:14.961523 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:40:14.962039 (MainThread): On master: Close
2022-07-31 00:40:15.076133 (MainThread): 19:40:15 | Concurrency: 8 threads (target='dev')
2022-07-31 00:40:15.076381 (MainThread): 19:40:15 | 
2022-07-31 00:40:15.078195 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:40:15.078500 (Thread-1): 19:40:15 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:40:15.078823 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:40:15.078957 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:40:15.088660 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:40:15.088796 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:40:15.088890 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:40:15.597336 (Thread-1): Snowflake query id: 01a5f6a8-0000-af4d-0002-a3d60001524a
2022-07-31 00:40:15.597608 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:40:15.599403 (Thread-1): finished collecting timing info
2022-07-31 00:40:15.599614 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:40:15.665625 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:40:15.673705 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a54db0f-d850-48fd-99fb-95a813739bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2437e5710>]}
2022-07-31 00:40:15.674093 (Thread-1): 19:40:15 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.59s]
2022-07-31 00:40:15.674243 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:40:15.697416 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:40:15.697847 (MainThread): Using snowflake connection "master".
2022-07-31 00:40:15.698017 (MainThread): On master: BEGIN
2022-07-31 00:40:15.698167 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:40:16.198672 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:40:16.198985 (MainThread): On master: COMMIT
2022-07-31 00:40:16.199240 (MainThread): Using snowflake connection "master".
2022-07-31 00:40:16.199386 (MainThread): On master: COMMIT
2022-07-31 00:40:16.323890 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:40:16.324338 (MainThread): On master: Close
2022-07-31 00:40:16.438004 (MainThread): 19:40:16 | 
2022-07-31 00:40:16.438249 (MainThread): 19:40:16 | Finished running 1 table model in 3.87s.
2022-07-31 00:40:16.438398 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:40:16.438501 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:40:16.447385 (MainThread): 
2022-07-31 00:40:16.447579 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:40:16.447705 (MainThread): 
2022-07-31 00:40:16.447820 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:40:16.447924 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:40:16.448017 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:40:16.448107 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:40:16.448204 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:40:16.448377 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd243b49390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd243a908d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23e384470>]}
2022-07-31 00:40:16.448592 (MainThread): Flushing usage events
2022-07-31 00:48:30.784482 (MainThread): Running with dbt=0.19.1
2022-07-31 00:48:31.964859 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:48:32.031692 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:48:32.034524 (MainThread): Tracking: tracking
2022-07-31 00:48:32.035217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa58d2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa570c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa570ba8>]}
2022-07-31 00:48:32.048194 (MainThread): Partial parsing not enabled
2022-07-31 00:48:32.049666 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:48:32.052272 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:48:32.083512 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:48:32.085811 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:48:32.087658 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:48:32.091978 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:48:32.105203 (MainThread): Parsing macros/core.sql
2022-07-31 00:48:32.109725 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:48:32.118702 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:48:32.121114 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:48:32.192809 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:48:32.228002 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:48:32.256862 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:48:32.259421 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:48:32.266335 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:48:32.280765 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:48:32.288301 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:48:32.294728 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:48:32.299887 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:48:32.301172 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:48:32.302589 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:48:32.305054 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:48:32.314057 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:48:32.316435 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:48:32.318450 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:48:32.360069 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:48:32.362482 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:48:32.364514 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:48:32.366541 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:48:32.375071 (MainThread): Partial parsing not enabled
2022-07-31 00:48:32.398132 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:48:32.409203 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:48:32.412852 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:48:32.485292 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:48:32.485663 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaa83689-beb0-422c-8f9a-b96310438620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa6c8a90>]}
2022-07-31 00:48:32.500456 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaa83689-beb0-422c-8f9a-b96310438620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa822a20>]}
2022-07-31 00:48:32.500764 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:48:32.501532 (MainThread): 
2022-07-31 00:48:32.501888 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:48:32.502806 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:48:32.515754 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:48:32.515881 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:48:32.515963 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:48:33.333473 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2022-07-31 00:48:33.336992 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:48:33.443836 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:48:33.449492 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:48:33.449622 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:48:33.449699 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:48:33.925076 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.48 seconds
2022-07-31 00:48:33.926644 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:48:34.038227 (MainThread): Using snowflake connection "master".
2022-07-31 00:48:34.038462 (MainThread): On master: BEGIN
2022-07-31 00:48:34.038589 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:48:34.818877 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2022-07-31 00:48:34.819068 (MainThread): On master: COMMIT
2022-07-31 00:48:34.819222 (MainThread): Using snowflake connection "master".
2022-07-31 00:48:34.819305 (MainThread): On master: COMMIT
2022-07-31 00:48:34.951119 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:48:34.951574 (MainThread): On master: Close
2022-07-31 00:48:35.074316 (MainThread): 19:48:35 | Concurrency: 8 threads (target='dev')
2022-07-31 00:48:35.074572 (MainThread): 19:48:35 | 
2022-07-31 00:48:35.076557 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:48:35.076922 (Thread-1): 19:48:35 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:48:35.077316 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:48:35.077485 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:48:35.088112 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:48:35.088271 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:48:35.088412 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:48:35.569590 (Thread-1): Snowflake query id: 01a5f6b0-0000-af4d-0002-a3d600015252
2022-07-31 00:48:35.570035 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:48:35.574078 (Thread-1): finished collecting timing info
2022-07-31 00:48:35.574436 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:48:35.643899 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:48:35.660372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa83689-beb0-422c-8f9a-b96310438620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaab34ac8>]}
2022-07-31 00:48:35.660783 (Thread-1): 19:48:35 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.58s]
2022-07-31 00:48:35.660947 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:48:35.698252 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:48:35.698661 (MainThread): Using snowflake connection "master".
2022-07-31 00:48:35.698839 (MainThread): On master: BEGIN
2022-07-31 00:48:35.698998 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:48:36.192930 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 00:48:36.193389 (MainThread): On master: COMMIT
2022-07-31 00:48:36.193778 (MainThread): Using snowflake connection "master".
2022-07-31 00:48:36.193934 (MainThread): On master: COMMIT
2022-07-31 00:48:36.317410 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:48:36.317874 (MainThread): On master: Close
2022-07-31 00:48:36.436691 (MainThread): 19:48:36 | 
2022-07-31 00:48:36.436949 (MainThread): 19:48:36 | Finished running 1 table model in 3.93s.
2022-07-31 00:48:36.437109 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:48:36.437225 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:48:36.453608 (MainThread): 
2022-07-31 00:48:36.453813 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:48:36.453943 (MainThread): 
2022-07-31 00:48:36.454064 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:48:36.454175 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:48:36.454274 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:48:36.454371 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:48:36.454473 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:48:36.454654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa6d7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa6ad358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaa694588>]}
2022-07-31 00:48:36.454880 (MainThread): Flushing usage events
2022-07-31 00:49:13.690627 (MainThread): Running with dbt=0.19.1
2022-07-31 00:49:14.522304 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:49:14.586009 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:49:14.589396 (MainThread): Tracking: tracking
2022-07-31 00:49:14.590210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92a68ace48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab56fb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab56f7f0>]}
2022-07-31 00:49:14.603514 (MainThread): Partial parsing not enabled
2022-07-31 00:49:14.605027 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:49:14.607679 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:49:14.638967 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:49:14.641621 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:49:14.643330 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:49:14.647460 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:49:14.659621 (MainThread): Parsing macros/core.sql
2022-07-31 00:49:14.663641 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:49:14.673084 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:49:14.675098 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:49:14.746551 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:49:14.780574 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:49:14.802008 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:49:14.804166 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:49:14.810624 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:49:14.825186 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:49:14.831992 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:49:14.838684 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:49:14.843795 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:49:14.844943 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:49:14.846154 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:49:14.847908 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:49:14.857058 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:49:14.859376 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:49:14.861249 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:49:14.908907 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:49:14.911022 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:49:14.912707 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:49:14.914903 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:49:14.922811 (MainThread): Partial parsing not enabled
2022-07-31 00:49:14.943351 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:49:14.952644 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:49:14.956110 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:49:15.025418 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:49:15.025791 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6be31f2-adf1-4b9d-8e55-78a5a12aeeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab860518>]}
2022-07-31 00:49:15.029965 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6be31f2-adf1-4b9d-8e55-78a5a12aeeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab822be0>]}
2022-07-31 00:49:15.030177 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:49:15.030721 (MainThread): 
2022-07-31 00:49:15.030973 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:49:15.031692 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:49:15.044628 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:49:15.044751 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:49:15.044828 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:49:15.857025 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.81 seconds
2022-07-31 00:49:15.860305 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:49:15.966055 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:49:15.971836 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:49:15.971956 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:49:15.972034 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:49:16.455675 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.48 seconds
2022-07-31 00:49:16.456734 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:49:16.567015 (MainThread): Using snowflake connection "master".
2022-07-31 00:49:16.567207 (MainThread): On master: BEGIN
2022-07-31 00:49:16.567313 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:49:17.218714 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2022-07-31 00:49:17.219200 (MainThread): On master: COMMIT
2022-07-31 00:49:17.219468 (MainThread): Using snowflake connection "master".
2022-07-31 00:49:17.219623 (MainThread): On master: COMMIT
2022-07-31 00:49:17.349222 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:49:17.349719 (MainThread): On master: Close
2022-07-31 00:49:17.605327 (MainThread): 19:49:17 | Concurrency: 8 threads (target='dev')
2022-07-31 00:49:17.605592 (MainThread): 19:49:17 | 
2022-07-31 00:49:17.607711 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:49:17.608050 (Thread-1): 19:49:17 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:49:17.608390 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:49:17.608532 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:49:17.618526 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:49:17.618663 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:49:17.618758 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:49:18.372257 (Thread-1): Snowflake query id: 01a5f6b1-0000-af4d-0002-a3d60001525e
2022-07-31 00:49:18.372534 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:49:18.374350 (Thread-1): finished collecting timing info
2022-07-31 00:49:18.374569 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:49:18.565413 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:49:18.573894 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6be31f2-adf1-4b9d-8e55-78a5a12aeeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92abc471d0>]}
2022-07-31 00:49:18.574299 (Thread-1): 19:49:18 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.97s]
2022-07-31 00:49:18.574479 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:49:18.648491 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:49:18.648980 (MainThread): Using snowflake connection "master".
2022-07-31 00:49:18.649145 (MainThread): On master: BEGIN
2022-07-31 00:49:18.649298 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:49:19.629256 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2022-07-31 00:49:19.629576 (MainThread): On master: COMMIT
2022-07-31 00:49:19.629961 (MainThread): Using snowflake connection "master".
2022-07-31 00:49:19.630175 (MainThread): On master: COMMIT
2022-07-31 00:49:19.812857 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-07-31 00:49:19.813344 (MainThread): On master: Close
2022-07-31 00:49:20.182144 (MainThread): 19:49:20 | 
2022-07-31 00:49:20.182393 (MainThread): 19:49:20 | Finished running 1 table model in 5.15s.
2022-07-31 00:49:20.182550 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:49:20.182659 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:49:20.191371 (MainThread): 
2022-07-31 00:49:20.191561 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:49:20.191691 (MainThread): 
2022-07-31 00:49:20.191814 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:49:20.191921 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:49:20.192019 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:49:20.192113 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:49:20.192243 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:49:20.192401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab822be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ab7d6438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92abb9eac8>]}
2022-07-31 00:49:20.192591 (MainThread): Flushing usage events
2022-07-31 00:54:06.767981 (MainThread): Running with dbt=0.19.1
2022-07-31 00:54:07.592582 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:54:07.658277 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:54:07.660835 (MainThread): Tracking: tracking
2022-07-31 00:54:07.661614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7268d3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b4b87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b4b8ba8>]}
2022-07-31 00:54:07.674869 (MainThread): Partial parsing not enabled
2022-07-31 00:54:07.676332 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:54:07.678836 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:54:07.708730 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:54:07.711026 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:54:07.712729 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:54:07.717104 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:54:07.729557 (MainThread): Parsing macros/core.sql
2022-07-31 00:54:07.734125 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:54:07.743378 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:54:07.745347 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:54:07.820856 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:54:07.855357 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:54:07.876576 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:54:07.878655 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:54:07.885233 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:54:07.898830 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:54:07.905981 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:54:07.912171 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:54:07.917357 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:54:07.918690 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:54:07.920297 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:54:07.922149 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:54:07.930961 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:54:07.933785 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:54:07.935677 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:54:07.978252 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:54:07.980490 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:54:07.982425 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:54:07.984981 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:54:07.995858 (MainThread): Partial parsing not enabled
2022-07-31 00:54:08.018352 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:54:08.028137 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:54:08.031962 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:54:08.101754 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:54:08.102150 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '264b903f-7feb-4458-98cf-9526c4e95acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b9b94a8>]}
2022-07-31 00:54:08.108339 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '264b903f-7feb-4458-98cf-9526c4e95acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b97c9b0>]}
2022-07-31 00:54:08.108569 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:54:08.109290 (MainThread): 
2022-07-31 00:54:08.109576 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:54:08.110408 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:54:08.121982 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:54:08.122099 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:54:08.122177 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:54:08.956653 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.83 seconds
2022-07-31 00:54:08.959970 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:54:09.083960 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:54:09.089832 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:54:09.089969 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:54:09.090051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:54:09.837611 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.75 seconds
2022-07-31 00:54:09.838858 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:54:09.956863 (MainThread): Using snowflake connection "master".
2022-07-31 00:54:09.957028 (MainThread): On master: BEGIN
2022-07-31 00:54:09.957140 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:54:10.468222 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:54:10.468549 (MainThread): On master: COMMIT
2022-07-31 00:54:10.468826 (MainThread): Using snowflake connection "master".
2022-07-31 00:54:10.468987 (MainThread): On master: COMMIT
2022-07-31 00:54:10.600564 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:54:10.601102 (MainThread): On master: Close
2022-07-31 00:54:10.724312 (MainThread): 19:54:10 | Concurrency: 8 threads (target='dev')
2022-07-31 00:54:10.724569 (MainThread): 19:54:10 | 
2022-07-31 00:54:10.726663 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 00:54:10.727034 (Thread-1): 19:54:10 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:54:10.727431 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:54:10.727597 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 00:54:10.737859 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:54:10.738013 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:54:10.738109 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:54:11.217133 (Thread-1): Snowflake query id: 01a5f6b6-0000-af49-0002-a3d6000142e6
2022-07-31 00:54:11.217518 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:54:11.219890 (Thread-1): finished collecting timing info
2022-07-31 00:54:11.220182 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 00:54:11.287659 (Thread-1): Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/yello_dw/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:54:11.293315 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264b903f-7feb-4458-98cf-9526c4e95acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72bcc8240>]}
2022-07-31 00:54:11.293623 (Thread-1): 19:54:11 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.57s]
2022-07-31 00:54:11.293739 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 00:54:11.349806 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:54:11.350056 (MainThread): Using snowflake connection "master".
2022-07-31 00:54:11.350139 (MainThread): On master: BEGIN
2022-07-31 00:54:11.350210 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:54:11.886062 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-07-31 00:54:11.886527 (MainThread): On master: COMMIT
2022-07-31 00:54:11.886925 (MainThread): Using snowflake connection "master".
2022-07-31 00:54:11.887086 (MainThread): On master: COMMIT
2022-07-31 00:54:12.012223 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:54:12.012483 (MainThread): On master: Close
2022-07-31 00:54:12.126288 (MainThread): 19:54:12 | 
2022-07-31 00:54:12.126533 (MainThread): 19:54:12 | Finished running 1 table model in 4.02s.
2022-07-31 00:54:12.126695 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:54:12.126806 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:54:12.137985 (MainThread): 
2022-07-31 00:54:12.138182 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:54:12.138310 (MainThread): 
2022-07-31 00:54:12.138428 (MainThread): Database Error in model candidates (models/yello_dw/candidates.sql)
2022-07-31 00:54:12.138532 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:54:12.138628 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:54:12.138723 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:54:12.138837 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 00:54:12.139012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b804320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7268d3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b9728d0>]}
2022-07-31 00:54:12.139226 (MainThread): Flushing usage events
2022-07-31 00:56:02.194430 (MainThread): Running with dbt=0.19.1
2022-07-31 00:56:03.113328 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:56:03.180911 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:56:03.184990 (MainThread): Tracking: tracking
2022-07-31 00:56:03.185818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97050f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97050fcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970528c50>]}
2022-07-31 00:56:03.199039 (MainThread): Partial parsing not enabled
2022-07-31 00:56:03.200923 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:56:03.203879 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:56:03.238987 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:56:03.241739 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:56:03.243478 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:56:03.247870 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:56:03.261994 (MainThread): Parsing macros/core.sql
2022-07-31 00:56:03.266922 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:56:03.277445 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:56:03.279838 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:56:03.354366 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:56:03.390434 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:56:03.413308 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:56:03.415846 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:56:03.423062 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:56:03.439182 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:56:03.447271 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:56:03.454939 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:56:03.460119 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:56:03.461582 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:56:03.463038 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:56:03.464927 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:56:03.475416 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:56:03.478202 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:56:03.480138 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:56:03.524273 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:56:03.526468 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:56:03.528213 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:56:03.530265 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:56:03.539141 (MainThread): Partial parsing not enabled
2022-07-31 00:56:03.560032 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:56:03.569994 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:56:03.573498 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:56:03.647502 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:56:03.648011 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f851fed9-699b-49b0-bb2f-e2d2480fa441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97081f470>]}
2022-07-31 00:56:03.652818 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f851fed9-699b-49b0-bb2f-e2d2480fa441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9707e3978>]}
2022-07-31 00:56:03.653072 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:56:03.653727 (MainThread): 
2022-07-31 00:56:03.654046 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:56:03.654872 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:56:03.668538 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:56:03.668691 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:56:03.668832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:56:04.490474 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2022-07-31 00:56:04.493707 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:56:04.606702 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:56:04.612480 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:56:04.612589 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:56:04.612659 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:56:05.095695 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.48 seconds
2022-07-31 00:56:05.096495 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:56:05.214288 (MainThread): Using snowflake connection "master".
2022-07-31 00:56:05.214428 (MainThread): On master: BEGIN
2022-07-31 00:56:05.214500 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:56:05.721510 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 00:56:05.721958 (MainThread): On master: COMMIT
2022-07-31 00:56:05.722213 (MainThread): Using snowflake connection "master".
2022-07-31 00:56:05.722360 (MainThread): On master: COMMIT
2022-07-31 00:56:05.850460 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:56:05.850857 (MainThread): On master: Close
2022-07-31 00:56:05.972455 (MainThread): 19:56:05 | Concurrency: 8 threads (target='dev')
2022-07-31 00:56:05.972707 (MainThread): 19:56:05 | 
2022-07-31 00:56:05.974841 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 00:56:05.975071 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 00:56:05.975390 (Thread-1): 19:56:05 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 00:56:05.975653 (Thread-2): 19:56:05 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:56:05.976036 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:56:05.976465 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 00:56:05.977331 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:56:05.979413 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 00:56:05.979553 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 00:56:05.989740 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:56:05.989882 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:56:05.989970 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:56:05.992446 (Thread-1): finished collecting timing info
2022-07-31 00:56:06.019900 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 00:56:06.020942 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:56:06.021029 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 00:56:06.021097 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:56:06.811635 (Thread-2): Snowflake query id: 01a5f6b8-0000-af49-0002-a3d6000142f6
2022-07-31 00:56:06.811783 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:56:06.812832 (Thread-2): finished collecting timing info
2022-07-31 00:56:06.812977 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 00:56:06.834634 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2022-07-31 00:56:06.834803 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:56:06.834887 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 00:56:06.876951 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:56:06.882012 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f851fed9-699b-49b0-bb2f-e2d2480fa441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970856710>]}
2022-07-31 00:56:06.882316 (Thread-2): 19:56:06 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.91s]
2022-07-31 00:56:06.882431 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 00:56:07.749008 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2022-07-31 00:56:07.751139 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 00:56:07.751499 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:56:07.751676 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 00:56:07.834378 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-31 00:56:07.847926 (Thread-1): finished collecting timing info
2022-07-31 00:56:07.848129 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 00:56:07.961370 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f851fed9-699b-49b0-bb2f-e2d2480fa441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970c93dd8>]}
2022-07-31 00:56:07.961898 (Thread-1): 19:56:07 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.99s]
2022-07-31 00:56:07.962099 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 00:56:07.962717 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 00:56:07.963028 (Thread-3): 19:56:07 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 00:56:07.963413 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:56:07.963556 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 00:56:07.966711 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 00:56:07.967180 (Thread-3): finished collecting timing info
2022-07-31 00:56:07.987496 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 00:56:07.988268 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:56:07.988367 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 00:56:07.988453 (Thread-3): Opening a new connection, currently in state init
2022-07-31 00:56:08.478071 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 00:56:08.478223 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:56:08.478295 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 00:56:08.676209 (Thread-3): SQL status: SUCCESS 1 in 0.20 seconds
2022-07-31 00:56:08.677173 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 00:56:08.677310 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:56:08.677380 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 00:56:08.751166 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 00:56:08.751847 (Thread-3): finished collecting timing info
2022-07-31 00:56:08.751975 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 00:56:08.862634 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f851fed9-699b-49b0-bb2f-e2d2480fa441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970c739b0>]}
2022-07-31 00:56:08.863141 (Thread-3): 19:56:08 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.90s]
2022-07-31 00:56:08.863336 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 00:56:08.966786 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:56:08.967416 (MainThread): Using snowflake connection "master".
2022-07-31 00:56:08.967671 (MainThread): On master: BEGIN
2022-07-31 00:56:08.967923 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:56:09.464735 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 00:56:09.465164 (MainThread): On master: COMMIT
2022-07-31 00:56:09.465426 (MainThread): Using snowflake connection "master".
2022-07-31 00:56:09.465582 (MainThread): On master: COMMIT
2022-07-31 00:56:09.587643 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 00:56:09.588106 (MainThread): On master: Close
2022-07-31 00:56:09.701926 (MainThread): 19:56:09 | 
2022-07-31 00:56:09.702302 (MainThread): 19:56:09 | Finished running 2 table models, 1 view model in 6.05s.
2022-07-31 00:56:09.702654 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:56:09.702843 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 00:56:09.702958 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:56:09.703060 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 00:56:09.712038 (MainThread): 
2022-07-31 00:56:09.712236 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:56:09.712388 (MainThread): 
2022-07-31 00:56:09.712548 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 00:56:09.712721 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:56:09.712822 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:56:09.712908 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:56:09.713004 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 00:56:09.713169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97079f6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970d3fb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9707da898>]}
2022-07-31 00:56:09.713361 (MainThread): Flushing usage events
2022-07-31 00:57:44.213420 (MainThread): Running with dbt=0.19.1
2022-07-31 00:57:45.030499 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:57:45.095246 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:57:45.098202 (MainThread): Tracking: tracking
2022-07-31 00:57:45.098784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf55522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf00d3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf55687b8>]}
2022-07-31 00:57:45.111630 (MainThread): Partial parsing not enabled
2022-07-31 00:57:45.113036 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:57:45.115653 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:57:45.145354 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:57:45.147536 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:57:45.149241 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:57:45.153445 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:57:45.165698 (MainThread): Parsing macros/core.sql
2022-07-31 00:57:45.169760 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:57:45.179357 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:57:45.181297 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:57:45.255738 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:57:45.292730 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:57:45.314644 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:57:45.316699 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:57:45.323134 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:57:45.337618 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:57:45.344444 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:57:45.350907 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:57:45.355967 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:57:45.357130 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:57:45.359046 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:57:45.360852 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:57:45.369403 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:57:45.371506 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:57:45.373367 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:57:45.416542 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:57:45.418610 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:57:45.420266 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:57:45.422226 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:57:45.430721 (MainThread): Partial parsing not enabled
2022-07-31 00:57:45.451497 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:57:45.461479 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:57:45.465462 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:57:45.535402 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 00:57:45.535744 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9eaf4e-05a5-4c20-966b-9e7368d4a045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf56c8a90>]}
2022-07-31 00:57:45.541237 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9eaf4e-05a5-4c20-966b-9e7368d4a045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf593abe0>]}
2022-07-31 00:57:45.541501 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 00:57:45.542164 (MainThread): 
2022-07-31 00:57:45.542418 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:57:45.543224 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 00:57:45.554444 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 00:57:45.554544 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 00:57:45.554617 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 00:57:46.443350 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.89 seconds
2022-07-31 00:57:46.449050 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 00:57:46.566189 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:57:46.574470 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 00:57:46.574628 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 00:57:46.574732 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 00:57:47.071892 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.50 seconds
2022-07-31 00:57:47.073771 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 00:57:47.223948 (MainThread): Using snowflake connection "master".
2022-07-31 00:57:47.224174 (MainThread): On master: BEGIN
2022-07-31 00:57:47.224369 (MainThread): Opening a new connection, currently in state init
2022-07-31 00:57:47.929336 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2022-07-31 00:57:47.929803 (MainThread): On master: COMMIT
2022-07-31 00:57:47.930069 (MainThread): Using snowflake connection "master".
2022-07-31 00:57:47.930226 (MainThread): On master: COMMIT
2022-07-31 00:57:48.059203 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:57:48.059510 (MainThread): On master: Close
2022-07-31 00:57:48.186536 (MainThread): 19:57:48 | Concurrency: 8 threads (target='dev')
2022-07-31 00:57:48.186785 (MainThread): 19:57:48 | 
2022-07-31 00:57:48.188806 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 00:57:48.189056 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 00:57:48.189393 (Thread-1): 19:57:48 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 00:57:48.189660 (Thread-2): 19:57:48 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 00:57:48.190287 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:57:48.190626 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:57:48.190800 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 00:57:48.190982 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 00:57:48.193990 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 00:57:48.204357 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:57:48.204597 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-07-31 00:57:48.204769 (Thread-2): Opening a new connection, currently in state init
2022-07-31 00:57:48.205767 (Thread-1): finished collecting timing info
2022-07-31 00:57:48.234267 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 00:57:48.237225 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:57:48.237341 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 00:57:48.237415 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 00:57:48.872583 (Thread-2): Snowflake query id: 01a5f6b9-0000-af4d-0002-a3d600015292
2022-07-31 00:57:48.872847 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:57:48.873980 (Thread-2): finished collecting timing info
2022-07-31 00:57:48.874121 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 00:57:48.889345 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2022-07-31 00:57:48.889491 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:57:48.889595 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 00:57:48.937654 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:57:48.942767 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9eaf4e-05a5-4c20-966b-9e7368d4a045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf5ca1518>]}
2022-07-31 00:57:48.943069 (Thread-2): 19:57:48 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.75s]
2022-07-31 00:57:48.943184 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 00:57:49.444533 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2022-07-31 00:57:49.446839 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 00:57:49.447119 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:57:49.447282 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 00:57:49.536395 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2022-07-31 00:57:49.550403 (Thread-1): finished collecting timing info
2022-07-31 00:57:49.550617 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 00:57:49.668261 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9eaf4e-05a5-4c20-966b-9e7368d4a045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf5a92278>]}
2022-07-31 00:57:49.668761 (Thread-1): 19:57:49 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.48s]
2022-07-31 00:57:49.668958 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 00:57:49.669416 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 00:57:49.669699 (Thread-3): 19:57:49 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 00:57:49.670086 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:57:49.670253 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 00:57:49.673501 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 00:57:49.675997 (Thread-3): finished collecting timing info
2022-07-31 00:57:49.696253 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 00:57:49.699529 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:57:49.699653 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 00:57:49.699736 (Thread-3): Opening a new connection, currently in state init
2022-07-31 00:57:50.265182 (Thread-3): SQL status: SUCCESS 1 in 0.57 seconds
2022-07-31 00:57:50.265393 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:57:50.265476 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 00:57:50.482760 (Thread-3): SQL status: SUCCESS 1 in 0.22 seconds
2022-07-31 00:57:50.483715 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 00:57:50.483843 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:57:50.483910 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 00:57:50.569305 (Thread-3): SQL status: SUCCESS 1 in 0.09 seconds
2022-07-31 00:57:50.569970 (Thread-3): finished collecting timing info
2022-07-31 00:57:50.570092 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 00:57:50.688158 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9eaf4e-05a5-4c20-966b-9e7368d4a045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf59d9d30>]}
2022-07-31 00:57:50.688471 (Thread-3): 19:57:50 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.02s]
2022-07-31 00:57:50.688590 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 00:57:50.748009 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 00:57:50.748269 (MainThread): Using snowflake connection "master".
2022-07-31 00:57:50.748351 (MainThread): On master: BEGIN
2022-07-31 00:57:50.748421 (MainThread): Opening a new connection, currently in state closed
2022-07-31 00:57:51.235843 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 00:57:51.236159 (MainThread): On master: COMMIT
2022-07-31 00:57:51.236420 (MainThread): Using snowflake connection "master".
2022-07-31 00:57:51.236584 (MainThread): On master: COMMIT
2022-07-31 00:57:51.363002 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 00:57:51.363327 (MainThread): On master: Close
2022-07-31 00:57:51.493861 (MainThread): 19:57:51 | 
2022-07-31 00:57:51.494116 (MainThread): 19:57:51 | Finished running 2 table models, 1 view model in 5.95s.
2022-07-31 00:57:51.494275 (MainThread): Connection 'master' was properly closed.
2022-07-31 00:57:51.494383 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 00:57:51.494481 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:57:51.494574 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 00:57:51.505033 (MainThread): 
2022-07-31 00:57:51.505241 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 00:57:51.505388 (MainThread): 
2022-07-31 00:57:51.505517 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 00:57:51.505646 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 00:57:51.505742 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-07-31 00:57:51.505836 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-07-31 00:57:51.505944 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 00:57:51.506121 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf56ad2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf58f7748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf5c70e80>]}
2022-07-31 00:57:51.506335 (MainThread): Flushing usage events
2022-07-31 00:59:32.813546 (MainThread): Running with dbt=0.19.1
2022-07-31 00:59:33.643942 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 00:59:33.710559 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 00:59:33.714672 (MainThread): Tracking: tracking
2022-07-31 00:59:33.715354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18c112e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc190e917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc190e91be0>]}
2022-07-31 00:59:33.731740 (MainThread): Partial parsing not enabled
2022-07-31 00:59:33.733171 (MainThread): Parsing macros/catalog.sql
2022-07-31 00:59:33.735938 (MainThread): Parsing macros/adapters.sql
2022-07-31 00:59:33.767257 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 00:59:33.769671 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 00:59:33.771432 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 00:59:33.775810 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 00:59:33.789044 (MainThread): Parsing macros/core.sql
2022-07-31 00:59:33.793348 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 00:59:33.803095 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 00:59:33.805479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 00:59:33.872385 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 00:59:33.906097 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 00:59:33.928032 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 00:59:33.930783 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 00:59:33.937544 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 00:59:33.952632 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 00:59:33.961024 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 00:59:33.969194 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 00:59:33.974560 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 00:59:33.976057 (MainThread): Parsing macros/etc/query.sql
2022-07-31 00:59:33.977498 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 00:59:33.979577 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 00:59:33.989092 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 00:59:33.991705 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 00:59:33.993684 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 00:59:34.037672 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 00:59:34.040033 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 00:59:34.041849 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 00:59:34.043801 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 00:59:34.052239 (MainThread): Partial parsing not enabled
2022-07-31 00:59:34.074114 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 00:59:34.084546 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 00:59:34.088237 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 00:59:34.092249 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc190fac588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc190fe1470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc190fe14e0>]}
2022-07-31 00:59:34.092457 (MainThread): Flushing usage events
2022-07-31 00:59:34.490569 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 00:59:34.490782 (MainThread): Encountered an error:
2022-07-31 00:59:34.490959 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
  unexpected '%'
    line 32
      {% for database in results_list %}
2022-07-31 00:59:34.496848 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 32, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '%'
  line 32
    {% for database in results_list %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    native=native,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 504, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  unexpected '%'
    line 32
      {% for database in results_list %}

2022-07-31 01:03:38.673137 (MainThread): Running with dbt=0.19.1
2022-07-31 01:03:39.497168 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:03:39.561944 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:03:39.564320 (MainThread): Tracking: tracking
2022-07-31 01:03:39.564997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a20d2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6ed07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6ed0828>]}
2022-07-31 01:03:39.577688 (MainThread): Partial parsing not enabled
2022-07-31 01:03:39.579034 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:03:39.581555 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:03:39.611647 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:03:39.613830 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:03:39.615488 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:03:39.619835 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:03:39.631644 (MainThread): Parsing macros/core.sql
2022-07-31 01:03:39.635912 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:03:39.644772 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:03:39.646686 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:03:39.718081 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:03:39.751608 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:03:39.772828 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:03:39.774894 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:03:39.781128 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:03:39.794707 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:03:39.802319 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:03:39.808491 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:03:39.813412 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:03:39.814516 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:03:39.815940 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:03:39.817851 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:03:39.826381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:03:39.828592 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:03:39.830494 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:03:39.873857 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:03:39.875946 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:03:39.877632 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:03:39.879571 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:03:39.887355 (MainThread): Partial parsing not enabled
2022-07-31 01:03:39.908386 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:03:39.917959 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:03:39.921146 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:03:39.923200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a6fec588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a70209b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a70209e8>]}
2022-07-31 01:03:39.923376 (MainThread): Flushing usage events
2022-07-31 01:03:40.396772 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:03:40.397086 (MainThread): Encountered an error:
2022-07-31 01:03:40.397291 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
  unexpected '%'
    line 5
      {% for database in results_list %}
2022-07-31 01:03:40.403290 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 5, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '%'
  line 5
    {% for database in results_list %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 380, in render_update
    self.render_with_context(node, config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/base.py", line 294, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    native=native,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 504, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  unexpected '%'
    line 5
      {% for database in results_list %}

2022-07-31 01:20:14.915739 (MainThread): Running with dbt=0.19.1
2022-07-31 01:20:16.120525 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:20:16.188390 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:20:16.193086 (MainThread): Tracking: tracking
2022-07-31 01:20:16.193797 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febec212e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf0d68470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf0d68c18>]}
2022-07-31 01:20:16.207587 (MainThread): Partial parsing not enabled
2022-07-31 01:20:16.209564 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:20:16.212186 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:20:16.242932 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:20:16.245395 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:20:16.247221 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:20:16.252258 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:20:16.265767 (MainThread): Parsing macros/core.sql
2022-07-31 01:20:16.270879 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:20:16.284144 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:20:16.286460 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:20:16.361910 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:20:16.397814 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:20:16.419518 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:20:16.421798 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:20:16.428490 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:20:16.443052 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:20:16.450304 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:20:16.456767 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:20:16.461840 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:20:16.463183 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:20:16.464870 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:20:16.466953 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:20:16.475970 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:20:16.478274 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:20:16.480979 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:20:16.522722 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:20:16.525118 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:20:16.527189 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:20:16.529215 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:20:16.537548 (MainThread): Partial parsing not enabled
2022-07-31 01:20:16.560503 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:20:16.570583 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:20:16.574308 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:20:16.644984 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:20:16.645353 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd551fcad-0d45-4f97-b9e8-e982286c5420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf197fb70>]}
2022-07-31 01:20:16.650078 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd551fcad-0d45-4f97-b9e8-e982286c5420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febeeea1ac8>]}
2022-07-31 01:20:16.650343 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:20:16.650914 (MainThread): 
2022-07-31 01:20:16.651173 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:20:16.651881 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:20:16.663610 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:20:16.663730 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:20:16.663809 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:20:17.643218 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.98 seconds
2022-07-31 01:20:17.649909 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:20:17.772913 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:20:17.781320 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:20:17.781474 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:20:17.781565 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:20:18.466516 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.68 seconds
2022-07-31 01:20:18.468174 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:20:18.597578 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:18.597766 (MainThread): On master: BEGIN
2022-07-31 01:20:18.597886 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:20:19.095056 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:20:19.095505 (MainThread): On master: COMMIT
2022-07-31 01:20:19.095830 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:19.095980 (MainThread): On master: COMMIT
2022-07-31 01:20:19.237568 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 01:20:19.238018 (MainThread): On master: Close
2022-07-31 01:20:19.362772 (MainThread): 20:20:19 | Concurrency: 8 threads (target='dev')
2022-07-31 01:20:19.363019 (MainThread): 20:20:19 | 
2022-07-31 01:20:19.365140 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:20:19.365505 (Thread-1): 20:20:19 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:20:19.365892 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:20:19.366059 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:20:19.375377 (Thread-1): finished collecting timing info
2022-07-31 01:20:19.375864 (Thread-1): Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'union_all' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
2022-07-31 01:20:19.385731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd551fcad-0d45-4f97-b9e8-e982286c5420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf1ded160>]}
2022-07-31 01:20:19.386078 (Thread-1): 20:20:19 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.02s]
2022-07-31 01:20:19.386209 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:20:19.467636 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:20:19.468232 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:19.468470 (MainThread): On master: BEGIN
2022-07-31 01:20:19.468689 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:20:19.995479 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-31 01:20:19.995769 (MainThread): On master: COMMIT
2022-07-31 01:20:19.996025 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:19.996175 (MainThread): On master: COMMIT
2022-07-31 01:20:20.131192 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:20:20.131721 (MainThread): On master: Close
2022-07-31 01:20:20.256785 (MainThread): 20:20:20 | 
2022-07-31 01:20:20.257021 (MainThread): 20:20:20 | Finished running 1 table model in 3.61s.
2022-07-31 01:20:20.257172 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:20:20.257275 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:20:20.266712 (MainThread): 
2022-07-31 01:20:20.266918 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:20:20.267067 (MainThread): 
2022-07-31 01:20:20.267221 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
2022-07-31 01:20:20.267357 (MainThread):   'union_all' is undefined
2022-07-31 01:20:20.267486 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:20:20.267681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febec212e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf1ded470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf1ded3c8>]}
2022-07-31 01:20:20.267905 (MainThread): Flushing usage events
2022-07-31 01:20:43.691527 (MainThread): Running with dbt=0.19.1
2022-07-31 01:20:44.635901 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:20:44.699497 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:20:44.701298 (MainThread): Tracking: tracking
2022-07-31 01:20:44.701904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee1d3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f2ee1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f2ee1470>]}
2022-07-31 01:20:44.715736 (MainThread): Partial parsing not enabled
2022-07-31 01:20:44.717239 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:20:44.719835 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:20:44.750369 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:20:44.752628 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:20:44.754328 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:20:44.758481 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:20:44.770720 (MainThread): Parsing macros/core.sql
2022-07-31 01:20:44.774808 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:20:44.784406 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:20:44.786516 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:20:44.860992 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:20:44.895745 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:20:44.917252 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:20:44.919577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:20:44.926026 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:20:44.939809 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:20:44.947251 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:20:44.954468 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:20:44.959660 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:20:44.960932 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:20:44.962306 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:20:44.964105 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:20:44.973122 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:20:44.975498 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:20:44.977311 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:20:45.019397 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:20:45.022005 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:20:45.023970 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:20:45.025876 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:20:45.034051 (MainThread): Partial parsing not enabled
2022-07-31 01:20:45.055830 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:20:45.065020 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:20:45.068727 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:20:45.140112 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:20:45.140461 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30329a99-4447-48bb-8972-7a11f794450b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f31c0b38>]}
2022-07-31 01:20:45.146140 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30329a99-4447-48bb-8972-7a11f794450b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0ee5198>]}
2022-07-31 01:20:45.146356 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:20:45.147000 (MainThread): 
2022-07-31 01:20:45.147265 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:20:45.147972 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:20:45.159468 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:20:45.159576 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:20:45.159653 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:20:45.956326 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.80 seconds
2022-07-31 01:20:45.961453 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:20:46.076070 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:20:46.084972 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:20:46.085136 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:20:46.085239 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:20:46.781895 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.70 seconds
2022-07-31 01:20:46.783414 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:20:46.902489 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:46.902690 (MainThread): On master: BEGIN
2022-07-31 01:20:46.902817 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:20:47.416881 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:20:47.417200 (MainThread): On master: COMMIT
2022-07-31 01:20:47.417462 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:47.417613 (MainThread): On master: COMMIT
2022-07-31 01:20:47.547349 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:20:47.547671 (MainThread): On master: Close
2022-07-31 01:20:47.660085 (MainThread): 20:20:47 | Concurrency: 8 threads (target='dev')
2022-07-31 01:20:47.660363 (MainThread): 20:20:47 | 
2022-07-31 01:20:47.662373 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:20:47.662765 (Thread-1): 20:20:47 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:20:47.663187 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:20:47.663362 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:20:47.670894 (Thread-1): finished collecting timing info
2022-07-31 01:20:47.671287 (Thread-1): Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'union_all' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
2022-07-31 01:20:47.675382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30329a99-4447-48bb-8972-7a11f794450b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f2fed550>]}
2022-07-31 01:20:47.675722 (Thread-1): 20:20:47 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.01s]
2022-07-31 01:20:47.675867 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:20:47.763446 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:20:47.763769 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:47.763899 (MainThread): On master: BEGIN
2022-07-31 01:20:47.764014 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:20:48.298588 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-31 01:20:48.298918 (MainThread): On master: COMMIT
2022-07-31 01:20:48.299188 (MainThread): Using snowflake connection "master".
2022-07-31 01:20:48.299346 (MainThread): On master: COMMIT
2022-07-31 01:20:48.422291 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:20:48.422607 (MainThread): On master: Close
2022-07-31 01:20:48.556373 (MainThread): 20:20:48 | 
2022-07-31 01:20:48.556622 (MainThread): 20:20:48 | Finished running 1 table model in 3.41s.
2022-07-31 01:20:48.556776 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:20:48.556884 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:20:48.567292 (MainThread): 
2022-07-31 01:20:48.567477 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:20:48.567662 (MainThread): 
2022-07-31 01:20:48.567848 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
2022-07-31 01:20:48.567974 (MainThread):   'union_all' is undefined
2022-07-31 01:20:48.568138 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:20:48.568368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0ee5198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f34b89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f35469b0>]}
2022-07-31 01:20:48.568606 (MainThread): Flushing usage events
2022-07-31 01:22:48.416790 (MainThread): Running with dbt=0.19.1
2022-07-31 01:22:49.478664 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:22:49.546940 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:22:49.557291 (MainThread): Tracking: tracking
2022-07-31 01:22:49.557876 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84fefe4e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85045897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504589be0>]}
2022-07-31 01:22:49.571124 (MainThread): Partial parsing not enabled
2022-07-31 01:22:49.572630 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:22:49.575232 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:22:49.607874 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:22:49.610386 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:22:49.612120 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:22:49.616565 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:22:49.628790 (MainThread): Parsing macros/core.sql
2022-07-31 01:22:49.633578 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:22:49.644209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:22:49.646598 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:22:49.724632 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:22:49.760323 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:22:49.782573 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:22:49.784875 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:22:49.791382 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:22:49.805435 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:22:49.812643 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:22:49.819548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:22:49.825005 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:22:49.826391 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:22:49.827849 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:22:49.830078 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:22:49.839326 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:22:49.842030 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:22:49.844033 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:22:49.889982 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:22:49.892431 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:22:49.894578 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:22:49.896782 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:22:49.904977 (MainThread): Partial parsing not enabled
2022-07-31 01:22:49.927447 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:22:49.937810 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:22:49.941565 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:22:50.008164 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:22:50.008536 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22c6e626-3395-4f38-88b5-656dbb682515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504868b70>]}
2022-07-31 01:22:50.012675 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22c6e626-3395-4f38-88b5-656dbb682515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504501908>]}
2022-07-31 01:22:50.012876 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:22:50.013667 (MainThread): 
2022-07-31 01:22:50.014230 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:22:50.014989 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:22:50.026371 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:22:50.026480 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:22:50.026557 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:22:51.034397 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.01 seconds
2022-07-31 01:22:51.040065 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:22:51.153793 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:22:51.162432 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:22:51.162587 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:22:51.162691 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:22:51.948466 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.79 seconds
2022-07-31 01:22:51.950225 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:22:52.074553 (MainThread): Using snowflake connection "master".
2022-07-31 01:22:52.074741 (MainThread): On master: BEGIN
2022-07-31 01:22:52.074867 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:22:52.575720 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:22:52.576192 (MainThread): On master: COMMIT
2022-07-31 01:22:52.576516 (MainThread): Using snowflake connection "master".
2022-07-31 01:22:52.576673 (MainThread): On master: COMMIT
2022-07-31 01:22:52.713287 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 01:22:52.713816 (MainThread): On master: Close
2022-07-31 01:22:52.854419 (MainThread): 20:22:52 | Concurrency: 8 threads (target='dev')
2022-07-31 01:22:52.854668 (MainThread): 20:22:52 | 
2022-07-31 01:22:52.856795 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:22:52.857137 (Thread-1): 20:22:52 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:22:52.857483 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:22:52.857630 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:22:52.866556 (Thread-1): finished collecting timing info
2022-07-31 01:22:52.867015 (Thread-1): Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'union_all' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  'union_all' is undefined
2022-07-31 01:22:52.877086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22c6e626-3395-4f38-88b5-656dbb682515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504cb8630>]}
2022-07-31 01:22:52.877455 (Thread-1): 20:22:52 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.02s]
2022-07-31 01:22:52.877605 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:22:52.962151 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:22:52.962764 (MainThread): Using snowflake connection "master".
2022-07-31 01:22:52.963014 (MainThread): On master: BEGIN
2022-07-31 01:22:52.963248 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:22:53.476694 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:22:53.477159 (MainThread): On master: COMMIT
2022-07-31 01:22:53.477581 (MainThread): Using snowflake connection "master".
2022-07-31 01:22:53.477742 (MainThread): On master: COMMIT
2022-07-31 01:22:53.604629 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:22:53.604947 (MainThread): On master: Close
2022-07-31 01:22:53.733635 (MainThread): 20:22:53 | 
2022-07-31 01:22:53.733929 (MainThread): 20:22:53 | Finished running 1 table model in 3.72s.
2022-07-31 01:22:53.734082 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:22:53.734202 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:22:53.743202 (MainThread): 
2022-07-31 01:22:53.743397 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:22:53.743523 (MainThread): 
2022-07-31 01:22:53.743642 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
2022-07-31 01:22:53.743747 (MainThread):   'union_all' is undefined
2022-07-31 01:22:53.743852 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:22:53.744037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504b39ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85047994e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8504bca048>]}
2022-07-31 01:22:53.744255 (MainThread): Flushing usage events
2022-07-31 01:23:11.135317 (MainThread): Running with dbt=0.19.1
2022-07-31 01:23:11.964249 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:23:12.030604 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:23:12.032803 (MainThread): Tracking: tracking
2022-07-31 01:23:12.033539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac060d3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b4927f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b492be0>]}
2022-07-31 01:23:12.047764 (MainThread): Partial parsing not enabled
2022-07-31 01:23:12.049181 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:23:12.052001 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:23:12.081858 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:23:12.084094 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:23:12.085838 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:23:12.090014 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:23:12.102641 (MainThread): Parsing macros/core.sql
2022-07-31 01:23:12.106586 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:23:12.116239 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:23:12.118385 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:23:12.192595 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:23:12.226975 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:23:12.248342 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:23:12.250433 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:23:12.257030 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:23:12.270660 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:23:12.277465 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:23:12.284362 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:23:12.289227 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:23:12.290343 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:23:12.291546 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:23:12.293579 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:23:12.302311 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:23:12.304487 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:23:12.306310 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:23:12.349886 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:23:12.351967 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:23:12.353663 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:23:12.355539 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:23:12.363581 (MainThread): Partial parsing not enabled
2022-07-31 01:23:12.385356 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:23:12.394256 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:23:12.397787 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:23:12.465238 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:23:12.465586 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28a23af4-2678-4ae7-9d43-e9c6acd01039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0baaddd8>]}
2022-07-31 01:23:12.471438 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28a23af4-2678-4ae7-9d43-e9c6acd01039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ba901d0>]}
2022-07-31 01:23:12.471700 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:23:12.472264 (MainThread): 
2022-07-31 01:23:12.472522 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:23:12.473235 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:23:12.485437 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:23:12.485556 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:23:12.485631 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:23:13.347211 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2022-07-31 01:23:13.353013 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:23:13.466963 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:23:13.475554 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:23:13.475718 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:23:13.475814 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:23:15.117621 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.64 seconds
2022-07-31 01:23:15.118915 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:23:15.238867 (MainThread): Using snowflake connection "master".
2022-07-31 01:23:15.239063 (MainThread): On master: BEGIN
2022-07-31 01:23:15.239189 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:23:15.807301 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2022-07-31 01:23:15.807616 (MainThread): On master: COMMIT
2022-07-31 01:23:15.807879 (MainThread): Using snowflake connection "master".
2022-07-31 01:23:15.808035 (MainThread): On master: COMMIT
2022-07-31 01:23:15.933136 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:23:15.933454 (MainThread): On master: Close
2022-07-31 01:23:16.051270 (MainThread): 20:23:16 | Concurrency: 8 threads (target='dev')
2022-07-31 01:23:16.051480 (MainThread): 20:23:16 | 
2022-07-31 01:23:16.052932 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:23:16.053218 (Thread-1): 20:23:16 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:23:16.053512 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:23:16.053635 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:23:16.058899 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:23:16.059264 (Thread-1): finished collecting timing info
2022-07-31 01:23:16.086439 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:23:16.087088 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:23:16.087176 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:23:16.087246 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:23:16.574652 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 01:23:16.574805 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:23:16.574876 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


WITH

      );
2022-07-31 01:23:16.655720 (Thread-1): Snowflake query id: 01a5f6d3-0000-af4d-0002-a3d6000152ce
2022-07-31 01:23:16.655844 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 6 unexpected ')'.
2022-07-31 01:23:16.655974 (Thread-1): finished collecting timing info
2022-07-31 01:23:16.656099 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:23:16.772718 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:23:16.886361 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 6 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 6 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:23:16.898297 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a23af4-2678-4ae7-9d43-e9c6acd01039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0be05be0>]}
2022-07-31 01:23:16.898704 (Thread-1): 20:23:16 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.84s]
2022-07-31 01:23:16.898868 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:23:16.986524 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:23:16.987144 (MainThread): Using snowflake connection "master".
2022-07-31 01:23:16.987400 (MainThread): On master: BEGIN
2022-07-31 01:23:16.987638 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:23:17.489025 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:23:17.489351 (MainThread): On master: COMMIT
2022-07-31 01:23:17.489614 (MainThread): Using snowflake connection "master".
2022-07-31 01:23:17.489773 (MainThread): On master: COMMIT
2022-07-31 01:23:17.630915 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 01:23:17.631238 (MainThread): On master: Close
2022-07-31 01:23:17.760837 (MainThread): 20:23:17 | 
2022-07-31 01:23:17.761088 (MainThread): 20:23:17 | Finished running 1 table model in 5.29s.
2022-07-31 01:23:17.761245 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:23:17.761360 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:23:17.771924 (MainThread): 
2022-07-31 01:23:17.772118 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:23:17.772242 (MainThread): 
2022-07-31 01:23:17.772360 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:23:17.772466 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 01:23:17.772565 (MainThread):   syntax error line 7 at position 6 unexpected ')'.
2022-07-31 01:23:17.772817 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:23:17.772955 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:23:17.773153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0b905358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0bcb5dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0be05be0>]}
2022-07-31 01:23:17.773370 (MainThread): Flushing usage events
2022-07-31 01:25:53.845912 (MainThread): Running with dbt=0.19.1
2022-07-31 01:25:54.734111 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:25:54.797175 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:25:54.800636 (MainThread): Tracking: tracking
2022-07-31 01:25:54.801618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1a8ace48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f577828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f577b70>]}
2022-07-31 01:25:54.814782 (MainThread): Partial parsing not enabled
2022-07-31 01:25:54.816187 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:25:54.818731 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:25:54.849993 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:25:54.852415 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:25:54.854136 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:25:54.858358 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:25:54.870901 (MainThread): Parsing macros/core.sql
2022-07-31 01:25:54.875584 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:25:54.884677 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:25:54.886575 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:25:54.961632 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:25:54.996294 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:25:55.018248 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:25:55.020493 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:25:55.026946 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:25:55.042780 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:25:55.051208 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:25:55.058330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:25:55.064093 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:25:55.065568 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:25:55.066901 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:25:55.068872 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:25:55.078172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:25:55.080435 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:25:55.082288 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:25:55.124341 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:25:55.126414 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:25:55.128292 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:25:55.130180 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:25:55.138359 (MainThread): Partial parsing not enabled
2022-07-31 01:25:55.159576 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:25:55.168605 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:25:55.171736 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:25:55.236641 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:25:55.236984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f4974f5-72de-4cac-9d90-68ac21c91b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f7e0ac8>]}
2022-07-31 01:25:55.241435 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f4974f5-72de-4cac-9d90-68ac21c91b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1d7e1cf8>]}
2022-07-31 01:25:55.241651 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:25:55.242190 (MainThread): 
2022-07-31 01:25:55.242467 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:25:55.243236 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:25:55.255427 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:25:55.255552 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:25:55.255668 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:25:56.179148 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.92 seconds
2022-07-31 01:25:56.184789 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:25:56.325458 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:25:56.333943 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:25:56.334086 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:25:56.334186 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:25:56.896396 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.56 seconds
2022-07-31 01:25:56.898158 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:25:57.020244 (MainThread): Using snowflake connection "master".
2022-07-31 01:25:57.020439 (MainThread): On master: BEGIN
2022-07-31 01:25:57.020566 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:25:57.745970 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2022-07-31 01:25:57.746293 (MainThread): On master: COMMIT
2022-07-31 01:25:57.746558 (MainThread): Using snowflake connection "master".
2022-07-31 01:25:57.746714 (MainThread): On master: COMMIT
2022-07-31 01:25:57.868936 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:25:57.869246 (MainThread): On master: Close
2022-07-31 01:25:57.991241 (MainThread): 20:25:57 | Concurrency: 8 threads (target='dev')
2022-07-31 01:25:57.991491 (MainThread): 20:25:57 | 
2022-07-31 01:25:57.993375 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:25:57.993742 (Thread-1): 20:25:57 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:25:57.994135 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:25:57.994304 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:25:58.000260 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:25:58.001122 (Thread-1): finished collecting timing info
2022-07-31 01:25:58.031734 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:25:58.034347 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:25:58.034454 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:25:58.034528 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:25:58.528379 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 01:25:58.528531 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:25:58.528607 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


WITH

      );
2022-07-31 01:25:58.611981 (Thread-1): Snowflake query id: 01a5f6d5-0000-af4d-0002-a3d6000152e2
2022-07-31 01:25:58.612107 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 6 unexpected ')'.
2022-07-31 01:25:58.612239 (Thread-1): finished collecting timing info
2022-07-31 01:25:58.612389 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:25:58.776182 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:25:58.887976 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 6 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 7 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 6 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:25:58.892213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f4974f5-72de-4cac-9d90-68ac21c91b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1fdf3f60>]}
2022-07-31 01:25:58.892514 (Thread-1): 20:25:58 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.90s]
2022-07-31 01:25:58.892626 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:25:58.914731 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:25:58.915012 (MainThread): Using snowflake connection "master".
2022-07-31 01:25:58.915124 (MainThread): On master: BEGIN
2022-07-31 01:25:58.915187 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:25:59.391670 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2022-07-31 01:25:59.391866 (MainThread): On master: COMMIT
2022-07-31 01:25:59.392019 (MainThread): Using snowflake connection "master".
2022-07-31 01:25:59.392082 (MainThread): On master: COMMIT
2022-07-31 01:25:59.516625 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:25:59.516795 (MainThread): On master: Close
2022-07-31 01:25:59.633998 (MainThread): 20:25:59 | 
2022-07-31 01:25:59.634197 (MainThread): 20:25:59 | Finished running 1 table model in 4.39s.
2022-07-31 01:25:59.634307 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:25:59.634384 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:25:59.642233 (MainThread): 
2022-07-31 01:25:59.642397 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:25:59.642501 (MainThread): 
2022-07-31 01:25:59.642598 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:25:59.642685 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 01:25:59.642770 (MainThread):   syntax error line 7 at position 6 unexpected ')'.
2022-07-31 01:25:59.642951 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:25:59.643078 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:25:59.643249 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1b831278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1fc91860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1fc91cf8>]}
2022-07-31 01:25:59.643439 (MainThread): Flushing usage events
2022-07-31 01:28:50.724745 (MainThread): Running with dbt=0.19.1
2022-07-31 01:28:51.560774 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:28:51.624370 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:28:51.626911 (MainThread): Tracking: tracking
2022-07-31 01:28:51.627575 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e500d2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e54d92b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e54d92470>]}
2022-07-31 01:28:51.641018 (MainThread): Partial parsing not enabled
2022-07-31 01:28:51.642460 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:28:51.645036 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:28:51.674974 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:28:51.677136 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:28:51.678749 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:28:51.682960 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:28:51.695135 (MainThread): Parsing macros/core.sql
2022-07-31 01:28:51.699317 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:28:51.708767 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:28:51.710746 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:28:51.786408 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:28:51.822227 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:28:51.844440 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:28:51.846603 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:28:51.853529 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:28:51.868053 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:28:51.875801 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:28:51.882441 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:28:51.888062 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:28:51.889327 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:28:51.890578 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:28:51.892373 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:28:51.901365 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:28:51.903986 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:28:51.906002 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:28:51.950883 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:28:51.953061 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:28:51.954895 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:28:51.956798 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:28:51.964860 (MainThread): Partial parsing not enabled
2022-07-31 01:28:51.987298 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:28:51.996843 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:28:52.000221 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:28:52.071897 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:28:52.072311 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735e049e-a616-4c00-afa5-ef479f73585e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e551c0b38>]}
2022-07-31 01:28:52.078039 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735e049e-a616-4c00-afa5-ef479f73585e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e52e94860>]}
2022-07-31 01:28:52.078274 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:28:52.078920 (MainThread): 
2022-07-31 01:28:52.079197 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:28:52.079951 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:28:52.091632 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:28:52.091756 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:28:52.091831 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:28:52.980075 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.89 seconds
2022-07-31 01:28:52.985890 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:28:53.112914 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:28:53.121248 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:28:53.121407 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:28:53.121511 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:28:53.631521 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.51 seconds
2022-07-31 01:28:53.633280 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:28:53.759283 (MainThread): Using snowflake connection "master".
2022-07-31 01:28:53.759478 (MainThread): On master: BEGIN
2022-07-31 01:28:53.759609 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:28:54.249346 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 01:28:54.249797 (MainThread): On master: COMMIT
2022-07-31 01:28:54.250166 (MainThread): Using snowflake connection "master".
2022-07-31 01:28:54.250323 (MainThread): On master: COMMIT
2022-07-31 01:28:54.393904 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 01:28:54.394373 (MainThread): On master: Close
2022-07-31 01:28:54.517069 (MainThread): 20:28:54 | Concurrency: 8 threads (target='dev')
2022-07-31 01:28:54.517328 (MainThread): 20:28:54 | 
2022-07-31 01:28:54.519237 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:28:54.519623 (Thread-1): 20:28:54 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:28:54.520029 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:28:54.520200 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:28:54.528120 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:28:54.530089 (Thread-1): finished collecting timing info
2022-07-31 01:28:54.562553 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:28:54.563569 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:28:54.563663 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:28:54.563735 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:28:55.202582 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2022-07-31 01:28:55.202738 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:28:55.202810 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
)
select *
from source_data
      );
2022-07-31 01:28:55.278291 (Thread-1): Snowflake query id: 01a5f6d8-0000-af49-0002-a3d60001437a
2022-07-31 01:28:55.278422 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 0 unexpected ')'.
2022-07-31 01:28:55.278552 (Thread-1): finished collecting timing info
2022-07-31 01:28:55.278671 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:28:55.394631 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:28:55.508235 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 11 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:28:55.512964 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735e049e-a616-4c00-afa5-ef479f73585e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55440ef0>]}
2022-07-31 01:28:55.513256 (Thread-1): 20:28:55 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.99s]
2022-07-31 01:28:55.513374 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:28:55.547582 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:28:55.547790 (MainThread): Using snowflake connection "master".
2022-07-31 01:28:55.547865 (MainThread): On master: BEGIN
2022-07-31 01:28:55.547934 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:28:56.018331 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2022-07-31 01:28:56.018509 (MainThread): On master: COMMIT
2022-07-31 01:28:56.018635 (MainThread): Using snowflake connection "master".
2022-07-31 01:28:56.018702 (MainThread): On master: COMMIT
2022-07-31 01:28:56.146499 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:28:56.146824 (MainThread): On master: Close
2022-07-31 01:28:56.260119 (MainThread): 20:28:56 | 
2022-07-31 01:28:56.260362 (MainThread): 20:28:56 | Finished running 1 table model in 4.18s.
2022-07-31 01:28:56.260517 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:28:56.260627 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:28:56.271264 (MainThread): 
2022-07-31 01:28:56.271455 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:28:56.271585 (MainThread): 
2022-07-31 01:28:56.271703 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:28:56.271808 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 01:28:56.271903 (MainThread):   syntax error line 11 at position 0 unexpected ')'.
2022-07-31 01:28:56.271997 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:28:56.272095 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:28:56.272269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e52e94860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55494e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e55440438>]}
2022-07-31 01:28:56.272483 (MainThread): Flushing usage events
2022-07-31 01:29:46.200725 (MainThread): Running with dbt=0.19.1
2022-07-31 01:29:47.066469 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:29:47.136952 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:29:47.140185 (MainThread): Tracking: tracking
2022-07-31 01:29:47.140869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4958c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4958cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4958c828>]}
2022-07-31 01:29:47.153959 (MainThread): Partial parsing not enabled
2022-07-31 01:29:47.155689 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:29:47.158273 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:29:47.192508 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:29:47.195022 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:29:47.196848 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:29:47.201379 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:29:47.214250 (MainThread): Parsing macros/core.sql
2022-07-31 01:29:47.219285 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:29:47.230330 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:29:47.233173 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:29:47.308421 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:29:47.344795 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:29:47.369495 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:29:47.371913 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:29:47.379422 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:29:47.395595 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:29:47.403872 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:29:47.411374 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:29:47.417532 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:29:47.419045 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:29:47.420407 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:29:47.422357 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:29:47.433098 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:29:47.435921 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:29:47.437881 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:29:47.488008 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:29:47.490502 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:29:47.493387 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:29:47.496478 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:29:47.507649 (MainThread): Partial parsing not enabled
2022-07-31 01:29:47.532175 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:29:47.543991 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:29:47.547635 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:29:47.621959 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd497b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd496c7198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd46efdb00>]}
2022-07-31 01:29:47.622189 (MainThread): Flushing usage events
2022-07-31 01:29:48.043063 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:29:48.043274 (MainThread): Encountered an error:
2022-07-31 01:29:48.043562 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
  Model 'model.fivetran_poc.candidates' (models/example/candidates.sql) depends on a node named 'table_name' which was not found
2022-07-31 01:29:48.070702 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/parser/manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  Model 'model.fivetran_poc.candidates' (models/example/candidates.sql) depends on a node named 'table_name' which was not found

2022-07-31 01:30:21.901149 (MainThread): Running with dbt=0.19.1
2022-07-31 01:30:22.814439 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:30:22.880940 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:30:22.883172 (MainThread): Tracking: tracking
2022-07-31 01:30:22.883905 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af66a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96aa8d3dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af680ba8>]}
2022-07-31 01:30:22.897078 (MainThread): Partial parsing not enabled
2022-07-31 01:30:22.898615 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:30:22.901253 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:30:22.931148 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:30:22.933411 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:30:22.935089 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:30:22.939462 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:30:22.951876 (MainThread): Parsing macros/core.sql
2022-07-31 01:30:22.956191 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:30:22.965297 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:30:22.967255 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:30:23.043510 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:30:23.078824 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:30:23.099913 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:30:23.102026 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:30:23.108940 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:30:23.122683 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:30:23.129760 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:30:23.135988 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:30:23.141772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:30:23.143082 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:30:23.144555 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:30:23.146359 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:30:23.155116 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:30:23.157433 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:30:23.159459 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:30:23.203125 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:30:23.205223 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:30:23.206878 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:30:23.209141 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:30:23.217099 (MainThread): Partial parsing not enabled
2022-07-31 01:30:23.237742 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:30:23.247464 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:30:23.250714 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:30:23.320144 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:30:23.320486 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '520865b7-b2ad-4931-8617-007fa655d865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af981b70>]}
2022-07-31 01:30:23.325069 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '520865b7-b2ad-4931-8617-007fa655d865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af610400>]}
2022-07-31 01:30:23.325314 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:30:23.325883 (MainThread): 
2022-07-31 01:30:23.326257 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:30:23.327010 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:30:23.338472 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:30:23.338582 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:30:23.338662 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:30:24.245449 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.91 seconds
2022-07-31 01:30:24.250546 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:30:24.368888 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:30:24.377687 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:30:24.377853 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:30:24.377958 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:30:24.871033 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.49 seconds
2022-07-31 01:30:24.872743 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:30:24.997786 (MainThread): Using snowflake connection "master".
2022-07-31 01:30:24.997973 (MainThread): On master: BEGIN
2022-07-31 01:30:24.998109 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:30:25.511343 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:30:25.511651 (MainThread): On master: COMMIT
2022-07-31 01:30:25.511916 (MainThread): Using snowflake connection "master".
2022-07-31 01:30:25.512071 (MainThread): On master: COMMIT
2022-07-31 01:30:25.642985 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:30:25.643284 (MainThread): On master: Close
2022-07-31 01:30:25.769103 (MainThread): 20:30:25 | Concurrency: 8 threads (target='dev')
2022-07-31 01:30:25.769354 (MainThread): 20:30:25 | 
2022-07-31 01:30:25.771383 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:30:25.771763 (Thread-1): 20:30:25 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:30:25.772160 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:30:25.772349 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:30:25.779368 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:30:25.780159 (Thread-1): finished collecting timing info
2022-07-31 01:30:25.806684 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:30:25.809611 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:30:25.809752 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:30:25.809872 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:30:26.444261 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2022-07-31 01:30:26.444411 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:30:26.444478 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
    select *
    from poc_client_1_public.
    union
    
    select *
    from poc_client_2_public.
    
    
)
select *
from source_data
      );
2022-07-31 01:30:26.525155 (Thread-1): Snowflake query id: 01a5f6da-0000-af49-0002-a3d600014386
2022-07-31 01:30:26.525280 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 4 unexpected 'union'.
syntax error line 19 at position 0 unexpected ')'.
2022-07-31 01:30:26.525409 (Thread-1): finished collecting timing info
2022-07-31 01:30:26.525527 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:30:26.677765 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:30:26.797496 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 4 unexpected 'union'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 4 unexpected 'union'.
syntax error line 19 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 4 unexpected 'union'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:30:26.804095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '520865b7-b2ad-4931-8617-007fa655d865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af990f98>]}
2022-07-31 01:30:26.804477 (Thread-1): 20:30:26 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.03s]
2022-07-31 01:30:26.804625 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:30:26.900938 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:30:26.901552 (MainThread): Using snowflake connection "master".
2022-07-31 01:30:26.901811 (MainThread): On master: BEGIN
2022-07-31 01:30:26.902046 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:30:27.420517 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 01:30:27.420971 (MainThread): On master: COMMIT
2022-07-31 01:30:27.421355 (MainThread): Using snowflake connection "master".
2022-07-31 01:30:27.421511 (MainThread): On master: COMMIT
2022-07-31 01:30:27.556626 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:30:27.556868 (MainThread): On master: Close
2022-07-31 01:30:27.675866 (MainThread): 20:30:27 | 
2022-07-31 01:30:27.676117 (MainThread): 20:30:27 | Finished running 1 table model in 4.35s.
2022-07-31 01:30:27.676393 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:30:27.676536 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:30:27.685339 (MainThread): 
2022-07-31 01:30:27.685523 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:30:27.685655 (MainThread): 
2022-07-31 01:30:27.685776 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:30:27.685882 (MainThread):   001003 (42000): SQL compilation error:
2022-07-31 01:30:27.685981 (MainThread):   syntax error line 13 at position 4 unexpected 'union'.
2022-07-31 01:30:27.686078 (MainThread):   syntax error line 19 at position 0 unexpected ')'.
2022-07-31 01:30:27.686169 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:30:27.686269 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:30:27.686448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96afdf3898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96afc7b630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96af8ae4e0>]}
2022-07-31 01:30:27.686663 (MainThread): Flushing usage events
2022-07-31 01:31:01.278307 (MainThread): Running with dbt=0.19.1
2022-07-31 01:31:02.188150 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:31:02.252371 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:31:02.256026 (MainThread): Tracking: tracking
2022-07-31 01:31:02.256912 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91298bbe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912e5947f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912e594828>]}
2022-07-31 01:31:02.270257 (MainThread): Partial parsing not enabled
2022-07-31 01:31:02.272210 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:31:02.274966 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:31:02.306557 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:31:02.308961 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:31:02.310717 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:31:02.315090 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:31:02.328653 (MainThread): Parsing macros/core.sql
2022-07-31 01:31:02.332958 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:31:02.342775 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:31:02.344863 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:31:02.419809 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:31:02.455621 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:31:02.477720 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:31:02.479959 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:31:02.486290 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:31:02.500194 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:31:02.507695 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:31:02.514148 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:31:02.519336 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:31:02.520522 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:31:02.521805 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:31:02.523600 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:31:02.532325 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:31:02.534546 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:31:02.536836 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:31:02.579353 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:31:02.581467 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:31:02.583128 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:31:02.585038 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:31:02.593319 (MainThread): Partial parsing not enabled
2022-07-31 01:31:02.614689 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:31:02.624231 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:31:02.627612 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:31:02.694538 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:31:02.694885 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a2cf40-7123-46fe-8d08-e55d14c5c062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912e9b7c18>]}
2022-07-31 01:31:02.701072 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a2cf40-7123-46fe-8d08-e55d14c5c062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9125e2a5f8>]}
2022-07-31 01:31:02.701283 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:31:02.701822 (MainThread): 
2022-07-31 01:31:02.702067 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:31:02.702946 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:31:02.714488 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:31:02.714602 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:31:02.714676 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:31:03.548385 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.83 seconds
2022-07-31 01:31:03.551653 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:31:03.666381 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:31:03.675032 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:31:03.675201 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:31:03.675308 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:31:04.319258 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.64 seconds
2022-07-31 01:31:04.320780 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:31:04.433778 (MainThread): Using snowflake connection "master".
2022-07-31 01:31:04.433974 (MainThread): On master: BEGIN
2022-07-31 01:31:04.434098 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:31:04.950142 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 01:31:04.950386 (MainThread): On master: COMMIT
2022-07-31 01:31:04.950593 (MainThread): Using snowflake connection "master".
2022-07-31 01:31:04.950711 (MainThread): On master: COMMIT
2022-07-31 01:31:05.078106 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:31:05.078566 (MainThread): On master: Close
2022-07-31 01:31:05.198008 (MainThread): 20:31:05 | Concurrency: 8 threads (target='dev')
2022-07-31 01:31:05.198295 (MainThread): 20:31:05 | 
2022-07-31 01:31:05.200108 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:31:05.200474 (Thread-1): 20:31:05 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:31:05.200863 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:31:05.201039 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:31:05.208421 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:31:05.209707 (Thread-1): finished collecting timing info
2022-07-31 01:31:05.239037 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:31:05.240179 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:31:05.240266 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:31:05.240336 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:31:05.727594 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 01:31:05.727746 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:31:05.727820 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
    select *
    from poc_client_1_public.candidates
    union
    
    select *
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:31:05.818078 (Thread-1): Snowflake query id: 01a5f6db-0000-af49-0002-a3d60001439e
2022-07-31 01:31:05.818233 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:31:05.818379 (Thread-1): finished collecting timing info
2022-07-31 01:31:05.818496 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:31:05.937840 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:31:06.054555 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:31:06.060382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a2cf40-7123-46fe-8d08-e55d14c5c062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912eb86978>]}
2022-07-31 01:31:06.060739 (Thread-1): 20:31:06 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.86s]
2022-07-31 01:31:06.060872 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:31:06.124127 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:31:06.124362 (MainThread): Using snowflake connection "master".
2022-07-31 01:31:06.124434 (MainThread): On master: BEGIN
2022-07-31 01:31:06.124498 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:31:06.644263 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 01:31:06.644450 (MainThread): On master: COMMIT
2022-07-31 01:31:06.644577 (MainThread): Using snowflake connection "master".
2022-07-31 01:31:06.644643 (MainThread): On master: COMMIT
2022-07-31 01:31:06.780300 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 01:31:06.780487 (MainThread): On master: Close
2022-07-31 01:31:06.902007 (MainThread): 20:31:06 | 
2022-07-31 01:31:06.902251 (MainThread): 20:31:06 | Finished running 1 table model in 4.20s.
2022-07-31 01:31:06.902430 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:31:06.902706 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:31:06.914903 (MainThread): 
2022-07-31 01:31:06.915120 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:31:06.915280 (MainThread): 
2022-07-31 01:31:06.915443 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:31:06.915590 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:31:06.915702 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:31:06.915799 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:31:06.915905 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:31:06.916096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912e8df9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912eae0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912ec51ba8>]}
2022-07-31 01:31:06.916327 (MainThread): Flushing usage events
2022-07-31 01:33:32.532120 (MainThread): Running with dbt=0.19.1
2022-07-31 01:33:33.362867 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:33:33.426436 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:33:33.429299 (MainThread): Tracking: tracking
2022-07-31 01:33:33.430200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae555692b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae508d3dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae55590be0>]}
2022-07-31 01:33:33.444364 (MainThread): Partial parsing not enabled
2022-07-31 01:33:33.445924 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:33:33.448471 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:33:33.478197 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:33:33.480413 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:33:33.482081 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:33:33.486213 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:33:33.498369 (MainThread): Parsing macros/core.sql
2022-07-31 01:33:33.502959 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:33:33.512154 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:33:33.514091 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:33:33.587845 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:33:33.622446 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:33:33.643502 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:33:33.645561 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:33:33.651991 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:33:33.670616 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:33:33.679287 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:33:33.687026 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:33:33.693234 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:33:33.694501 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:33:33.695745 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:33:33.697548 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:33:33.708851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:33:33.711094 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:33:33.713098 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:33:33.755374 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:33:33.757445 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:33:33.759316 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:33:33.761321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:33:33.769684 (MainThread): Partial parsing not enabled
2022-07-31 01:33:33.791871 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:33:33.801112 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:33:33.804995 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:33:33.874048 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:33:33.874393 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c79c0c6b-8edd-4514-9180-473433f9b7db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae55981b38>]}
2022-07-31 01:33:33.879701 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c79c0c6b-8edd-4514-9180-473433f9b7db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae537e1668>]}
2022-07-31 01:33:33.879916 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:33:33.880452 (MainThread): 
2022-07-31 01:33:33.880708 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:33:33.881420 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:33:33.894051 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:33:33.894173 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:33:33.894252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:33:34.736816 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.84 seconds
2022-07-31 01:33:34.742349 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:33:34.870555 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:33:34.879024 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:33:34.879207 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:33:34.879297 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:33:35.536929 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.66 seconds
2022-07-31 01:33:35.538428 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:33:35.658026 (MainThread): Using snowflake connection "master".
2022-07-31 01:33:35.658228 (MainThread): On master: BEGIN
2022-07-31 01:33:35.658355 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:33:36.168420 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:33:36.168946 (MainThread): On master: COMMIT
2022-07-31 01:33:36.169241 (MainThread): Using snowflake connection "master".
2022-07-31 01:33:36.169399 (MainThread): On master: COMMIT
2022-07-31 01:33:36.296727 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:33:36.297073 (MainThread): On master: Close
2022-07-31 01:33:36.416780 (MainThread): 20:33:36 | Concurrency: 8 threads (target='dev')
2022-07-31 01:33:36.417153 (MainThread): 20:33:36 | 
2022-07-31 01:33:36.419206 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:33:36.419537 (Thread-1): 20:33:36 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:33:36.419922 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:33:36.420071 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:33:36.427073 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:33:36.427862 (Thread-1): finished collecting timing info
2022-07-31 01:33:36.455449 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:33:36.458300 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:33:36.458413 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:33:36.458484 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:33:36.952343 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 01:33:36.952496 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:33:36.952569 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
    select * , poc_client_1_public as client_name
    from poc_client_1_public.candidates
    union
    
    select * , poc_client_2_public as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:33:37.036959 (Thread-1): Snowflake query id: 01a5f6dd-0000-af4d-0002-a3d60001533a
2022-07-31 01:33:37.037091 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:33:37.037216 (Thread-1): finished collecting timing info
2022-07-31 01:33:37.037365 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:33:37.150937 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:33:37.271578 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:33:37.277162 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c79c0c6b-8edd-4514-9180-473433f9b7db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae55dfc518>]}
2022-07-31 01:33:37.277462 (Thread-1): 20:33:37 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.86s]
2022-07-31 01:33:37.277579 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:33:37.341349 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:33:37.341813 (MainThread): Using snowflake connection "master".
2022-07-31 01:33:37.341991 (MainThread): On master: BEGIN
2022-07-31 01:33:37.342117 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:33:37.855562 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:33:37.855779 (MainThread): On master: COMMIT
2022-07-31 01:33:37.855948 (MainThread): Using snowflake connection "master".
2022-07-31 01:33:37.856042 (MainThread): On master: COMMIT
2022-07-31 01:33:38.001350 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-07-31 01:33:38.001995 (MainThread): On master: Close
2022-07-31 01:33:38.115022 (MainThread): 20:33:38 | 
2022-07-31 01:33:38.115328 (MainThread): 20:33:38 | Finished running 1 table model in 4.23s.
2022-07-31 01:33:38.115540 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:33:38.115751 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:33:38.124817 (MainThread): 
2022-07-31 01:33:38.125008 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:33:38.125146 (MainThread): 
2022-07-31 01:33:38.125271 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:33:38.125378 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:33:38.125476 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:33:38.125574 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:33:38.125674 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:33:38.125853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae537e1668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae55981780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae55d4e278>]}
2022-07-31 01:33:38.126066 (MainThread): Flushing usage events
2022-07-31 01:34:13.613992 (MainThread): Running with dbt=0.19.1
2022-07-31 01:34:14.694621 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:34:14.767691 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:34:14.771779 (MainThread): Tracking: tracking
2022-07-31 01:34:14.772411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3c0acdd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb40cfabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb40da27b8>]}
2022-07-31 01:34:14.786476 (MainThread): Partial parsing not enabled
2022-07-31 01:34:14.788170 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:34:14.790788 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:34:14.821945 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:34:14.824281 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:34:14.826115 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:34:14.830559 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:34:14.843693 (MainThread): Parsing macros/core.sql
2022-07-31 01:34:14.848621 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:34:14.857770 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:34:14.859904 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:34:14.936879 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:34:14.973137 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:34:14.994298 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:34:14.997518 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:34:15.004422 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:34:15.018690 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:34:15.025711 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:34:15.032528 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:34:15.038334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:34:15.039792 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:34:15.041178 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:34:15.043200 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:34:15.052080 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:34:15.054740 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:34:15.056800 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:34:15.099158 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:34:15.101711 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:34:15.103870 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:34:15.105919 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:34:15.114630 (MainThread): Partial parsing not enabled
2022-07-31 01:34:15.136223 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:34:15.169040 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:34:15.172703 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:34:15.238568 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:34:15.239326 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf53cc7b-7acc-4d85-b788-f59fd2a5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb411c0b38>]}
2022-07-31 01:34:15.249794 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf53cc7b-7acc-4d85-b788-f59fd2a5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb40d837f0>]}
2022-07-31 01:34:15.250038 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:34:15.250641 (MainThread): 
2022-07-31 01:34:15.250920 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:34:15.251700 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:34:15.263799 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:34:15.263922 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:34:15.264002 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:34:16.046348 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.78 seconds
2022-07-31 01:34:16.049586 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:34:16.159686 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:34:16.166660 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:34:16.166790 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:34:16.166881 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:34:16.850234 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.68 seconds
2022-07-31 01:34:16.851752 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:34:16.968310 (MainThread): Using snowflake connection "master".
2022-07-31 01:34:16.968516 (MainThread): On master: BEGIN
2022-07-31 01:34:16.968648 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:34:17.479781 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:34:17.480134 (MainThread): On master: COMMIT
2022-07-31 01:34:17.480401 (MainThread): Using snowflake connection "master".
2022-07-31 01:34:17.480561 (MainThread): On master: COMMIT
2022-07-31 01:34:17.627226 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-07-31 01:34:17.627728 (MainThread): On master: Close
2022-07-31 01:34:17.753630 (MainThread): 20:34:17 | Concurrency: 8 threads (target='dev')
2022-07-31 01:34:17.753900 (MainThread): 20:34:17 | 
2022-07-31 01:34:17.755859 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:34:17.756229 (Thread-1): 20:34:17 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:34:17.756626 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:34:17.756801 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:34:17.764429 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:34:17.765355 (Thread-1): finished collecting timing info
2022-07-31 01:34:17.793895 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:34:17.795104 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:34:17.795206 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:34:17.795282 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:34:18.291633 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:34:18.291786 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:34:18.291863 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:34:18.373841 (Thread-1): Snowflake query id: 01a5f6de-0000-af49-0002-a3d6000143c6
2022-07-31 01:34:18.373966 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:34:18.374096 (Thread-1): finished collecting timing info
2022-07-31 01:34:18.374214 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:34:18.491135 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:34:18.604438 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:34:18.624191 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf53cc7b-7acc-4d85-b788-f59fd2a5f3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb414f4cf8>]}
2022-07-31 01:34:18.624708 (Thread-1): 20:34:18 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.87s]
2022-07-31 01:34:18.624900 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:34:18.681438 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:34:18.681851 (MainThread): Using snowflake connection "master".
2022-07-31 01:34:18.682051 (MainThread): On master: BEGIN
2022-07-31 01:34:18.682208 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:34:19.183978 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:34:19.184159 (MainThread): On master: COMMIT
2022-07-31 01:34:19.184306 (MainThread): Using snowflake connection "master".
2022-07-31 01:34:19.184391 (MainThread): On master: COMMIT
2022-07-31 01:34:19.308799 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:34:19.309197 (MainThread): On master: Close
2022-07-31 01:34:19.443207 (MainThread): 20:34:19 | 
2022-07-31 01:34:19.443447 (MainThread): 20:34:19 | Finished running 1 table model in 4.19s.
2022-07-31 01:34:19.443602 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:34:19.443820 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:34:19.460205 (MainThread): 
2022-07-31 01:34:19.460453 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:34:19.460613 (MainThread): 
2022-07-31 01:34:19.460763 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:34:19.460896 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:34:19.461018 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:34:19.461142 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:34:19.461271 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:34:19.461607 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb41003240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb412e1748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3f56dc50>]}
2022-07-31 01:34:19.461902 (MainThread): Flushing usage events
2022-07-31 01:36:55.334381 (MainThread): Running with dbt=0.19.1
2022-07-31 01:36:56.445184 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:36:56.522959 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:36:56.525742 (MainThread): Tracking: tracking
2022-07-31 01:36:56.526585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2e4692b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa29812dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2e487be0>]}
2022-07-31 01:36:56.544332 (MainThread): Partial parsing not enabled
2022-07-31 01:36:56.546268 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:36:56.549241 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:36:56.587013 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:36:56.589783 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:36:56.591690 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:36:56.596950 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:36:56.610831 (MainThread): Parsing macros/core.sql
2022-07-31 01:36:56.615667 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:36:56.626636 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:36:56.629980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:36:56.697003 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:36:56.731803 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:36:56.756639 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:36:56.758998 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:36:56.766320 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:36:56.783431 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:36:56.791951 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:36:56.800206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:36:56.806885 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:36:56.808217 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:36:56.809576 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:36:56.812093 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:36:56.822655 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:36:56.825192 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:36:56.828222 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:36:56.875034 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:36:56.878270 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:36:56.880228 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:36:56.882447 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:36:56.891612 (MainThread): Partial parsing not enabled
2022-07-31 01:36:56.915219 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:36:56.926144 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:36:56.929801 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:36:57.011943 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:36:57.012402 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0a2d155-102f-45f2-9fc7-35cbf74ff672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2e977ba8>]}
2022-07-31 01:36:57.017814 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0a2d155-102f-45f2-9fc7-35cbf74ff672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2e43d908>]}
2022-07-31 01:36:57.018041 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:36:57.018827 (MainThread): 
2022-07-31 01:36:57.019170 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:36:57.020016 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:36:57.033712 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:36:57.033844 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:36:57.033920 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:36:57.991045 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.96 seconds
2022-07-31 01:36:57.994998 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:36:58.153143 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:36:58.160129 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:36:58.160246 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:36:58.160327 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:36:58.667513 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.51 seconds
2022-07-31 01:36:58.668536 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:36:58.780950 (MainThread): Using snowflake connection "master".
2022-07-31 01:36:58.781177 (MainThread): On master: BEGIN
2022-07-31 01:36:58.781279 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:36:59.280063 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:36:59.280388 (MainThread): On master: COMMIT
2022-07-31 01:36:59.280603 (MainThread): Using snowflake connection "master".
2022-07-31 01:36:59.280718 (MainThread): On master: COMMIT
2022-07-31 01:36:59.397996 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2022-07-31 01:36:59.398307 (MainThread): On master: Close
2022-07-31 01:36:59.508915 (MainThread): 20:36:59 | Concurrency: 8 threads (target='dev')
2022-07-31 01:36:59.509169 (MainThread): 20:36:59 | 
2022-07-31 01:36:59.511376 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:36:59.511725 (Thread-1): 20:36:59 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:36:59.512181 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:36:59.512492 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:36:59.520953 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:36:59.522752 (Thread-1): finished collecting timing info
2022-07-31 01:36:59.556135 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:36:59.559977 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:36:59.560090 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:36:59.560165 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:37:00.069839 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2022-07-31 01:37:00.069996 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:37:00.070066 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (


/*WITH
*/


with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:37:00.152519 (Thread-1): Snowflake query id: 01a5f6e1-0000-af4d-0002-a3d60001538e
2022-07-31 01:37:00.152637 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:37:00.152764 (Thread-1): finished collecting timing info
2022-07-31 01:37:00.152883 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:37:00.279799 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:37:00.397838 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:37:00.407684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0a2d155-102f-45f2-9fc7-35cbf74ff672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2e9bdd30>]}
2022-07-31 01:37:00.407990 (Thread-1): 20:37:00 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.90s]
2022-07-31 01:37:00.408110 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:37:00.432870 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:37:00.433080 (MainThread): Using snowflake connection "master".
2022-07-31 01:37:00.433157 (MainThread): On master: BEGIN
2022-07-31 01:37:00.433224 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:37:01.248689 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2022-07-31 01:37:01.249141 (MainThread): On master: COMMIT
2022-07-31 01:37:01.249474 (MainThread): Using snowflake connection "master".
2022-07-31 01:37:01.249627 (MainThread): On master: COMMIT
2022-07-31 01:37:01.361706 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2022-07-31 01:37:01.361944 (MainThread): On master: Close
2022-07-31 01:37:01.478683 (MainThread): 20:37:01 | 
2022-07-31 01:37:01.478926 (MainThread): 20:37:01 | Finished running 1 table model in 4.46s.
2022-07-31 01:37:01.479078 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:37:01.479186 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:37:01.489114 (MainThread): 
2022-07-31 01:37:01.489302 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:37:01.489434 (MainThread): 
2022-07-31 01:37:01.489556 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:37:01.489675 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:37:01.489776 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:37:01.489869 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:37:01.489970 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:37:01.490154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2ed4f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2ec866d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa29812dd8>]}
2022-07-31 01:37:01.490370 (MainThread): Flushing usage events
2022-07-31 01:39:27.876291 (MainThread): Running with dbt=0.19.1
2022-07-31 01:39:29.091304 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:39:29.161286 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:39:29.167662 (MainThread): Tracking: tracking
2022-07-31 01:39:29.168245 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a3a12e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a858bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a858b860>]}
2022-07-31 01:39:29.182442 (MainThread): Partial parsing not enabled
2022-07-31 01:39:29.184046 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:39:29.187016 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:39:29.218306 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:39:29.220702 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:39:29.222616 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:39:29.227132 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:39:29.240911 (MainThread): Parsing macros/core.sql
2022-07-31 01:39:29.245654 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:39:29.255148 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:39:29.258013 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:39:29.332420 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:39:29.365377 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:39:29.387532 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:39:29.390058 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:39:29.396675 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:39:29.411251 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:39:29.418689 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:39:29.425482 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:39:29.430829 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:39:29.432262 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:39:29.433727 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:39:29.435682 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:39:29.445278 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:39:29.447651 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:39:29.450111 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:39:29.492632 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:39:29.494893 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:39:29.496848 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:39:29.498923 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:39:29.507264 (MainThread): Partial parsing not enabled
2022-07-31 01:39:29.530453 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:39:29.539832 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:39:29.543670 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:39:29.612487 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:39:29.612871 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89d7155-0b6c-4bf2-8dfc-ea38e3f795e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a8820ac8>]}
2022-07-31 01:39:29.623168 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89d7155-0b6c-4bf2-8dfc-ea38e3f795e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a8972860>]}
2022-07-31 01:39:29.623617 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:39:29.624398 (MainThread): 
2022-07-31 01:39:29.624688 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:39:29.625402 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:39:29.636994 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:39:29.637119 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:39:29.637200 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:39:30.461401 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2022-07-31 01:39:30.464731 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:39:30.592926 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:39:30.601253 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:39:30.601390 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:39:30.601486 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:39:31.091072 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.49 seconds
2022-07-31 01:39:31.092079 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:39:31.206740 (MainThread): Using snowflake connection "master".
2022-07-31 01:39:31.206931 (MainThread): On master: BEGIN
2022-07-31 01:39:31.207074 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:39:32.275065 (MainThread): SQL status: SUCCESS 1 in 1.07 seconds
2022-07-31 01:39:32.275332 (MainThread): On master: COMMIT
2022-07-31 01:39:32.275503 (MainThread): Using snowflake connection "master".
2022-07-31 01:39:32.275599 (MainThread): On master: COMMIT
2022-07-31 01:39:32.406341 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:39:32.406641 (MainThread): On master: Close
2022-07-31 01:39:32.528351 (MainThread): 20:39:32 | Concurrency: 8 threads (target='dev')
2022-07-31 01:39:32.528596 (MainThread): 20:39:32 | 
2022-07-31 01:39:32.530770 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 01:39:32.531173 (Thread-1): 20:39:32 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:39:32.531518 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:39:32.531664 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 01:39:32.536228 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:39:32.538577 (Thread-1): finished collecting timing info
2022-07-31 01:39:32.566274 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:39:32.568006 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:39:32.568129 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:39:32.568321 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:39:33.053293 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2022-07-31 01:39:33.053446 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:39:33.053519 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:39:33.138944 (Thread-1): Snowflake query id: 01a5f6e3-0000-af4d-0002-a3d6000153ae
2022-07-31 01:39:33.139064 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:39:33.139184 (Thread-1): finished collecting timing info
2022-07-31 01:39:33.139330 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:39:33.256544 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 01:39:33.374723 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:39:33.384425 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d7155-0b6c-4bf2-8dfc-ea38e3f795e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a8d4dbe0>]}
2022-07-31 01:39:33.384733 (Thread-1): 20:39:33 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.85s]
2022-07-31 01:39:33.384851 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 01:39:33.456779 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:39:33.456998 (MainThread): Using snowflake connection "master".
2022-07-31 01:39:33.457071 (MainThread): On master: BEGIN
2022-07-31 01:39:33.457138 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:39:33.956063 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:39:33.956228 (MainThread): On master: COMMIT
2022-07-31 01:39:33.956349 (MainThread): Using snowflake connection "master".
2022-07-31 01:39:33.956414 (MainThread): On master: COMMIT
2022-07-31 01:39:34.109039 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-07-31 01:39:34.109213 (MainThread): On master: Close
2022-07-31 01:39:34.222195 (MainThread): 20:39:34 | 
2022-07-31 01:39:34.222431 (MainThread): 20:39:34 | Finished running 1 table model in 4.60s.
2022-07-31 01:39:34.222593 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:39:34.222736 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:39:34.240494 (MainThread): 
2022-07-31 01:39:34.240822 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:39:34.241012 (MainThread): 
2022-07-31 01:39:34.241167 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:39:34.241302 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:39:34.241419 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:39:34.241530 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:39:34.241653 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 01:39:34.241871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a8803320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a89daf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a8e0ff60>]}
2022-07-31 01:39:34.242139 (MainThread): Flushing usage events
2022-07-31 01:53:43.409023 (MainThread): Running with dbt=0.19.1
2022-07-31 01:53:44.565467 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 01:53:44.635282 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 01:53:44.637658 (MainThread): Tracking: tracking
2022-07-31 01:53:44.638325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8376672b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832a12e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83769cbe0>]}
2022-07-31 01:53:44.651586 (MainThread): Partial parsing not enabled
2022-07-31 01:53:44.653042 (MainThread): Parsing macros/catalog.sql
2022-07-31 01:53:44.655621 (MainThread): Parsing macros/adapters.sql
2022-07-31 01:53:44.686164 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 01:53:44.688581 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 01:53:44.690420 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 01:53:44.694667 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 01:53:44.706935 (MainThread): Parsing macros/core.sql
2022-07-31 01:53:44.711793 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 01:53:44.721036 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 01:53:44.723146 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 01:53:44.796878 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 01:53:44.832563 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 01:53:44.854678 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 01:53:44.856987 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 01:53:44.863642 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 01:53:44.880981 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 01:53:44.888421 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 01:53:44.895284 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 01:53:44.900491 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 01:53:44.901886 (MainThread): Parsing macros/etc/query.sql
2022-07-31 01:53:44.903351 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 01:53:44.905340 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 01:53:44.915017 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 01:53:44.917612 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 01:53:44.919707 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 01:53:44.961548 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 01:53:44.963823 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 01:53:44.965765 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 01:53:44.967923 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 01:53:44.976082 (MainThread): Partial parsing not enabled
2022-07-31 01:53:44.997484 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:53:45.007324 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:53:45.011254 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:53:45.083976 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 01:53:45.084514 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d907d8a-8f13-4cf9-b91b-b4c6203fa3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd838134a90>]}
2022-07-31 01:53:45.091471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d907d8a-8f13-4cf9-b91b-b4c6203fa3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8376bee80>]}
2022-07-31 01:53:45.091750 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 01:53:45.092563 (MainThread): 
2022-07-31 01:53:45.092872 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:53:45.093721 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 01:53:45.105242 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 01:53:45.105362 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 01:53:45.105442 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 01:53:46.046922 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2022-07-31 01:53:46.053063 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 01:53:46.183240 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:53:46.191542 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 01:53:46.191733 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 01:53:46.191840 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 01:53:46.870738 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.68 seconds
2022-07-31 01:53:46.872298 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 01:53:46.987460 (MainThread): Using snowflake connection "master".
2022-07-31 01:53:46.987658 (MainThread): On master: BEGIN
2022-07-31 01:53:46.987788 (MainThread): Opening a new connection, currently in state init
2022-07-31 01:53:47.486484 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 01:53:47.486923 (MainThread): On master: COMMIT
2022-07-31 01:53:47.487330 (MainThread): Using snowflake connection "master".
2022-07-31 01:53:47.487490 (MainThread): On master: COMMIT
2022-07-31 01:53:47.616281 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:53:47.616601 (MainThread): On master: Close
2022-07-31 01:53:47.735431 (MainThread): 20:53:47 | Concurrency: 8 threads (target='dev')
2022-07-31 01:53:47.735687 (MainThread): 20:53:47 | 
2022-07-31 01:53:47.737804 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 01:53:47.738053 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 01:53:47.738378 (Thread-1): 20:53:47 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 01:53:47.738651 (Thread-2): 20:53:47 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 01:53:47.739048 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:53:47.739431 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:53:47.739568 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 01:53:47.739701 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 01:53:47.745714 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:53:47.747982 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 01:53:47.748374 (Thread-2): finished collecting timing info
2022-07-31 01:53:47.765653 (Thread-1): finished collecting timing info
2022-07-31 01:53:47.780913 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 01:53:47.785427 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 01:53:47.786604 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:53:47.786704 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 01:53:47.786778 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 01:53:47.796370 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:53:47.796516 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-07-31 01:53:47.796593 (Thread-2): Opening a new connection, currently in state init
2022-07-31 01:53:48.468411 (Thread-2): SQL status: SUCCESS 1 in 0.67 seconds
2022-07-31 01:53:48.468568 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 01:53:48.468640 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 01:53:48.483882 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2022-07-31 01:53:48.484005 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:53:48.484076 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 01:53:48.549001 (Thread-2): Snowflake query id: 01a5f6f1-0000-af49-0002-a3d600014442
2022-07-31 01:53:48.549121 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:53:48.549248 (Thread-2): finished collecting timing info
2022-07-31 01:53:48.549363 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 01:53:48.671538 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 01:53:48.787063 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:53:48.802700 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d907d8a-8f13-4cf9-b91b-b4c6203fa3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8383d7d68>]}
2022-07-31 01:53:48.803186 (Thread-2): 20:53:48 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.06s]
2022-07-31 01:53:48.803386 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 01:53:49.540311 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2022-07-31 01:53:49.542174 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 01:53:49.542404 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 01:53:49.542553 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 01:53:49.618103 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-31 01:53:49.630573 (Thread-1): finished collecting timing info
2022-07-31 01:53:49.630763 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 01:53:49.750702 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d907d8a-8f13-4cf9-b91b-b4c6203fa3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8384998d0>]}
2022-07-31 01:53:49.751220 (Thread-1): 20:53:49 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.01s]
2022-07-31 01:53:49.751412 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 01:53:49.751875 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 01:53:49.752162 (Thread-3): 20:53:49 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 01:53:49.752550 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:53:49.752708 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 01:53:49.755380 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 01:53:49.756223 (Thread-3): finished collecting timing info
2022-07-31 01:53:49.776435 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 01:53:49.777500 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:53:49.777601 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 01:53:49.777678 (Thread-3): Opening a new connection, currently in state init
2022-07-31 01:53:50.256269 (Thread-3): SQL status: SUCCESS 1 in 0.48 seconds
2022-07-31 01:53:50.256429 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:53:50.256536 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 01:53:50.490723 (Thread-3): SQL status: SUCCESS 1 in 0.23 seconds
2022-07-31 01:53:50.491936 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 01:53:50.492097 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 01:53:50.492171 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 01:53:50.572830 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-31 01:53:50.573622 (Thread-3): finished collecting timing info
2022-07-31 01:53:50.573756 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 01:53:50.686685 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d907d8a-8f13-4cf9-b91b-b4c6203fa3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd838338cc0>]}
2022-07-31 01:53:50.687020 (Thread-3): 20:53:50 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.93s]
2022-07-31 01:53:50.687142 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 01:53:50.727577 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 01:53:50.727802 (MainThread): Using snowflake connection "master".
2022-07-31 01:53:50.727877 (MainThread): On master: BEGIN
2022-07-31 01:53:50.727947 (MainThread): Opening a new connection, currently in state closed
2022-07-31 01:53:51.265587 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-07-31 01:53:51.265761 (MainThread): On master: COMMIT
2022-07-31 01:53:51.265919 (MainThread): Using snowflake connection "master".
2022-07-31 01:53:51.265988 (MainThread): On master: COMMIT
2022-07-31 01:53:51.393329 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 01:53:51.393493 (MainThread): On master: Close
2022-07-31 01:53:51.508044 (MainThread): 20:53:51 | 
2022-07-31 01:53:51.508286 (MainThread): 20:53:51 | Finished running 2 table models, 1 view model in 6.42s.
2022-07-31 01:53:51.508427 (MainThread): Connection 'master' was properly closed.
2022-07-31 01:53:51.508520 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 01:53:51.508609 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 01:53:51.508695 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 01:53:51.517651 (MainThread): 
2022-07-31 01:53:51.517842 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 01:53:51.517972 (MainThread): 
2022-07-31 01:53:51.518099 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 01:53:51.518215 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 01:53:51.518322 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 01:53:51.518431 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 01:53:51.518554 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 01:53:51.518757 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8380d0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8383e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8382925c0>]}
2022-07-31 01:53:51.518993 (MainThread): Flushing usage events
2022-07-31 02:08:46.132616 (MainThread): Running with dbt=0.19.1
2022-07-31 02:08:47.063516 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 02:08:47.141528 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 02:08:47.144090 (MainThread): Tracking: tracking
2022-07-31 02:08:47.145666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7195662e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd714a13e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719594be0>]}
2022-07-31 02:08:47.161633 (MainThread): Partial parsing not enabled
2022-07-31 02:08:47.163282 (MainThread): Parsing macros/catalog.sql
2022-07-31 02:08:47.166243 (MainThread): Parsing macros/adapters.sql
2022-07-31 02:08:47.200156 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 02:08:47.203468 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 02:08:47.205280 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 02:08:47.210330 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 02:08:47.223213 (MainThread): Parsing macros/core.sql
2022-07-31 02:08:47.228141 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 02:08:47.238088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 02:08:47.240086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 02:08:47.319716 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 02:08:47.355887 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 02:08:47.380032 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 02:08:47.382171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 02:08:47.389491 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 02:08:47.404588 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 02:08:47.413404 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 02:08:47.420507 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 02:08:47.426614 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 02:08:47.428044 (MainThread): Parsing macros/etc/query.sql
2022-07-31 02:08:47.430712 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 02:08:47.432762 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 02:08:47.442774 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 02:08:47.446227 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 02:08:47.448196 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 02:08:47.495549 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 02:08:47.497678 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 02:08:47.499385 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 02:08:47.501272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 02:08:47.509534 (MainThread): Partial parsing not enabled
2022-07-31 02:08:47.534344 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:08:47.545994 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:08:47.549647 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:08:47.617816 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 02:08:47.618534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3db7505-0f08-4c84-9fff-b4b346c9c427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7197a4f98>]}
2022-07-31 02:08:47.622928 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3db7505-0f08-4c84-9fff-b4b346c9c427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7197a4f98>]}
2022-07-31 02:08:47.623220 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 02:08:47.624044 (MainThread): 
2022-07-31 02:08:47.624411 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:08:47.625388 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 02:08:47.637049 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 02:08:47.637169 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 02:08:47.637279 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 02:08:48.472663 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.84 seconds
2022-07-31 02:08:48.476008 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 02:08:48.596279 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:08:48.603861 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:08:48.604066 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 02:08:48.604172 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 02:08:49.147612 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.54 seconds
2022-07-31 02:08:49.148579 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 02:08:49.266491 (MainThread): Using snowflake connection "master".
2022-07-31 02:08:49.266628 (MainThread): On master: BEGIN
2022-07-31 02:08:49.266702 (MainThread): Opening a new connection, currently in state init
2022-07-31 02:08:49.758842 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 02:08:49.759338 (MainThread): On master: COMMIT
2022-07-31 02:08:49.759630 (MainThread): Using snowflake connection "master".
2022-07-31 02:08:49.759848 (MainThread): On master: COMMIT
2022-07-31 02:08:49.898442 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 02:08:49.898647 (MainThread): On master: Close
2022-07-31 02:08:50.011034 (MainThread): 21:08:50 | Concurrency: 8 threads (target='dev')
2022-07-31 02:08:50.011270 (MainThread): 21:08:50 | 
2022-07-31 02:08:50.013145 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:08:50.013277 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 02:08:50.013531 (Thread-1): 21:08:50 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 02:08:50.013713 (Thread-2): 21:08:50 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 02:08:50.014045 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:08:50.014425 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:08:50.014535 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 02:08:50.014650 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 02:08:50.018952 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:08:50.020945 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:08:50.021376 (Thread-2): finished collecting timing info
2022-07-31 02:08:50.051571 (Thread-1): finished collecting timing info
2022-07-31 02:08:50.054486 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:08:50.056839 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:08:50.058526 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:08:50.058672 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-07-31 02:08:50.058770 (Thread-2): Opening a new connection, currently in state init
2022-07-31 02:08:50.060913 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:08:50.061214 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 02:08:50.061344 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 02:08:50.772258 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2022-07-31 02:08:50.772448 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:08:50.772559 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 02:08:50.907317 (Thread-2): SQL status: SUCCESS 1 in 0.85 seconds
2022-07-31 02:08:50.907476 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:08:50.907548 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 02:08:50.994226 (Thread-2): Snowflake query id: 01a5f700-0000-af49-0002-a3d600014492
2022-07-31 02:08:50.994615 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:08:50.995003 (Thread-2): finished collecting timing info
2022-07-31 02:08:50.995493 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 02:08:51.122922 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 02:08:51.253941 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:08:51.264321 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3db7505-0f08-4c84-9fff-b4b346c9c427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719d2f9e8>]}
2022-07-31 02:08:51.264742 (Thread-2): 21:08:51 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.25s]
2022-07-31 02:08:51.264912 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 02:08:51.556113 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2022-07-31 02:08:51.557230 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:08:51.557421 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:08:51.557507 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:08:51.627990 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 02:08:51.636443 (Thread-1): finished collecting timing info
2022-07-31 02:08:51.636590 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 02:08:51.748790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3db7505-0f08-4c84-9fff-b4b346c9c427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719cafc18>]}
2022-07-31 02:08:51.749205 (Thread-1): 21:08:51 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.73s]
2022-07-31 02:08:51.749351 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:08:51.749754 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:08:51.749974 (Thread-3): 21:08:51 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 02:08:51.750327 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:08:51.750449 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 02:08:51.752441 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:08:51.754746 (Thread-3): finished collecting timing info
2022-07-31 02:08:51.771769 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:08:51.774637 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:08:51.774753 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 02:08:51.774829 (Thread-3): Opening a new connection, currently in state init
2022-07-31 02:08:52.299302 (Thread-3): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 02:08:52.299556 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:08:52.299693 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 02:08:52.499638 (Thread-3): SQL status: SUCCESS 1 in 0.20 seconds
2022-07-31 02:08:52.500593 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:08:52.500726 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:08:52.500797 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:08:52.575728 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 02:08:52.576404 (Thread-3): finished collecting timing info
2022-07-31 02:08:52.576526 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 02:08:52.686647 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3db7505-0f08-4c84-9fff-b4b346c9c427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719c47be0>]}
2022-07-31 02:08:52.686987 (Thread-3): 21:08:52 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.94s]
2022-07-31 02:08:52.687106 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:08:52.774099 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:08:52.774412 (MainThread): Using snowflake connection "master".
2022-07-31 02:08:52.774503 (MainThread): On master: BEGIN
2022-07-31 02:08:52.774587 (MainThread): Opening a new connection, currently in state closed
2022-07-31 02:08:53.290853 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 02:08:53.291181 (MainThread): On master: COMMIT
2022-07-31 02:08:53.291458 (MainThread): Using snowflake connection "master".
2022-07-31 02:08:53.291619 (MainThread): On master: COMMIT
2022-07-31 02:08:53.422575 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-07-31 02:08:53.422768 (MainThread): On master: Close
2022-07-31 02:08:53.546258 (MainThread): 21:08:53 | 
2022-07-31 02:08:53.546438 (MainThread): 21:08:53 | Finished running 2 table models, 1 view model in 5.92s.
2022-07-31 02:08:53.546545 (MainThread): Connection 'master' was properly closed.
2022-07-31 02:08:53.546609 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 02:08:53.546666 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 02:08:53.546722 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 02:08:53.554214 (MainThread): 
2022-07-31 02:08:53.554378 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 02:08:53.554509 (MainThread): 
2022-07-31 02:08:53.554635 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 02:08:53.554776 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 02:08:53.554908 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:08:53.554994 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:08:53.555078 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 02:08:53.555242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7199877b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7197fd8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7197fdac8>]}
2022-07-31 02:08:53.555421 (MainThread): Flushing usage events
2022-07-31 02:12:40.118553 (MainThread): Running with dbt=0.19.1
2022-07-31 02:12:40.944906 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 02:12:41.008213 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 02:12:41.011150 (MainThread): Tracking: tracking
2022-07-31 02:12:41.012104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8517f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8517f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8517eb8>]}
2022-07-31 02:12:41.026315 (MainThread): Partial parsing not enabled
2022-07-31 02:12:41.027786 (MainThread): Parsing macros/catalog.sql
2022-07-31 02:12:41.030336 (MainThread): Parsing macros/adapters.sql
2022-07-31 02:12:41.063385 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 02:12:41.066281 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 02:12:41.068308 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 02:12:41.073097 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 02:12:41.087556 (MainThread): Parsing macros/core.sql
2022-07-31 02:12:41.091773 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 02:12:41.102799 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 02:12:41.105236 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 02:12:41.185114 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 02:12:41.220847 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 02:12:41.243889 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 02:12:41.246856 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 02:12:41.254199 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 02:12:41.269665 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 02:12:41.277481 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 02:12:41.286369 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 02:12:41.292543 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 02:12:41.293759 (MainThread): Parsing macros/etc/query.sql
2022-07-31 02:12:41.295282 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 02:12:41.297175 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 02:12:41.309429 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 02:12:41.311792 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 02:12:41.313955 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 02:12:41.360970 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 02:12:41.363985 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 02:12:41.366812 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 02:12:41.368922 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 02:12:41.377912 (MainThread): Partial parsing not enabled
2022-07-31 02:12:41.402996 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:12:41.413619 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:12:41.418156 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:12:41.498704 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 02:12:41.499313 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '244a3e2f-9d0d-4180-b94f-20673c7f0771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8765da0>]}
2022-07-31 02:12:41.505869 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '244a3e2f-9d0d-4180-b94f-20673c7f0771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8765e10>]}
2022-07-31 02:12:41.506101 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 02:12:41.506791 (MainThread): 
2022-07-31 02:12:41.507053 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:12:41.507871 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 02:12:41.521735 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 02:12:41.521874 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 02:12:41.521952 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 02:12:42.454372 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.93 seconds
2022-07-31 02:12:42.457734 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 02:12:42.570359 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:12:42.576695 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:12:42.576827 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 02:12:42.576905 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 02:12:43.089243 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.51 seconds
2022-07-31 02:12:43.090960 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 02:12:43.220464 (MainThread): Using snowflake connection "master".
2022-07-31 02:12:43.220600 (MainThread): On master: BEGIN
2022-07-31 02:12:43.220676 (MainThread): Opening a new connection, currently in state init
2022-07-31 02:12:43.772494 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2022-07-31 02:12:43.772956 (MainThread): On master: COMMIT
2022-07-31 02:12:43.773307 (MainThread): Using snowflake connection "master".
2022-07-31 02:12:43.773467 (MainThread): On master: COMMIT
2022-07-31 02:12:43.917039 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 02:12:43.917209 (MainThread): On master: Close
2022-07-31 02:12:44.036636 (MainThread): 21:12:44 | Concurrency: 8 threads (target='dev')
2022-07-31 02:12:44.036812 (MainThread): 21:12:44 | 
2022-07-31 02:12:44.038057 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:12:44.038182 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 02:12:44.038411 (Thread-1): 21:12:44 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 02:12:44.038580 (Thread-2): 21:12:44 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 02:12:44.038911 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:12:44.039023 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 02:12:44.039231 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:12:44.041960 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:12:44.042065 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 02:12:44.045741 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:12:44.046117 (Thread-1): finished collecting timing info
2022-07-31 02:12:44.066534 (Thread-2): finished collecting timing info
2022-07-31 02:12:44.071398 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:12:44.073140 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:12:44.074450 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:12:44.074554 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 02:12:44.074630 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 02:12:44.076653 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:12:44.077019 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-07-31 02:12:44.077116 (Thread-2): Opening a new connection, currently in state init
2022-07-31 02:12:44.780974 (Thread-2): SQL status: SUCCESS 1 in 0.70 seconds
2022-07-31 02:12:44.781211 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:12:44.781379 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 02:12:44.888412 (Thread-2): Snowflake query id: 01a5f704-0000-af49-0002-a3d6000144ba
2022-07-31 02:12:44.888547 (Thread-2): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:12:44.888677 (Thread-2): finished collecting timing info
2022-07-31 02:12:44.888798 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 02:12:45.001333 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2022-07-31 02:12:45.001473 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:12:45.001554 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 02:12:45.035811 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 02:12:45.167581 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:12:45.171703 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244a3e2f-9d0d-4180-b94f-20673c7f0771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8c8f358>]}
2022-07-31 02:12:45.172007 (Thread-2): 21:12:45 | 2 of 3 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.13s]
2022-07-31 02:12:45.172120 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 02:12:46.258037 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2022-07-31 02:12:46.260230 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:12:46.260530 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:12:46.260695 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:12:46.348141 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2022-07-31 02:12:46.359692 (Thread-1): finished collecting timing info
2022-07-31 02:12:46.359881 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 02:12:46.484505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244a3e2f-9d0d-4180-b94f-20673c7f0771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8aba5f8>]}
2022-07-31 02:12:46.485001 (Thread-1): 21:12:46 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.45s]
2022-07-31 02:12:46.485206 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:12:46.485723 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:12:46.486028 (Thread-3): 21:12:46 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 02:12:46.486429 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:12:46.486595 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 02:12:46.489154 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:12:46.490014 (Thread-3): finished collecting timing info
2022-07-31 02:12:46.509720 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:12:46.510736 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:12:46.510845 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 02:12:46.510988 (Thread-3): Opening a new connection, currently in state init
2022-07-31 02:12:47.034852 (Thread-3): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 02:12:47.035025 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:12:47.035132 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 02:12:47.300636 (Thread-3): SQL status: SUCCESS 1 in 0.27 seconds
2022-07-31 02:12:47.302176 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:12:47.302350 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:12:47.302431 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:12:47.371927 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 02:12:47.373025 (Thread-3): finished collecting timing info
2022-07-31 02:12:47.373239 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 02:12:47.493782 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244a3e2f-9d0d-4180-b94f-20673c7f0771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8a02d68>]}
2022-07-31 02:12:47.494141 (Thread-3): 21:12:47 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.01s]
2022-07-31 02:12:47.494291 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:12:47.550754 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:12:47.551006 (MainThread): Using snowflake connection "master".
2022-07-31 02:12:47.551086 (MainThread): On master: BEGIN
2022-07-31 02:12:47.551169 (MainThread): Opening a new connection, currently in state closed
2022-07-31 02:12:48.090004 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-07-31 02:12:48.090265 (MainThread): On master: COMMIT
2022-07-31 02:12:48.090432 (MainThread): Using snowflake connection "master".
2022-07-31 02:12:48.090510 (MainThread): On master: COMMIT
2022-07-31 02:12:48.257136 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2022-07-31 02:12:48.257325 (MainThread): On master: Close
2022-07-31 02:12:48.381861 (MainThread): 21:12:48 | 
2022-07-31 02:12:48.382066 (MainThread): 21:12:48 | Finished running 2 table models, 1 view model in 6.87s.
2022-07-31 02:12:48.382239 (MainThread): Connection 'master' was properly closed.
2022-07-31 02:12:48.382325 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 02:12:48.382389 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 02:12:48.382447 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 02:12:48.391461 (MainThread): 
2022-07-31 02:12:48.391614 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 02:12:48.391713 (MainThread): 
2022-07-31 02:12:48.391812 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 02:12:48.391899 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 02:12:48.391969 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:12:48.392038 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:12:48.392125 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-07-31 02:12:48.392286 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b879f198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b880cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b879bf60>]}
2022-07-31 02:12:48.392463 (MainThread): Flushing usage events
2022-07-31 02:13:00.371262 (MainThread): Running with dbt=0.19.1
2022-07-31 02:13:01.208471 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 02:13:01.272573 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['candidates'], partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 02:13:01.275483 (MainThread): Tracking: tracking
2022-07-31 02:13:01.276200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bda34e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd570ade48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bdd1828>]}
2022-07-31 02:13:01.290643 (MainThread): Partial parsing not enabled
2022-07-31 02:13:01.292051 (MainThread): Parsing macros/catalog.sql
2022-07-31 02:13:01.294520 (MainThread): Parsing macros/adapters.sql
2022-07-31 02:13:01.325043 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 02:13:01.327475 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 02:13:01.329133 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 02:13:01.333387 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 02:13:01.345600 (MainThread): Parsing macros/core.sql
2022-07-31 02:13:01.349815 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 02:13:01.358826 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 02:13:01.360993 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 02:13:01.434290 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 02:13:01.468982 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 02:13:01.491200 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 02:13:01.493877 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 02:13:01.500303 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 02:13:01.514658 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 02:13:01.521646 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 02:13:01.528131 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 02:13:01.533128 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 02:13:01.534429 (MainThread): Parsing macros/etc/query.sql
2022-07-31 02:13:01.535762 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 02:13:01.537687 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 02:13:01.547122 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 02:13:01.549367 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 02:13:01.551336 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 02:13:01.592272 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 02:13:01.594612 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 02:13:01.596634 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 02:13:01.598595 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 02:13:01.606708 (MainThread): Partial parsing not enabled
2022-07-31 02:13:01.628121 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:13:01.637593 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:13:01.641012 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:13:01.709998 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 02:13:01.710776 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4105762b-a6cf-4960-9292-5a6b1262c456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bff4978>]}
2022-07-31 02:13:01.715399 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4105762b-a6cf-4960-9292-5a6b1262c456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a1bc630>]}
2022-07-31 02:13:01.715700 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 02:13:01.716490 (MainThread): 
2022-07-31 02:13:01.716759 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:13:01.717470 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 02:13:01.728747 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 02:13:01.728859 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 02:13:01.728974 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 02:13:02.554074 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.83 seconds
2022-07-31 02:13:02.557320 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 02:13:02.672251 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:13:02.678378 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:13:02.678504 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 02:13:02.678577 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 02:13:03.453627 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.78 seconds
2022-07-31 02:13:03.454465 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 02:13:03.564279 (MainThread): Using snowflake connection "master".
2022-07-31 02:13:03.564467 (MainThread): On master: BEGIN
2022-07-31 02:13:03.564542 (MainThread): Opening a new connection, currently in state init
2022-07-31 02:13:04.095605 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-31 02:13:04.095814 (MainThread): On master: COMMIT
2022-07-31 02:13:04.095941 (MainThread): Using snowflake connection "master".
2022-07-31 02:13:04.096014 (MainThread): On master: COMMIT
2022-07-31 02:13:04.234268 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 02:13:04.234455 (MainThread): On master: Close
2022-07-31 02:13:04.359344 (MainThread): 21:13:04 | Concurrency: 8 threads (target='dev')
2022-07-31 02:13:04.359655 (MainThread): 21:13:04 | 
2022-07-31 02:13:04.362057 (Thread-1): Began running node model.fivetran_poc.candidates
2022-07-31 02:13:04.362430 (Thread-1): 21:13:04 | 1 of 1 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 02:13:04.362777 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:13:04.362907 (Thread-1): Compiling model.fivetran_poc.candidates
2022-07-31 02:13:04.368176 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:13:04.368979 (Thread-1): finished collecting timing info
2022-07-31 02:13:04.396003 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:13:04.397195 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:13:04.397295 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-07-31 02:13:04.397417 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 02:13:04.920037 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2022-07-31 02:13:04.920198 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:13:04.920275 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 02:13:05.016594 (Thread-1): Snowflake query id: 01a5f705-0000-af49-0002-a3d6000144da
2022-07-31 02:13:05.016734 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:13:05.016866 (Thread-1): finished collecting timing info
2022-07-31 02:13:05.016985 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-07-31 02:13:05.163235 (Thread-1): On model.fivetran_poc.candidates: Close
2022-07-31 02:13:05.288737 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  002003 (02000): SQL compilation error:
  Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:13:05.293033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4105762b-a6cf-4960-9292-5a6b1262c456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bff1400>]}
2022-07-31 02:13:05.293346 (Thread-1): 21:13:05 | 1 of 1 ERROR creating table model PUBLIC.candidates.................. [ERROR in 0.93s]
2022-07-31 02:13:05.293472 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-07-31 02:13:05.391583 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:13:05.391824 (MainThread): Using snowflake connection "master".
2022-07-31 02:13:05.391903 (MainThread): On master: BEGIN
2022-07-31 02:13:05.391973 (MainThread): Opening a new connection, currently in state closed
2022-07-31 02:13:05.892722 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2022-07-31 02:13:05.892895 (MainThread): On master: COMMIT
2022-07-31 02:13:05.893032 (MainThread): Using snowflake connection "master".
2022-07-31 02:13:05.893109 (MainThread): On master: COMMIT
2022-07-31 02:13:06.066256 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2022-07-31 02:13:06.066756 (MainThread): On master: Close
2022-07-31 02:13:06.193144 (MainThread): 21:13:06 | 
2022-07-31 02:13:06.193323 (MainThread): 21:13:06 | Finished running 1 table model in 4.48s.
2022-07-31 02:13:06.193419 (MainThread): Connection 'master' was properly closed.
2022-07-31 02:13:06.193483 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 02:13:06.201984 (MainThread): 
2022-07-31 02:13:06.202131 (MainThread): Completed with 1 error and 0 warnings:
2022-07-31 02:13:06.202221 (MainThread): 
2022-07-31 02:13:06.202306 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-07-31 02:13:06.202383 (MainThread):   002003 (02000): SQL compilation error:
2022-07-31 02:13:06.202452 (MainThread):   Schema 'COMBINE_DW.POC_CLIENT_1_PUBLIC' does not exist or not authorized.
2022-07-31 02:13:06.202519 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-07-31 02:13:06.202590 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-07-31 02:13:06.202727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bf05320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5c07dda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5bff4f98>]}
2022-07-31 02:13:06.202930 (MainThread): Flushing usage events
2022-07-31 02:18:56.629372 (MainThread): Running with dbt=0.19.1
2022-07-31 02:18:57.528293 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-07-31 02:18:57.592934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-07-31 02:18:57.595414 (MainThread): Tracking: tracking
2022-07-31 02:18:57.596218 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4d0f438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e0012e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4d38ba8>]}
2022-07-31 02:18:57.609384 (MainThread): Partial parsing not enabled
2022-07-31 02:18:57.610835 (MainThread): Parsing macros/catalog.sql
2022-07-31 02:18:57.613535 (MainThread): Parsing macros/adapters.sql
2022-07-31 02:18:57.643822 (MainThread): Parsing macros/materializations/merge.sql
2022-07-31 02:18:57.646143 (MainThread): Parsing macros/materializations/view.sql
2022-07-31 02:18:57.648157 (MainThread): Parsing macros/materializations/table.sql
2022-07-31 02:18:57.652487 (MainThread): Parsing macros/materializations/incremental.sql
2022-07-31 02:18:57.664845 (MainThread): Parsing macros/core.sql
2022-07-31 02:18:57.668989 (MainThread): Parsing macros/materializations/helpers.sql
2022-07-31 02:18:57.677946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-07-31 02:18:57.680015 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-07-31 02:18:57.755264 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-07-31 02:18:57.790672 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-07-31 02:18:57.811537 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-07-31 02:18:57.813821 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-07-31 02:18:57.820593 (MainThread): Parsing macros/materializations/common/merge.sql
2022-07-31 02:18:57.834824 (MainThread): Parsing macros/materializations/table/table.sql
2022-07-31 02:18:57.841955 (MainThread): Parsing macros/materializations/view/view.sql
2022-07-31 02:18:57.848673 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-07-31 02:18:57.853883 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-07-31 02:18:57.855288 (MainThread): Parsing macros/etc/query.sql
2022-07-31 02:18:57.856627 (MainThread): Parsing macros/etc/is_incremental.sql
2022-07-31 02:18:57.858462 (MainThread): Parsing macros/etc/datetime.sql
2022-07-31 02:18:57.867442 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-07-31 02:18:57.869737 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-07-31 02:18:57.871642 (MainThread): Parsing macros/adapters/common.sql
2022-07-31 02:18:57.914610 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-07-31 02:18:57.916922 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-07-31 02:18:57.918737 (MainThread): Parsing macros/schema_tests/unique.sql
2022-07-31 02:18:57.920663 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-07-31 02:18:57.928889 (MainThread): Partial parsing not enabled
2022-07-31 02:18:57.949610 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:18:57.959004 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:18:57.962516 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:18:58.036147 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-07-31 02:18:58.036727 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0256c290-54ac-4ee6-b73b-6c2818a43f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4f48f28>]}
2022-07-31 02:18:58.046898 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0256c290-54ac-4ee6-b73b-6c2818a43f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4f48f28>]}
2022-07-31 02:18:58.047172 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-07-31 02:18:58.048217 (MainThread): 
2022-07-31 02:18:58.048580 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:18:58.049643 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-07-31 02:18:58.061707 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-07-31 02:18:58.061827 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-07-31 02:18:58.061915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-07-31 02:18:59.016100 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.95 seconds
2022-07-31 02:18:59.019852 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-07-31 02:18:59.147546 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:18:59.155082 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-07-31 02:18:59.155235 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-07-31 02:18:59.155387 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-07-31 02:18:59.672223 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.52 seconds
2022-07-31 02:18:59.673287 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-07-31 02:19:00.286741 (MainThread): Using snowflake connection "master".
2022-07-31 02:19:00.286965 (MainThread): On master: BEGIN
2022-07-31 02:19:00.287097 (MainThread): Opening a new connection, currently in state init
2022-07-31 02:19:01.376769 (MainThread): SQL status: SUCCESS 1 in 1.09 seconds
2022-07-31 02:19:01.378125 (MainThread): On master: COMMIT
2022-07-31 02:19:01.378536 (MainThread): Using snowflake connection "master".
2022-07-31 02:19:01.378800 (MainThread): On master: COMMIT
2022-07-31 02:19:01.518425 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-07-31 02:19:01.518743 (MainThread): On master: Close
2022-07-31 02:19:01.726191 (MainThread): 21:19:01 | Concurrency: 8 threads (target='dev')
2022-07-31 02:19:01.726446 (MainThread): 21:19:01 | 
2022-07-31 02:19:01.728663 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:19:01.728937 (Thread-2): Began running node model.fivetran_poc.candidates
2022-07-31 02:19:01.729308 (Thread-1): 21:19:01 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-07-31 02:19:01.729602 (Thread-2): 21:19:01 | 2 of 3 START table model PUBLIC.candidates........................... [RUN]
2022-07-31 02:19:01.730003 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:19:01.730433 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:19:01.730597 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-07-31 02:19:01.730756 (Thread-2): Compiling model.fivetran_poc.candidates
2022-07-31 02:19:01.736483 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:19:01.738934 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:19:01.741683 (Thread-1): finished collecting timing info
2022-07-31 02:19:01.741866 (Thread-2): finished collecting timing info
2022-07-31 02:19:01.786228 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-07-31 02:19:01.789266 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-07-31 02:19:01.792367 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:19:01.792468 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:19:01.792543 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-07-31 02:19:01.792639 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-07-31 02:19:01.792747 (Thread-1): Opening a new connection, currently in state closed
2022-07-31 02:19:01.792847 (Thread-2): Opening a new connection, currently in state init
2022-07-31 02:19:02.537337 (Thread-2): SQL status: SUCCESS 1 in 0.74 seconds
2022-07-31 02:19:02.537637 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2022-07-31 02:19:02.537781 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:19:02.537882 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:19:02.537973 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-07-31 02:19:02.538063 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-07-31 02:19:03.141969 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2022-07-31 02:19:03.143213 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:19:03.143376 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-07-31 02:19:03.143499 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-07-31 02:19:03.230179 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2022-07-31 02:19:03.240525 (Thread-1): finished collecting timing info
2022-07-31 02:19:03.240754 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-07-31 02:19:03.252042 (Thread-2): SQL status: SUCCESS 1 in 0.71 seconds
2022-07-31 02:19:03.252950 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-07-31 02:19:03.253083 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-07-31 02:19:03.253155 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-07-31 02:19:03.327070 (Thread-2): SQL status: SUCCESS 1 in 0.07 seconds
2022-07-31 02:19:03.327736 (Thread-2): finished collecting timing info
2022-07-31 02:19:03.327881 (Thread-2): On model.fivetran_poc.candidates: Close
2022-07-31 02:19:03.355438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0256c290-54ac-4ee6-b73b-6c2818a43f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e549f710>]}
2022-07-31 02:19:03.355765 (Thread-1): 21:19:03 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.63s]
2022-07-31 02:19:03.355883 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-07-31 02:19:03.356247 (Thread-3): Began running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:19:03.356433 (Thread-3): 21:19:03 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-07-31 02:19:03.356685 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:19:03.356780 (Thread-3): Compiling model.fivetran_poc.my_second_dbt_model
2022-07-31 02:19:03.358936 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:19:03.360921 (Thread-3): finished collecting timing info
2022-07-31 02:19:03.376419 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-07-31 02:19:03.379050 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:19:03.379160 (Thread-3): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-07-31 02:19:03.379258 (Thread-3): Opening a new connection, currently in state init
2022-07-31 02:19:03.452942 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0256c290-54ac-4ee6-b73b-6c2818a43f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e54ba198>]}
2022-07-31 02:19:03.453273 (Thread-2): 21:19:03 | 2 of 3 OK created table model PUBLIC.candidates...................... [SUCCESS 1 in 1.72s]
2022-07-31 02:19:03.453390 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-07-31 02:19:03.870168 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2022-07-31 02:19:03.870379 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:19:03.870518 (Thread-3): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-07-31 02:19:04.075710 (Thread-3): SQL status: SUCCESS 1 in 0.21 seconds
2022-07-31 02:19:04.076692 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:19:04.076835 (Thread-3): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-07-31 02:19:04.076908 (Thread-3): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-07-31 02:19:04.153328 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-07-31 02:19:04.154104 (Thread-3): finished collecting timing info
2022-07-31 02:19:04.154277 (Thread-3): On model.fivetran_poc.my_second_dbt_model: Close
2022-07-31 02:19:04.304658 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0256c290-54ac-4ee6-b73b-6c2818a43f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e5583fd0>]}
2022-07-31 02:19:04.305128 (Thread-3): 21:19:04 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.95s]
2022-07-31 02:19:04.305280 (Thread-3): Finished running node model.fivetran_poc.my_second_dbt_model
2022-07-31 02:19:04.402519 (MainThread): Acquiring new snowflake connection "master".
2022-07-31 02:19:04.402991 (MainThread): Using snowflake connection "master".
2022-07-31 02:19:04.403170 (MainThread): On master: BEGIN
2022-07-31 02:19:04.403347 (MainThread): Opening a new connection, currently in state closed
2022-07-31 02:19:04.933938 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-07-31 02:19:04.934125 (MainThread): On master: COMMIT
2022-07-31 02:19:04.934257 (MainThread): Using snowflake connection "master".
2022-07-31 02:19:04.934330 (MainThread): On master: COMMIT
2022-07-31 02:19:05.091663 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2022-07-31 02:19:05.091848 (MainThread): On master: Close
2022-07-31 02:19:05.264468 (MainThread): 21:19:05 | 
2022-07-31 02:19:05.264773 (MainThread): 21:19:05 | Finished running 2 table models, 1 view model in 7.22s.
2022-07-31 02:19:05.264950 (MainThread): Connection 'master' was properly closed.
2022-07-31 02:19:05.265081 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-07-31 02:19:05.265202 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-07-31 02:19:05.265305 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-07-31 02:19:05.282682 (MainThread): 
2022-07-31 02:19:05.282951 (MainThread): Completed successfully
2022-07-31 02:19:05.283191 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-07-31 02:19:05.283477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4e6e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e5474f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e4fd4748>]}
2022-07-31 02:19:05.283732 (MainThread): Flushing usage events
2022-08-01 02:56:28.785041 (MainThread): Running with dbt=0.19.1
2022-08-01 02:56:32.343872 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 02:56:32.441966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 02:56:32.446101 (MainThread): Tracking: tracking
2022-08-01 02:56:32.446840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3556ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3556f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3556cc0>]}
2022-08-01 02:56:32.463726 (MainThread): Partial parsing not enabled
2022-08-01 02:56:32.470591 (MainThread): Parsing macros/catalog.sql
2022-08-01 02:56:32.481893 (MainThread): Parsing macros/adapters.sql
2022-08-01 02:56:32.525878 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 02:56:32.531509 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 02:56:32.536215 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 02:56:32.543081 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 02:56:32.562761 (MainThread): Parsing macros/core.sql
2022-08-01 02:56:32.569402 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 02:56:32.580497 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 02:56:32.585153 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 02:56:32.669795 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 02:56:32.714128 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 02:56:32.738228 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 02:56:32.743083 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 02:56:32.752287 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 02:56:32.768487 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 02:56:32.777673 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 02:56:32.788986 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 02:56:32.797086 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 02:56:32.800102 (MainThread): Parsing macros/etc/query.sql
2022-08-01 02:56:32.803130 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 02:56:32.806847 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 02:56:32.818209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 02:56:32.822601 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 02:56:32.827410 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 02:56:32.872093 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 02:56:32.876354 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 02:56:32.879814 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 02:56:32.883748 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 02:56:32.892239 (MainThread): Partial parsing not enabled
2022-08-01 02:56:32.921838 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:32.934187 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:32.937639 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:56:32.944080 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:33.023144 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 02:56:33.023700 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3947048>]}
2022-08-01 02:56:33.033875 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3928780>]}
2022-08-01 02:56:33.034198 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 02:56:33.035035 (MainThread): 
2022-08-01 02:56:33.035346 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 02:56:33.036263 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 02:56:33.048085 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 02:56:33.048223 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 02:56:33.048306 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 02:56:34.178255 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.13 seconds
2022-08-01 02:56:34.185227 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 02:56:34.305851 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 02:56:34.314436 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 02:56:34.314624 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 02:56:34.314733 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 02:56:34.818406 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.50 seconds
2022-08-01 02:56:34.820480 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 02:56:34.932453 (MainThread): Using snowflake connection "master".
2022-08-01 02:56:34.932612 (MainThread): On master: BEGIN
2022-08-01 02:56:34.932699 (MainThread): Opening a new connection, currently in state init
2022-08-01 02:56:35.445976 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-08-01 02:56:35.446516 (MainThread): On master: COMMIT
2022-08-01 02:56:35.446844 (MainThread): Using snowflake connection "master".
2022-08-01 02:56:35.447013 (MainThread): On master: COMMIT
2022-08-01 02:56:35.590648 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 02:56:35.591112 (MainThread): On master: Close
2022-08-01 02:56:35.746056 (MainThread): 21:56:35 | Concurrency: 8 threads (target='dev')
2022-08-01 02:56:35.746319 (MainThread): 21:56:35 | 
2022-08-01 02:56:35.748504 (Thread-2): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 02:56:35.748746 (Thread-3): Began running node model.fivetran_poc.candidates
2022-08-01 02:56:35.749054 (Thread-2): 21:56:35 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 02:56:35.749180 (Thread-1): Began running node model.fivetran_poc.events
2022-08-01 02:56:35.749475 (Thread-3): 21:56:35 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 02:56:35.749884 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:35.750109 (Thread-1): 21:56:35 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 02:56:35.750463 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:56:35.750625 (Thread-2): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 02:56:35.750916 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:35.751050 (Thread-3): Compiling model.fivetran_poc.candidates
2022-08-01 02:56:35.752475 (Thread-1): Compiling model.fivetran_poc.events
2022-08-01 02:56:35.754856 (Thread-2): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 02:56:35.761028 (Thread-3): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:56:35.765062 (Thread-1): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 02:56:35.765421 (Thread-3): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-08-01 02:56:35.765671 (Thread-3): Opening a new connection, currently in state init
2022-08-01 02:56:35.767338 (Thread-1): finished collecting timing info
2022-08-01 02:56:35.798813 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 02:56:35.799147 (Thread-2): finished collecting timing info
2022-08-01 02:56:35.800894 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 02:56:35.801764 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:35.801875 (Thread-1): On model.fivetran_poc.events: BEGIN
2022-08-01 02:56:35.801954 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 02:56:35.810287 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:35.810465 (Thread-2): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 02:56:35.810594 (Thread-2): Opening a new connection, currently in state init
2022-08-01 02:56:36.642814 (Thread-3): Snowflake query id: 01a5fcd0-0000-af89-0002-a3d600016072
2022-08-01 02:56:36.642960 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:56:36.646927 (Thread-3): finished collecting timing info
2022-08-01 02:56:36.647096 (Thread-3): On model.fivetran_poc.candidates: Close
2022-08-01 02:56:36.686560 (Thread-2): SQL status: SUCCESS 1 in 0.88 seconds
2022-08-01 02:56:36.686715 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:36.686784 (Thread-2): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 02:56:36.701387 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2022-08-01 02:56:36.701539 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:36.701615 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 02:56:36.722072 (Thread-3): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:56:36.772265 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3d067b8>]}
2022-08-01 02:56:36.772585 (Thread-3): 21:56:36 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.02s]
2022-08-01 02:56:36.772700 (Thread-3): Finished running node model.fivetran_poc.candidates
2022-08-01 02:56:37.405720 (Thread-2): SQL status: SUCCESS 1 in 0.72 seconds
2022-08-01 02:56:37.408014 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 02:56:37.408510 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:37.409647 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2022-08-01 02:56:37.409771 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 02:56:37.411097 (Thread-1): On model.fivetran_poc.events: COMMIT
2022-08-01 02:56:37.412567 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:37.412693 (Thread-1): On model.fivetran_poc.events: COMMIT
2022-08-01 02:56:37.493735 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 02:56:37.508930 (Thread-2): finished collecting timing info
2022-08-01 02:56:37.509338 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 02:56:37.509575 (Thread-2): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 02:56:37.510293 (Thread-1): finished collecting timing info
2022-08-01 02:56:37.510752 (Thread-1): On model.fivetran_poc.events: Close
2022-08-01 02:56:37.645046 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3d1aba8>]}
2022-08-01 02:56:37.645597 (Thread-2): 21:56:37 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.90s]
2022-08-01 02:56:37.645791 (Thread-2): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 02:56:37.647104 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 02:56:37.647403 (Thread-4): 21:56:37 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 02:56:37.647896 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:37.648063 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 02:56:37.651503 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 02:56:37.652291 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3d0ceb8>]}
2022-08-01 02:56:37.652630 (Thread-1): 21:56:37 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 1.90s]
2022-08-01 02:56:37.652825 (Thread-1): Finished running node model.fivetran_poc.events
2022-08-01 02:56:37.656236 (Thread-4): finished collecting timing info
2022-08-01 02:56:37.676524 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 02:56:37.679971 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:37.680108 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 02:56:37.680193 (Thread-4): Opening a new connection, currently in state init
2022-08-01 02:56:38.213280 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 02:56:38.213431 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:38.213500 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 02:56:38.477160 (Thread-4): SQL status: SUCCESS 1 in 0.26 seconds
2022-08-01 02:56:38.479175 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 02:56:38.479444 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:38.479598 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 02:56:38.562532 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 02:56:38.564157 (Thread-4): finished collecting timing info
2022-08-01 02:56:38.564423 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 02:56:38.712311 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73b9d18d-b596-4705-b995-6ff0ae2c20a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3d0aa20>]}
2022-08-01 02:56:38.712822 (Thread-4): 21:56:38 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.06s]
2022-08-01 02:56:38.713037 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 02:56:38.752768 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 02:56:38.753100 (MainThread): Using snowflake connection "master".
2022-08-01 02:56:38.753224 (MainThread): On master: BEGIN
2022-08-01 02:56:38.753337 (MainThread): Opening a new connection, currently in state closed
2022-08-01 02:56:39.296698 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 02:56:39.297006 (MainThread): On master: COMMIT
2022-08-01 02:56:39.297264 (MainThread): Using snowflake connection "master".
2022-08-01 02:56:39.297413 (MainThread): On master: COMMIT
2022-08-01 02:56:39.434340 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 02:56:39.434659 (MainThread): On master: Close
2022-08-01 02:56:39.564300 (MainThread): 21:56:39 | 
2022-08-01 02:56:39.564556 (MainThread): 21:56:39 | Finished running 3 table models, 1 view model in 6.53s.
2022-08-01 02:56:39.564761 (MainThread): Connection 'master' was properly closed.
2022-08-01 02:56:39.564882 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 02:56:39.564980 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 02:56:39.565086 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 02:56:39.565178 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 02:56:39.580449 (MainThread): 
2022-08-01 02:56:39.580757 (MainThread): Completed with 1 error and 0 warnings:
2022-08-01 02:56:39.580963 (MainThread): 
2022-08-01 02:56:39.581197 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 02:56:39.581438 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 02:56:39.581598 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-08-01 02:56:39.581751 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:56:39.581926 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-08-01 02:56:39.582212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3cd01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca3ce2e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca38052b0>]}
2022-08-01 02:56:39.582573 (MainThread): Flushing usage events
2022-08-01 02:56:56.213472 (MainThread): Running with dbt=0.19.1
2022-08-01 02:56:57.324798 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 02:56:57.401886 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 02:56:57.407597 (MainThread): Tracking: tracking
2022-08-01 02:56:57.408883 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908156f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907b7bbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908158fba8>]}
2022-08-01 02:56:57.424002 (MainThread): Partial parsing not enabled
2022-08-01 02:56:57.425722 (MainThread): Parsing macros/catalog.sql
2022-08-01 02:56:57.428569 (MainThread): Parsing macros/adapters.sql
2022-08-01 02:56:57.462163 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 02:56:57.464617 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 02:56:57.466579 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 02:56:57.471170 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 02:56:57.483784 (MainThread): Parsing macros/core.sql
2022-08-01 02:56:57.488465 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 02:56:57.497969 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 02:56:57.501476 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 02:56:57.612500 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 02:56:57.653750 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 02:56:57.675476 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 02:56:57.677910 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 02:56:57.685068 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 02:56:57.699836 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 02:56:57.707670 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 02:56:57.714396 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 02:56:57.720087 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 02:56:57.721547 (MainThread): Parsing macros/etc/query.sql
2022-08-01 02:56:57.723005 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 02:56:57.725052 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 02:56:57.734227 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 02:56:57.737126 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 02:56:57.739440 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 02:56:57.782096 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 02:56:57.784564 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 02:56:57.786849 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 02:56:57.789202 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 02:56:57.797205 (MainThread): Partial parsing not enabled
2022-08-01 02:56:57.819556 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:56:57.830298 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:56:57.834247 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:56:57.841781 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 02:56:57.915697 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 02:56:57.916286 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908182fb00>]}
2022-08-01 02:56:57.926898 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908182fcf8>]}
2022-08-01 02:56:57.927169 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 02:56:57.927900 (MainThread): 
2022-08-01 02:56:57.928198 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 02:56:57.929112 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 02:56:57.940984 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 02:56:57.941151 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 02:56:57.941231 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 02:56:58.899024 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.96 seconds
2022-08-01 02:56:58.905026 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 02:56:59.079098 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 02:56:59.087780 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 02:56:59.087955 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 02:56:59.088063 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 02:56:59.598549 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.51 seconds
2022-08-01 02:56:59.612683 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 02:56:59.795788 (MainThread): Using snowflake connection "master".
2022-08-01 02:56:59.796012 (MainThread): On master: BEGIN
2022-08-01 02:56:59.796142 (MainThread): Opening a new connection, currently in state init
2022-08-01 02:57:00.345389 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 02:57:00.345734 (MainThread): On master: COMMIT
2022-08-01 02:57:00.346013 (MainThread): Using snowflake connection "master".
2022-08-01 02:57:00.346175 (MainThread): On master: COMMIT
2022-08-01 02:57:00.525316 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-08-01 02:57:00.525559 (MainThread): On master: Close
2022-08-01 02:57:00.658940 (MainThread): 21:57:00 | Concurrency: 8 threads (target='dev')
2022-08-01 02:57:00.659199 (MainThread): 21:57:00 | 
2022-08-01 02:57:00.660931 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 02:57:00.661121 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 02:57:00.661268 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 02:57:00.661602 (Thread-1): 21:57:00 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 02:57:00.661862 (Thread-2): 21:57:00 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 02:57:00.662110 (Thread-3): 21:57:00 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 02:57:00.662560 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:57:00.662845 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:57:00.663164 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 02:57:00.663238 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 02:57:00.663369 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 02:57:00.666988 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 02:57:00.667234 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 02:57:00.673781 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 02:57:00.678017 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 02:57:00.678258 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-08-01 02:57:00.678515 (Thread-1): finished collecting timing info
2022-08-01 02:57:00.678653 (Thread-2): Opening a new connection, currently in state init
2022-08-01 02:57:00.718354 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 02:57:00.719260 (Thread-3): finished collecting timing info
2022-08-01 02:57:00.721995 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 02:57:00.724988 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:57:00.725333 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 02:57:00.725583 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 02:57:00.739652 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:57:00.740483 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 02:57:00.740683 (Thread-3): Opening a new connection, currently in state init
2022-08-01 02:57:01.690528 (Thread-2): Snowflake query id: 01a5fcd1-0000-af49-0002-a3d600014636
2022-08-01 02:57:01.690674 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:57:01.692504 (Thread-2): finished collecting timing info
2022-08-01 02:57:01.692646 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 02:57:01.765840 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:57:01.779092 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90816c8160>]}
2022-08-01 02:57:01.779398 (Thread-2): 21:57:01 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.12s]
2022-08-01 02:57:01.779511 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 02:57:01.927814 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2022-08-01 02:57:01.927962 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:57:01.928033 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 02:57:01.959506 (Thread-3): SQL status: SUCCESS 1 in 1.22 seconds
2022-08-01 02:57:01.959641 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:57:01.959714 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 02:57:02.482814 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 02:57:02.483917 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 02:57:02.484053 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 02:57:02.484123 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 02:57:02.561863 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 02:57:02.570546 (Thread-1): finished collecting timing info
2022-08-01 02:57:02.570693 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 02:57:02.693676 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9081b8bd68>]}
2022-08-01 02:57:02.694015 (Thread-1): 21:57:02 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.03s]
2022-08-01 02:57:02.694133 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 02:57:02.694554 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 02:57:02.694737 (Thread-4): 21:57:02 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 02:57:02.694973 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:57:02.695068 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 02:57:02.697464 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 02:57:02.698046 (Thread-4): finished collecting timing info
2022-08-01 02:57:02.714606 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 02:57:02.715901 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:57:02.716033 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 02:57:02.716121 (Thread-4): Opening a new connection, currently in state init
2022-08-01 02:57:03.187848 (Thread-3): SQL status: SUCCESS 1 in 1.23 seconds
2022-08-01 02:57:03.188840 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 02:57:03.188973 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 02:57:03.189043 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 02:57:03.240371 (Thread-4): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 02:57:03.240511 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:57:03.240584 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 02:57:03.274940 (Thread-3): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 02:57:03.275621 (Thread-3): finished collecting timing info
2022-08-01 02:57:03.275745 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 02:57:03.393889 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9081b8b668>]}
2022-08-01 02:57:03.394378 (Thread-3): 21:57:03 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 2.73s]
2022-08-01 02:57:03.394504 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 02:57:03.438291 (Thread-4): SQL status: SUCCESS 1 in 0.20 seconds
2022-08-01 02:57:03.439219 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 02:57:03.439348 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 02:57:03.439451 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 02:57:03.525584 (Thread-4): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 02:57:03.526314 (Thread-4): finished collecting timing info
2022-08-01 02:57:03.526443 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 02:57:03.646683 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9f4cdf-b76f-4260-a76b-d3701fc7e7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9081c06128>]}
2022-08-01 02:57:03.647044 (Thread-4): 21:57:03 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.95s]
2022-08-01 02:57:03.647178 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 02:57:03.651553 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 02:57:03.651745 (MainThread): Using snowflake connection "master".
2022-08-01 02:57:03.651820 (MainThread): On master: BEGIN
2022-08-01 02:57:03.651889 (MainThread): Opening a new connection, currently in state closed
2022-08-01 02:57:04.185736 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 02:57:04.186200 (MainThread): On master: COMMIT
2022-08-01 02:57:04.186571 (MainThread): Using snowflake connection "master".
2022-08-01 02:57:04.186728 (MainThread): On master: COMMIT
2022-08-01 02:57:04.369659 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2022-08-01 02:57:04.370117 (MainThread): On master: Close
2022-08-01 02:57:04.504727 (MainThread): 21:57:04 | 
2022-08-01 02:57:04.505031 (MainThread): 21:57:04 | Finished running 3 table models, 1 view model in 6.58s.
2022-08-01 02:57:04.505213 (MainThread): Connection 'master' was properly closed.
2022-08-01 02:57:04.505327 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 02:57:04.505427 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 02:57:04.505526 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 02:57:04.505619 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 02:57:04.511303 (MainThread): 
2022-08-01 02:57:04.511481 (MainThread): Completed with 1 error and 0 warnings:
2022-08-01 02:57:04.511620 (MainThread): 
2022-08-01 02:57:04.511759 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 02:57:04.511883 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 02:57:04.511994 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-08-01 02:57:04.512191 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 02:57:04.512309 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-08-01 02:57:04.512568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90816d04a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9081e47470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9081b687b8>]}
2022-08-01 02:57:04.512828 (MainThread): Flushing usage events
2022-08-01 03:06:05.965687 (MainThread): Running with dbt=0.19.1
2022-08-01 03:06:07.221326 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:06:07.294232 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:06:07.299067 (MainThread): Tracking: tracking
2022-08-01 03:06:07.299867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e3567400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de913e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e3581ba8>]}
2022-08-01 03:06:07.315328 (MainThread): Partial parsing not enabled
2022-08-01 03:06:07.317125 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:06:07.320205 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:06:07.353498 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:06:07.356105 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:06:07.358559 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:06:07.363603 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:06:07.376414 (MainThread): Parsing macros/core.sql
2022-08-01 03:06:07.381466 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:06:07.391226 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:06:07.393488 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:06:07.499296 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:06:07.540227 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:06:07.563280 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:06:07.566165 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:06:07.573721 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:06:07.589262 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:06:07.596778 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:06:07.603518 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:06:07.609356 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:06:07.610866 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:06:07.612290 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:06:07.614281 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:06:07.623183 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:06:07.625750 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:06:07.627834 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:06:07.670303 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:06:07.672592 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:06:07.674698 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:06:07.677611 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:06:07.686718 (MainThread): Partial parsing not enabled
2022-08-01 03:06:07.710068 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:07.720793 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:07.724988 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:07.732263 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:07.810540 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:06:07.811166 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4103f60>]}
2022-08-01 03:06:07.828395 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e1819240>]}
2022-08-01 03:06:07.828757 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:06:07.829772 (MainThread): 
2022-08-01 03:06:07.830356 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:06:07.831723 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:06:07.845497 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:06:07.845683 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:06:07.845773 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:06:08.835006 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.99 seconds
2022-08-01 03:06:08.838577 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:06:08.958142 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:06:08.964052 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:06:08.964180 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:06:08.964255 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:06:09.709257 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.74 seconds
2022-08-01 03:06:09.711081 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:06:09.845900 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:09.846131 (MainThread): On master: BEGIN
2022-08-01 03:06:09.846261 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:06:10.369813 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 03:06:10.370133 (MainThread): On master: COMMIT
2022-08-01 03:06:10.370399 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:10.370556 (MainThread): On master: COMMIT
2022-08-01 03:06:10.509876 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:06:10.510341 (MainThread): On master: Close
2022-08-01 03:06:10.634437 (MainThread): 22:06:10 | Concurrency: 8 threads (target='dev')
2022-08-01 03:06:10.634718 (MainThread): 22:06:10 | 
2022-08-01 03:06:10.636908 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:10.637170 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 03:06:10.637499 (Thread-1): 22:06:10 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:06:10.637637 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 03:06:10.637921 (Thread-2): 22:06:10 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:06:10.638311 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:10.638556 (Thread-3): 22:06:10 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:06:10.638957 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:10.639089 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:10.639413 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:10.639550 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 03:06:10.643991 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:06:10.644144 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 03:06:10.650622 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:10.654580 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:06:10.654860 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-08-01 03:06:10.655004 (Thread-1): finished collecting timing info
2022-08-01 03:06:10.655247 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:06:10.687493 (Thread-3): finished collecting timing info
2022-08-01 03:06:10.690228 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:06:10.692009 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:06:10.694353 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:10.695407 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:10.695631 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 03:06:10.695783 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:06:10.695917 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:06:10.696020 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:06:11.572910 (Thread-2): Snowflake query id: 01a5fcda-0000-af89-0002-a3d6000160b2
2022-08-01 03:06:11.573080 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:11.575345 (Thread-2): finished collecting timing info
2022-08-01 03:06:11.575558 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 03:06:11.609310 (Thread-3): SQL status: SUCCESS 1 in 0.91 seconds
2022-08-01 03:06:11.609497 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:11.609574 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 03:06:11.612265 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2022-08-01 03:06:11.612396 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:11.612467 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:06:11.649934 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:11.663646 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e45a0a58>]}
2022-08-01 03:06:11.664020 (Thread-2): 22:06:11 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.02s]
2022-08-01 03:06:11.664147 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 03:06:12.183531 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2022-08-01 03:06:12.184662 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:06:12.184800 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:12.184871 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:06:12.208782 (Thread-3): SQL status: SUCCESS 1 in 0.60 seconds
2022-08-01 03:06:12.209881 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:06:12.210027 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:12.210101 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:06:12.256778 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:06:12.267776 (Thread-1): finished collecting timing info
2022-08-01 03:06:12.268033 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:06:12.316955 (Thread-3): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 03:06:12.318567 (Thread-3): finished collecting timing info
2022-08-01 03:06:12.321038 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 03:06:12.405749 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e45cda58>]}
2022-08-01 03:06:12.406340 (Thread-1): 22:06:12 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.77s]
2022-08-01 03:06:12.406530 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:12.407081 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:12.407417 (Thread-4): 22:06:12 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:06:12.407834 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:12.408004 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:12.411932 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:06:12.412959 (Thread-4): finished collecting timing info
2022-08-01 03:06:12.436972 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:06:12.439019 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:12.439204 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:06:12.439343 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:06:12.450745 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e45cd828>]}
2022-08-01 03:06:12.451527 (Thread-3): 22:06:12 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 1.81s]
2022-08-01 03:06:12.451758 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 03:06:12.945513 (Thread-4): SQL status: SUCCESS 1 in 0.51 seconds
2022-08-01 03:06:12.945697 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:12.945779 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:06:13.160336 (Thread-4): SQL status: SUCCESS 1 in 0.21 seconds
2022-08-01 03:06:13.161410 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:06:13.161555 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:13.161627 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:06:13.242628 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:06:13.243586 (Thread-4): finished collecting timing info
2022-08-01 03:06:13.243760 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:06:13.361388 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6796dae4-53f3-4ee2-92d9-f25bbe1c1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4856c88>]}
2022-08-01 03:06:13.361832 (Thread-4): 22:06:13 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.95s]
2022-08-01 03:06:13.361991 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:13.426149 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:06:13.426655 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:13.426833 (MainThread): On master: BEGIN
2022-08-01 03:06:13.426976 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:06:13.959125 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 03:06:13.959443 (MainThread): On master: COMMIT
2022-08-01 03:06:13.959705 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:13.959865 (MainThread): On master: COMMIT
2022-08-01 03:06:14.096118 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:06:14.096345 (MainThread): On master: Close
2022-08-01 03:06:14.214360 (MainThread): 22:06:14 | 
2022-08-01 03:06:14.214627 (MainThread): 22:06:14 | Finished running 3 table models, 1 view model in 6.38s.
2022-08-01 03:06:14.214806 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:06:14.214926 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:06:14.215037 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:06:14.215142 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:06:14.215249 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:06:14.228102 (MainThread): 
2022-08-01 03:06:14.228343 (MainThread): Completed with 1 error and 0 warnings:
2022-08-01 03:06:14.228499 (MainThread): 
2022-08-01 03:06:14.228648 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:06:14.228782 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:06:14.228902 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-08-01 03:06:14.229015 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:14.229150 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-08-01 03:06:14.229374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e37efb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e48113c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e45c49b0>]}
2022-08-01 03:06:14.229640 (MainThread): Flushing usage events
2022-08-01 03:06:50.491102 (MainThread): Running with dbt=0.19.1
2022-08-01 03:06:51.322286 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:06:51.383540 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:06:51.385797 (MainThread): Tracking: tracking
2022-08-01 03:06:51.386614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4c4fcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b0112e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4c79be0>]}
2022-08-01 03:06:51.400444 (MainThread): Partial parsing not enabled
2022-08-01 03:06:51.401844 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:06:51.404526 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:06:51.434255 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:06:51.436695 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:06:51.438461 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:06:51.442777 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:06:51.455202 (MainThread): Parsing macros/core.sql
2022-08-01 03:06:51.459355 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:06:51.468156 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:06:51.470186 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:06:51.555050 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:06:51.592116 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:06:51.613371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:06:51.615428 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:06:51.622068 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:06:51.636249 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:06:51.643386 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:06:51.649826 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:06:51.655259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:06:51.656465 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:06:51.657667 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:06:51.659437 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:06:51.667968 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:06:51.670193 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:06:51.671983 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:06:51.712799 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:06:51.714874 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:06:51.716907 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:06:51.718878 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:06:51.727260 (MainThread): Partial parsing not enabled
2022-08-01 03:06:51.748143 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:51.757575 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:51.760942 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:51.766979 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:51.836244 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:06:51.836754 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b502bb00>]}
2022-08-01 03:06:51.844201 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4c875f8>]}
2022-08-01 03:06:51.844445 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:06:51.845168 (MainThread): 
2022-08-01 03:06:51.845461 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:06:51.846331 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:06:51.858599 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:06:51.858732 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:06:51.858809 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:06:52.677824 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2022-08-01 03:06:52.681140 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:06:52.795451 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:06:52.802317 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:06:52.802458 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:06:52.802634 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:06:53.522146 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.72 seconds
2022-08-01 03:06:53.523941 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:06:53.643777 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:53.643985 (MainThread): On master: BEGIN
2022-08-01 03:06:53.644113 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:06:54.278664 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2022-08-01 03:06:54.279061 (MainThread): On master: COMMIT
2022-08-01 03:06:54.279316 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:54.279466 (MainThread): On master: COMMIT
2022-08-01 03:06:54.410910 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:06:54.411365 (MainThread): On master: Close
2022-08-01 03:06:54.541312 (MainThread): 22:06:54 | Concurrency: 8 threads (target='dev')
2022-08-01 03:06:54.541588 (MainThread): 22:06:54 | 
2022-08-01 03:06:54.543841 (Thread-2): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:54.544289 (Thread-2): 22:06:54 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:06:54.544474 (Thread-1): Began running node model.fivetran_poc.candidates
2022-08-01 03:06:54.544965 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:54.545109 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 03:06:54.545395 (Thread-1): 22:06:54 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:06:54.545549 (Thread-2): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:54.545742 (Thread-3): 22:06:54 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:06:54.546054 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:54.549578 (Thread-2): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:06:54.549783 (Thread-1): Compiling model.fivetran_poc.candidates
2022-08-01 03:06:54.550057 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:54.556501 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:06:54.556782 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 03:06:54.556952 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    select distinct TABLE_SCHEMA from information_schema.tables where table_schema ilike %POC%
2022-08-01 03:06:54.557066 (Thread-2): finished collecting timing info
2022-08-01 03:06:54.561057 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:06:54.561225 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:06:54.591290 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:06:54.592295 (Thread-3): finished collecting timing info
2022-08-01 03:06:54.594575 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:06:54.597287 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:54.598430 (Thread-2): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:06:54.598572 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:06:54.601159 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:54.601849 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 03:06:54.601991 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:06:55.484764 (Thread-2): SQL status: SUCCESS 1 in 0.89 seconds
2022-08-01 03:06:55.484918 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:55.484988 (Thread-2): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:06:55.518651 (Thread-1): Snowflake query id: 01a5fcda-0000-af89-0002-a3d6000160da
2022-08-01 03:06:55.518830 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:55.520146 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2022-08-01 03:06:55.521047 (Thread-1): finished collecting timing info
2022-08-01 03:06:55.521168 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:55.521380 (Thread-1): On model.fivetran_poc.candidates: Close
2022-08-01 03:06:55.521541 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 03:06:55.588980 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 85 unexpected '%'.
syntax error line 1 at position 90 unexpected '<EOF>'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 85 unexpected '%'.
  syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:55.595765 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b5491e10>]}
2022-08-01 03:06:55.596071 (Thread-1): 22:06:55 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.05s]
2022-08-01 03:06:55.596185 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-08-01 03:06:56.087352 (Thread-2): SQL status: SUCCESS 1 in 0.60 seconds
2022-08-01 03:06:56.088407 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:06:56.088536 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:06:56.088602 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:06:56.103046 (Thread-3): SQL status: SUCCESS 1 in 0.58 seconds
2022-08-01 03:06:56.104094 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:06:56.104250 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:06:56.104321 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:06:56.162146 (Thread-2): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:06:56.175070 (Thread-2): finished collecting timing info
2022-08-01 03:06:56.175329 (Thread-2): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:06:56.176575 (Thread-3): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:06:56.177319 (Thread-3): finished collecting timing info
2022-08-01 03:06:56.177525 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 03:06:56.311885 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b547eac8>]}
2022-08-01 03:06:56.312397 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b54c81d0>]}
2022-08-01 03:06:56.312920 (Thread-3): 22:06:56 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 1.76s]
2022-08-01 03:06:56.313291 (Thread-2): 22:06:56 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.77s]
2022-08-01 03:06:56.313634 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 03:06:56.313899 (Thread-2): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:06:56.314556 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:56.314809 (Thread-4): 22:06:56 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:06:56.315151 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:56.315280 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:56.317734 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:06:56.318658 (Thread-4): finished collecting timing info
2022-08-01 03:06:56.341901 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:06:56.343096 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:56.343232 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:06:56.343312 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:06:56.841724 (Thread-4): SQL status: SUCCESS 1 in 0.50 seconds
2022-08-01 03:06:56.841879 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:56.841953 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:06:57.065899 (Thread-4): SQL status: SUCCESS 1 in 0.22 seconds
2022-08-01 03:06:57.066846 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:06:57.066981 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:06:57.067049 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:06:57.143161 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:06:57.143955 (Thread-4): finished collecting timing info
2022-08-01 03:06:57.144097 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:06:57.258944 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb3775ff-259b-48f3-ae83-1f24c3e0a930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b5746ef0>]}
2022-08-01 03:06:57.259275 (Thread-4): 22:06:57 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.94s]
2022-08-01 03:06:57.259391 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:06:57.304864 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:06:57.305136 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:57.305226 (MainThread): On master: BEGIN
2022-08-01 03:06:57.305292 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:06:57.819930 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-08-01 03:06:57.820432 (MainThread): On master: COMMIT
2022-08-01 03:06:57.820736 (MainThread): Using snowflake connection "master".
2022-08-01 03:06:57.820961 (MainThread): On master: COMMIT
2022-08-01 03:06:57.949720 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:06:57.950183 (MainThread): On master: Close
2022-08-01 03:06:58.070149 (MainThread): 22:06:58 | 
2022-08-01 03:06:58.070451 (MainThread): 22:06:58 | Finished running 3 table models, 1 view model in 6.22s.
2022-08-01 03:06:58.070602 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:06:58.070706 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:06:58.070800 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:06:58.070889 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:06:58.070976 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:06:58.076673 (MainThread): 
2022-08-01 03:06:58.076841 (MainThread): Completed with 1 error and 0 warnings:
2022-08-01 03:06:58.076967 (MainThread): 
2022-08-01 03:06:58.077084 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:06:58.077187 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:06:58.077334 (MainThread):   syntax error line 1 at position 85 unexpected '%'.
2022-08-01 03:06:58.077478 (MainThread):   syntax error line 1 at position 90 unexpected '<EOF>'.
2022-08-01 03:06:58.077597 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-08-01 03:06:58.077780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4d94a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b4dab320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b54c81d0>]}
2022-08-01 03:06:58.078002 (MainThread): Flushing usage events
2022-08-01 03:26:49.007951 (MainThread): Running with dbt=0.19.1
2022-08-01 03:26:50.179800 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:26:50.241985 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:26:50.245942 (MainThread): Tracking: tracking
2022-08-01 03:26:50.246595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c32d80f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c32d80f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c32d80dd8>]}
2022-08-01 03:26:50.259726 (MainThread): Partial parsing not enabled
2022-08-01 03:26:50.261151 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:26:50.263669 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:26:50.293863 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:26:50.296185 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:26:50.297943 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:26:50.302071 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:26:50.315231 (MainThread): Parsing macros/core.sql
2022-08-01 03:26:50.319649 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:26:50.328894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:26:50.330836 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:26:50.414325 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:26:50.449266 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:26:50.470044 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:26:50.472288 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:26:50.478259 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:26:50.492494 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:26:50.499344 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:26:50.505751 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:26:50.510579 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:26:50.511794 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:26:50.513027 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:26:50.514985 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:26:50.524129 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:26:50.526336 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:26:50.528131 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:26:50.568321 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:26:50.570597 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:26:50.572233 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:26:50.573991 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:26:50.581481 (MainThread): Partial parsing not enabled
2022-08-01 03:26:50.601589 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:26:50.610155 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:26:50.613555 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:50.619268 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:26:50.694076 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:26:50.694624 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c338470b8>]}
2022-08-01 03:26:50.708470 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c338267b8>]}
2022-08-01 03:26:50.708752 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:26:50.709578 (MainThread): 
2022-08-01 03:26:50.709894 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:26:50.710893 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:26:50.722737 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:26:50.722874 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:26:50.722951 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:26:51.580205 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2022-08-01 03:26:51.585826 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:26:51.725816 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:26:51.734858 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:26:51.735021 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:26:51.735127 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:26:52.531602 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.80 seconds
2022-08-01 03:26:52.533440 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:26:52.666895 (MainThread): Using snowflake connection "master".
2022-08-01 03:26:52.667101 (MainThread): On master: BEGIN
2022-08-01 03:26:52.667224 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:26:53.202277 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 03:26:53.202735 (MainThread): On master: COMMIT
2022-08-01 03:26:53.203117 (MainThread): Using snowflake connection "master".
2022-08-01 03:26:53.203271 (MainThread): On master: COMMIT
2022-08-01 03:26:53.341120 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:26:53.341571 (MainThread): On master: Close
2022-08-01 03:26:53.459183 (MainThread): 22:26:53 | Concurrency: 8 threads (target='dev')
2022-08-01 03:26:53.459465 (MainThread): 22:26:53 | 
2022-08-01 03:26:53.472432 (Thread-2): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:26:53.472661 (Thread-1): Began running node model.fivetran_poc.candidates
2022-08-01 03:26:53.472842 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 03:26:53.473125 (Thread-2): 22:26:53 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:26:53.473364 (Thread-1): 22:26:53 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:26:53.473571 (Thread-3): 22:26:53 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:26:53.474345 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:26:53.474515 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:53.474899 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:26:53.475042 (Thread-2): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:26:53.475180 (Thread-1): Compiling model.fivetran_poc.candidates
2022-08-01 03:26:53.475293 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 03:26:53.479095 (Thread-2): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:26:53.491245 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:26:53.493412 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:53.504525 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:26:53.505051 (Thread-2): finished collecting timing info
2022-08-01 03:26:53.505371 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:26:53.519047 (Thread-3): finished collecting timing info
2022-08-01 03:26:53.552452 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:26:53.558779 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:26:53.560738 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:26:53.561032 (Thread-2): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:26:53.561216 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:26:53.562684 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:26:53.563532 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 03:26:53.563740 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:26:54.442391 (Thread-2): SQL status: SUCCESS 1 in 0.88 seconds
2022-08-01 03:26:54.442552 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:26:54.442628 (Thread-2): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:26:54.488702 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2022-08-01 03:26:54.488881 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:26:54.488956 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (

with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 03:26:55.511301 (Thread-2): SQL status: SUCCESS 1 in 1.07 seconds
2022-08-01 03:26:55.513468 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:26:55.514331 (Thread-1): SQL status: SUCCESS 0 in 2.01 seconds
2022-08-01 03:26:55.514594 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:26:55.515485 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:26:55.515732 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:26:55.521853 (Thread-1): finished collecting timing info
2022-08-01 03:26:55.524300 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:26:55.530066 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:55.530221 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-08-01 03:26:55.597280 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:26:55.607642 (Thread-2): finished collecting timing info
2022-08-01 03:26:55.607824 (Thread-2): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:26:55.626795 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 03:26:55.626943 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:55.627018 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (





/**/


with source_data as (
    
    select * , 'poc_client_1_public' as client_name
    from FIVETRAN_DATABASE.poc_client_1_public.candidates
    union all
    
    select * , 'poc_client_2_public' as client_name
    from FIVETRAN_DATABASE.poc_client_2_public.candidates
    
    
)
select *
from source_data
      );
2022-08-01 03:26:55.652678 (Thread-3): SQL status: SUCCESS 1 in 1.16 seconds
2022-08-01 03:26:55.653714 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:26:55.653933 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:26:55.654029 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 03:26:55.720993 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33d46be0>]}
2022-08-01 03:26:55.721371 (Thread-2): 22:26:55 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.25s]
2022-08-01 03:26:55.721494 (Thread-2): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:26:55.721989 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:26:55.722233 (Thread-4): 22:26:55 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:26:55.722508 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:26:55.722601 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:26:55.724407 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:26:55.725215 (Thread-4): finished collecting timing info
2022-08-01 03:26:55.741866 (Thread-3): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 03:26:55.742197 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:26:55.742798 (Thread-3): finished collecting timing info
2022-08-01 03:26:55.743275 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 03:26:55.744881 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:26:55.745196 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:26:55.745445 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:26:55.859535 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33d1eeb8>]}
2022-08-01 03:26:55.859893 (Thread-3): 22:26:55 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 2.38s]
2022-08-01 03:26:55.860013 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 03:26:56.229094 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2022-08-01 03:26:56.231085 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2022-08-01 03:26:56.231169 (Thread-1): On model.fivetran_poc.candidates: COMMIT
2022-08-01 03:26:56.231316 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:26:56.231498 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:26:56.231622 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:26:56.231727 (Thread-1): On model.fivetran_poc.candidates: COMMIT
2022-08-01 03:26:56.313132 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:26:56.313896 (Thread-1): finished collecting timing info
2022-08-01 03:26:56.314048 (Thread-1): On model.fivetran_poc.candidates: Close
2022-08-01 03:26:56.432338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33d0f588>]}
2022-08-01 03:26:56.432851 (Thread-1): 22:26:56 | 2 of 4 OK created table model PUBLIC.candidates...................... [SUCCESS 1 in 2.96s]
2022-08-01 03:26:56.432986 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-08-01 03:26:56.458274 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2022-08-01 03:26:56.459197 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:26:56.459331 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:26:56.459398 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:26:56.530220 (Thread-4): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:26:56.530911 (Thread-4): finished collecting timing info
2022-08-01 03:26:56.531038 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:26:56.649622 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330b64fb-1934-40ab-bef5-cb4b23bf6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33e38320>]}
2022-08-01 03:26:56.650043 (Thread-4): 22:26:56 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.93s]
2022-08-01 03:26:56.650168 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:26:56.664905 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:26:56.665141 (MainThread): Using snowflake connection "master".
2022-08-01 03:26:56.665216 (MainThread): On master: BEGIN
2022-08-01 03:26:56.665285 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:26:57.157798 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-08-01 03:26:57.158117 (MainThread): On master: COMMIT
2022-08-01 03:26:57.158379 (MainThread): Using snowflake connection "master".
2022-08-01 03:26:57.158531 (MainThread): On master: COMMIT
2022-08-01 03:26:57.285854 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:26:57.286335 (MainThread): On master: Close
2022-08-01 03:26:57.422126 (MainThread): 22:26:57 | 
2022-08-01 03:26:57.422555 (MainThread): 22:26:57 | Finished running 3 table models, 1 view model in 6.71s.
2022-08-01 03:26:57.422930 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:26:57.423164 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:26:57.423335 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:26:57.423530 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:26:57.423734 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:26:57.437191 (MainThread): 
2022-08-01 03:26:57.437399 (MainThread): Completed successfully
2022-08-01 03:26:57.437548 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-08-01 03:26:57.437795 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c32dca080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c32ed0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c33d0f0b8>]}
2022-08-01 03:26:57.438025 (MainThread): Flushing usage events
2022-08-01 03:27:46.260120 (MainThread): Running with dbt=0.19.1
2022-08-01 03:27:47.146945 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:27:47.211495 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:27:47.214994 (MainThread): Tracking: tracking
2022-08-01 03:27:47.215754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576da71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5720d3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576ddc780>]}
2022-08-01 03:27:47.229621 (MainThread): Partial parsing not enabled
2022-08-01 03:27:47.231284 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:27:47.233900 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:27:47.265259 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:27:47.267589 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:27:47.269398 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:27:47.273654 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:27:47.286035 (MainThread): Parsing macros/core.sql
2022-08-01 03:27:47.290528 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:27:47.299777 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:27:47.301781 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:27:47.405512 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:27:47.445582 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:27:47.467005 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:27:47.469100 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:27:47.475472 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:27:47.490264 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:27:47.497275 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:27:47.503747 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:27:47.508789 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:27:47.509918 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:27:47.511114 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:27:47.512901 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:27:47.522248 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:27:47.524539 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:27:47.526462 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:27:47.566692 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:27:47.568781 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:27:47.570703 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:27:47.572664 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:27:47.580598 (MainThread): Partial parsing not enabled
2022-08-01 03:27:47.602151 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:27:47.612301 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:27:47.615626 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:27:47.622523 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:27:47.693597 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:27:47.694213 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd577041f60>]}
2022-08-01 03:27:47.701906 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57703ae10>]}
2022-08-01 03:27:47.702206 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:27:47.702961 (MainThread): 
2022-08-01 03:27:47.703262 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:27:47.704211 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:27:47.715672 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:27:47.715794 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:27:47.715874 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:27:48.522736 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.81 seconds
2022-08-01 03:27:48.526857 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:27:48.645569 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:27:48.654807 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:27:48.655022 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:27:48.655131 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:27:49.161381 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.51 seconds
2022-08-01 03:27:49.163162 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:27:49.284766 (MainThread): Using snowflake connection "master".
2022-08-01 03:27:49.284999 (MainThread): On master: BEGIN
2022-08-01 03:27:49.285127 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:27:50.037962 (MainThread): SQL status: SUCCESS 1 in 0.75 seconds
2022-08-01 03:27:50.038408 (MainThread): On master: COMMIT
2022-08-01 03:27:50.038676 (MainThread): Using snowflake connection "master".
2022-08-01 03:27:50.038831 (MainThread): On master: COMMIT
2022-08-01 03:27:50.173756 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:27:50.174254 (MainThread): On master: Close
2022-08-01 03:27:50.299316 (MainThread): 22:27:50 | Concurrency: 8 threads (target='dev')
2022-08-01 03:27:50.299580 (MainThread): 22:27:50 | 
2022-08-01 03:27:50.301317 (Thread-3): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:27:50.301557 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 03:27:50.301853 (Thread-3): 22:27:50 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:27:50.301962 (Thread-1): Began running node model.fivetran_poc.events
2022-08-01 03:27:50.302204 (Thread-2): 22:27:50 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:27:50.302763 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:27:50.303057 (Thread-1): 22:27:50 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:27:50.303476 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:27:50.303710 (Thread-3): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:27:50.304111 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:27:50.304231 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 03:27:50.308612 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:27:50.308822 (Thread-1): Compiling model.fivetran_poc.events
2022-08-01 03:27:50.317376 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:27:50.325435 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:27:50.325843 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:27:50.326033 (Thread-3): finished collecting timing info
2022-08-01 03:27:50.326157 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:27:50.326289 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:27:50.350232 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:27:50.372784 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:27:50.377914 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:27:50.378362 (Thread-3): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:27:50.378483 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:27:51.292612 (Thread-3): SQL status: SUCCESS 1 in 0.91 seconds
2022-08-01 03:27:51.292796 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:27:51.292873 (Thread-3): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:27:51.657932 (Thread-1): SQL status: SUCCESS 0 in 1.31 seconds
2022-08-01 03:27:51.658554 (Thread-1): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:27:51.661200 (Thread-1): finished collecting timing info
2022-08-01 03:27:51.662997 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:27:51.665476 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:27:51.665588 (Thread-1): On model.fivetran_poc.events: BEGIN
2022-08-01 03:27:51.780323 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 03:27:51.780557 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:27:51.780646 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:27:51.858539 (Thread-1): Snowflake query id: 01a5fcef-0000-af49-0002-a3d6000146be
2022-08-01 03:27:51.858759 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:27:51.858916 (Thread-1): finished collecting timing info
2022-08-01 03:27:51.859066 (Thread-1): On model.fivetran_poc.events: ROLLBACK
2022-08-01 03:27:51.968176 (Thread-2): SQL status: SUCCESS 0 in 1.64 seconds
2022-08-01 03:27:51.968756 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:27:51.969630 (Thread-2): finished collecting timing info
2022-08-01 03:27:51.972496 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:27:51.973952 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:27:51.974113 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 03:27:51.994586 (Thread-1): On model.fivetran_poc.events: Close
2022-08-01 03:27:52.042688 (Thread-3): SQL status: SUCCESS 1 in 0.75 seconds
2022-08-01 03:27:52.046567 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:27:52.046985 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:27:52.047525 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:27:52.073605 (Thread-2): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 03:27:52.073823 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:27:52.073938 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:27:52.124570 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:27:52.133318 (Thread-3): finished collecting timing info
2022-08-01 03:27:52.133466 (Thread-3): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:27:52.132494 (Thread-1): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:27:52.141348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5773f2400>]}
2022-08-01 03:27:52.141640 (Thread-1): 22:27:52 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 1.84s]
2022-08-01 03:27:52.141756 (Thread-1): Finished running node model.fivetran_poc.events
2022-08-01 03:27:52.156299 (Thread-2): Snowflake query id: 01a5fcef-0000-af89-0002-a3d600016136
2022-08-01 03:27:52.156420 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:27:52.156533 (Thread-2): finished collecting timing info
2022-08-01 03:27:52.156647 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 03:27:52.277653 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 03:27:52.294055 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5775f0d30>]}
2022-08-01 03:27:52.294429 (Thread-3): 22:27:52 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.99s]
2022-08-01 03:27:52.294561 (Thread-3): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:27:52.295060 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:27:52.295359 (Thread-4): 22:27:52 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:27:52.295618 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:27:52.295716 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:27:52.297586 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:27:52.298276 (Thread-4): finished collecting timing info
2022-08-01 03:27:52.314139 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:27:52.315173 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:27:52.315262 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:27:52.315334 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:27:52.399554 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:27:52.400155 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd577623630>]}
2022-08-01 03:27:52.400424 (Thread-2): 22:27:52 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 2.10s]
2022-08-01 03:27:52.400534 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 03:27:52.804441 (Thread-4): SQL status: SUCCESS 1 in 0.49 seconds
2022-08-01 03:27:52.804593 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:27:52.804666 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:27:53.013559 (Thread-4): SQL status: SUCCESS 1 in 0.21 seconds
2022-08-01 03:27:53.014818 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:27:53.014986 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:27:53.015055 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:27:53.087987 (Thread-4): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:27:53.088656 (Thread-4): finished collecting timing info
2022-08-01 03:27:53.088821 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:27:53.201403 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b850b42d-723f-442f-8ed8-192b973fcb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57761d978>]}
2022-08-01 03:27:53.201794 (Thread-4): 22:27:53 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.91s]
2022-08-01 03:27:53.201960 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:27:53.294754 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:27:53.294994 (MainThread): Using snowflake connection "master".
2022-08-01 03:27:53.295066 (MainThread): On master: BEGIN
2022-08-01 03:27:53.295130 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:27:53.818700 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 03:27:53.818863 (MainThread): On master: COMMIT
2022-08-01 03:27:53.818981 (MainThread): Using snowflake connection "master".
2022-08-01 03:27:53.819045 (MainThread): On master: COMMIT
2022-08-01 03:27:53.955935 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:27:53.956150 (MainThread): On master: Close
2022-08-01 03:27:54.082951 (MainThread): 22:27:54 | 
2022-08-01 03:27:54.083121 (MainThread): 22:27:54 | Finished running 3 table models, 1 view model in 6.38s.
2022-08-01 03:27:54.083211 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:27:54.083271 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:27:54.083324 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:27:54.083375 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:27:54.083424 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:27:54.087631 (MainThread): 
2022-08-01 03:27:54.087791 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 03:27:54.087880 (MainThread): 
2022-08-01 03:27:54.087964 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 03:27:54.088037 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:27:54.088107 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:27:54.088174 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:27:54.088241 (MainThread): 
2022-08-01 03:27:54.088316 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:27:54.088382 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:27:54.088441 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:27:54.088500 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:27:54.088572 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 03:27:54.088708 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5750d6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd577005da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57704f470>]}
2022-08-01 03:27:54.088869 (MainThread): Flushing usage events
2022-08-01 03:28:44.142953 (MainThread): Running with dbt=0.19.1
2022-08-01 03:28:44.990209 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:28:45.052121 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:28:45.056088 (MainThread): Tracking: tracking
2022-08-01 03:28:45.057362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec99d71f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec99d71ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec99d71cf8>]}
2022-08-01 03:28:45.069764 (MainThread): Partial parsing not enabled
2022-08-01 03:28:45.071239 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:28:45.073796 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:28:45.106055 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:28:45.108507 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:28:45.110257 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:28:45.114875 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:28:45.126656 (MainThread): Parsing macros/core.sql
2022-08-01 03:28:45.130681 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:28:45.139410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:28:45.142145 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:28:45.215874 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:28:45.250264 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:28:45.271473 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:28:45.273551 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:28:45.280275 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:28:45.294334 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:28:45.300987 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:28:45.307436 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:28:45.312751 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:28:45.313920 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:28:45.315164 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:28:45.316914 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:28:45.325758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:28:45.327884 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:28:45.329695 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:28:45.372093 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:28:45.374748 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:28:45.376740 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:28:45.378601 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:28:45.386543 (MainThread): Partial parsing not enabled
2022-08-01 03:28:45.407415 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:28:45.417059 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:28:45.420293 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:28:45.426296 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:28:45.497001 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:28:45.497549 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a00a0f0>]}
2022-08-01 03:28:45.505835 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a005eb8>]}
2022-08-01 03:28:45.506073 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:28:45.506863 (MainThread): 
2022-08-01 03:28:45.507169 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:28:45.508168 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:28:45.521174 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:28:45.521304 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:28:45.521387 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:28:46.391215 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.87 seconds
2022-08-01 03:28:46.396152 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:28:46.522580 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:28:46.530763 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:28:46.530925 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:28:46.531029 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:28:47.039791 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.51 seconds
2022-08-01 03:28:47.041988 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:28:47.161335 (MainThread): Using snowflake connection "master".
2022-08-01 03:28:47.161538 (MainThread): On master: BEGIN
2022-08-01 03:28:47.161664 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:28:47.835965 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2022-08-01 03:28:47.836426 (MainThread): On master: COMMIT
2022-08-01 03:28:47.836770 (MainThread): Using snowflake connection "master".
2022-08-01 03:28:47.836924 (MainThread): On master: COMMIT
2022-08-01 03:28:47.978872 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:28:47.979344 (MainThread): On master: Close
2022-08-01 03:28:48.105262 (MainThread): 22:28:48 | Concurrency: 8 threads (target='dev')
2022-08-01 03:28:48.105524 (MainThread): 22:28:48 | 
2022-08-01 03:28:48.107878 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:28:48.108125 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 03:28:48.108291 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 03:28:48.108678 (Thread-1): 22:28:48 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:28:48.108921 (Thread-2): 22:28:48 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:28:48.109176 (Thread-3): 22:28:48 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:28:48.109572 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:28:48.110006 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:28:48.110356 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:28:48.110535 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:28:48.110694 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 03:28:48.110851 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 03:28:48.118389 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:28:48.125722 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:28:48.123726 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:28:48.125918 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:28:48.126200 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:28:48.126312 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:28:48.126399 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:28:48.129127 (Thread-1): finished collecting timing info
2022-08-01 03:28:48.159872 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:28:48.161163 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:28:48.161257 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:28:48.161332 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:28:49.083448 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2022-08-01 03:28:49.083679 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:28:49.083751 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:28:49.477877 (Thread-3): SQL status: SUCCESS 0 in 1.35 seconds
2022-08-01 03:28:49.478314 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:28:49.479004 (Thread-3): finished collecting timing info
2022-08-01 03:28:49.480625 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:28:49.481470 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:28:49.481558 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 03:28:49.517202 (Thread-2): SQL status: SUCCESS 0 in 1.39 seconds
2022-08-01 03:28:49.517751 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:28:49.519943 (Thread-2): finished collecting timing info
2022-08-01 03:28:49.521876 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:28:49.524184 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:28:49.524289 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 03:28:49.581443 (Thread-3): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 03:28:49.581608 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:28:49.581681 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:28:49.610266 (Thread-2): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 03:28:49.610475 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:28:49.610576 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:28:49.666437 (Thread-3): Snowflake query id: 01a5fcf0-0000-af49-0002-a3d6000146e2
2022-08-01 03:28:49.666578 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:28:49.666729 (Thread-3): finished collecting timing info
2022-08-01 03:28:49.666856 (Thread-3): On model.fivetran_poc.events: ROLLBACK
2022-08-01 03:28:49.693259 (Thread-2): Snowflake query id: 01a5fcf0-0000-af89-0002-a3d600016162
2022-08-01 03:28:49.693458 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:28:49.693653 (Thread-2): finished collecting timing info
2022-08-01 03:28:49.693831 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 03:28:49.787189 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 03:28:49.810303 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 03:28:49.879712 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2022-08-01 03:28:49.880729 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:28:49.880863 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:28:49.880931 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:28:49.900316 (Thread-3): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:28:49.905691 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a739780>]}
2022-08-01 03:28:49.906076 (Thread-3): 22:28:49 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 1.80s]
2022-08-01 03:28:49.906217 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 03:28:49.923933 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:28:49.924627 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a0bb4e0>]}
2022-08-01 03:28:49.924923 (Thread-2): 22:28:49 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.81s]
2022-08-01 03:28:49.925040 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 03:28:49.956249 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:28:49.965649 (Thread-1): finished collecting timing info
2022-08-01 03:28:49.965955 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:28:50.080997 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a3ecf98>]}
2022-08-01 03:28:50.081325 (Thread-1): 22:28:50 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.97s]
2022-08-01 03:28:50.081444 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:28:50.081782 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:28:50.081964 (Thread-4): 22:28:50 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:28:50.082206 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:28:50.082301 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:28:50.084076 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:28:50.084671 (Thread-4): finished collecting timing info
2022-08-01 03:28:50.100918 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:28:50.101986 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:28:50.102074 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:28:50.102146 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:28:50.606735 (Thread-4): SQL status: SUCCESS 1 in 0.50 seconds
2022-08-01 03:28:50.606910 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:28:50.607022 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:28:50.832307 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2022-08-01 03:28:50.833270 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:28:50.833402 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:28:50.833467 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:28:50.908729 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:28:50.909455 (Thread-4): finished collecting timing info
2022-08-01 03:28:50.909583 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:28:51.024877 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea0d5a5b-403b-4536-9ffc-fcd32e52be8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a3d9160>]}
2022-08-01 03:28:51.025234 (Thread-4): 22:28:51 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.94s]
2022-08-01 03:28:51.025355 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:28:51.127052 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:28:51.127284 (MainThread): Using snowflake connection "master".
2022-08-01 03:28:51.127361 (MainThread): On master: BEGIN
2022-08-01 03:28:51.127431 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:28:51.637598 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-08-01 03:28:51.637769 (MainThread): On master: COMMIT
2022-08-01 03:28:51.637893 (MainThread): Using snowflake connection "master".
2022-08-01 03:28:51.637960 (MainThread): On master: COMMIT
2022-08-01 03:28:51.774030 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:28:51.774289 (MainThread): On master: Close
2022-08-01 03:28:51.889515 (MainThread): 22:28:51 | 
2022-08-01 03:28:51.889853 (MainThread): 22:28:51 | Finished running 3 table models, 1 view model in 6.38s.
2022-08-01 03:28:51.890031 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:28:51.890135 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:28:51.890228 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:28:51.890316 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:28:51.890404 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:28:51.898794 (MainThread): 
2022-08-01 03:28:51.898983 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 03:28:51.899088 (MainThread): 
2022-08-01 03:28:51.899184 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 03:28:51.899268 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:28:51.899343 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:28:51.899417 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:28:51.899496 (MainThread): 
2022-08-01 03:28:51.899585 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:28:51.899684 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:28:51.899763 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:28:51.899836 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:28:51.899924 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 03:28:51.900119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec976fca58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9757ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9a3ec278>]}
2022-08-01 03:28:51.900323 (MainThread): Flushing usage events
2022-08-01 03:29:59.154346 (MainThread): Running with dbt=0.19.1
2022-08-01 03:29:59.992895 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:30:00.061729 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:30:00.064810 (MainThread): Tracking: tracking
2022-08-01 03:30:00.065580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6734512b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66e913e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6734687b8>]}
2022-08-01 03:30:00.082209 (MainThread): Partial parsing not enabled
2022-08-01 03:30:00.083887 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:30:00.086946 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:30:00.117197 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:30:00.119495 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:30:00.121184 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:30:00.125389 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:30:00.137590 (MainThread): Parsing macros/core.sql
2022-08-01 03:30:00.141684 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:30:00.151204 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:30:00.153179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:30:00.238117 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:30:00.275420 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:30:00.296524 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:30:00.298588 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:30:00.304756 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:30:00.318981 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:30:00.325672 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:30:00.331978 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:30:00.337680 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:30:00.338955 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:30:00.340413 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:30:00.342216 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:30:00.351391 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:30:00.353548 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:30:00.355341 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:30:00.396192 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:30:00.398295 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:30:00.399990 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:30:00.401878 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:30:00.409728 (MainThread): Partial parsing not enabled
2022-08-01 03:30:00.430427 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:30:00.439716 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:30:00.443099 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:30:00.449486 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:30:00.521009 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:30:00.521838 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67382bcc0>]}
2022-08-01 03:30:00.528929 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6716a1dd8>]}
2022-08-01 03:30:00.529171 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:30:00.529861 (MainThread): 
2022-08-01 03:30:00.530135 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:30:00.530996 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:30:00.542421 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:30:00.542541 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:30:00.542617 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:30:01.460024 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.92 seconds
2022-08-01 03:30:01.465565 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:30:01.582725 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:30:01.589502 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:30:01.589626 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:30:01.589711 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:30:02.373150 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.78 seconds
2022-08-01 03:30:02.375023 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:30:02.500627 (MainThread): Using snowflake connection "master".
2022-08-01 03:30:02.500835 (MainThread): On master: BEGIN
2022-08-01 03:30:02.500961 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:30:03.022651 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 03:30:03.023105 (MainThread): On master: COMMIT
2022-08-01 03:30:03.023424 (MainThread): Using snowflake connection "master".
2022-08-01 03:30:03.023579 (MainThread): On master: COMMIT
2022-08-01 03:30:03.181690 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2022-08-01 03:30:03.182158 (MainThread): On master: Close
2022-08-01 03:30:03.305933 (MainThread): 22:30:03 | Concurrency: 8 threads (target='dev')
2022-08-01 03:30:03.306241 (MainThread): 22:30:03 | 
2022-08-01 03:30:03.308319 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:30:03.308571 (Thread-3): Began running node model.fivetran_poc.candidates
2022-08-01 03:30:03.308892 (Thread-1): 22:30:03 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:30:03.309031 (Thread-2): Began running node model.fivetran_poc.events
2022-08-01 03:30:03.309313 (Thread-3): 22:30:03 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:30:03.309891 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:30:03.310142 (Thread-2): 22:30:03 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:30:03.310491 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:30:03.310656 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:30:03.311056 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:30:03.311213 (Thread-3): Compiling model.fivetran_poc.candidates
2022-08-01 03:30:03.315165 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:30:03.315293 (Thread-2): Compiling model.fivetran_poc.events
2022-08-01 03:30:03.321506 (Thread-3): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:30:03.327428 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:30:03.327669 (Thread-3): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:30:03.327774 (Thread-1): finished collecting timing info
2022-08-01 03:30:03.327894 (Thread-2): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:30:03.327997 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:30:03.340480 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:30:03.359020 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:30:03.363503 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:30:03.363713 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:30:03.363807 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:30:04.281062 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2022-08-01 03:30:04.281291 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:30:04.281397 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:30:04.686673 (Thread-3): SQL status: SUCCESS 0 in 1.36 seconds
2022-08-01 03:30:04.687216 (Thread-3): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:30:04.687903 (Thread-3): finished collecting timing info
2022-08-01 03:30:04.689506 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:30:04.690412 (Thread-3): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:30:04.690492 (Thread-3): On model.fivetran_poc.candidates: BEGIN
2022-08-01 03:30:04.692661 (Thread-2): SQL status: SUCCESS 0 in 1.35 seconds
2022-08-01 03:30:04.693001 (Thread-2): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:30:04.695433 (Thread-2): finished collecting timing info
2022-08-01 03:30:04.697329 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:30:04.700047 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:30:04.700180 (Thread-2): On model.fivetran_poc.events: BEGIN
2022-08-01 03:30:04.795773 (Thread-3): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 03:30:04.795945 (Thread-3): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:30:04.796538 (Thread-2): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 03:30:04.796610 (Thread-3): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:30:04.796697 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:30:04.797566 (Thread-2): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:30:04.891608 (Thread-2): Snowflake query id: 01a5fcf2-0000-af49-0002-a3d600014706
2022-08-01 03:30:04.891748 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:30:04.891873 (Thread-2): finished collecting timing info
2022-08-01 03:30:04.891992 (Thread-2): On model.fivetran_poc.events: ROLLBACK
2022-08-01 03:30:04.896189 (Thread-3): Snowflake query id: 01a5fcf2-0000-af49-0002-a3d600014702
2022-08-01 03:30:04.896323 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:30:04.896438 (Thread-3): finished collecting timing info
2022-08-01 03:30:04.896553 (Thread-3): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 03:30:05.000803 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2022-08-01 03:30:05.001852 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:30:05.001983 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:30:05.002053 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:30:05.034302 (Thread-3): On model.fivetran_poc.candidates: Close
2022-08-01 03:30:05.047004 (Thread-2): On model.fivetran_poc.events: Close
2022-08-01 03:30:05.083417 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:30:05.092639 (Thread-1): finished collecting timing info
2022-08-01 03:30:05.093124 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:30:05.166844 (Thread-3): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:30:05.171704 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673b905c0>]}
2022-08-01 03:30:05.167277 (Thread-2): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:30:05.172133 (Thread-3): 22:30:05 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.86s]
2022-08-01 03:30:05.172304 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673e35c18>]}
2022-08-01 03:30:05.172413 (Thread-3): Finished running node model.fivetran_poc.candidates
2022-08-01 03:30:05.172693 (Thread-2): 22:30:05 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 1.86s]
2022-08-01 03:30:05.172986 (Thread-2): Finished running node model.fivetran_poc.events
2022-08-01 03:30:05.210275 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673b62da0>]}
2022-08-01 03:30:05.211158 (Thread-1): 22:30:05 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.90s]
2022-08-01 03:30:05.211644 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:30:05.212498 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:30:05.212820 (Thread-4): 22:30:05 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:30:05.213248 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:30:05.213386 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:30:05.216059 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:30:05.216805 (Thread-4): finished collecting timing info
2022-08-01 03:30:05.234310 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:30:05.235973 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:30:05.236103 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:30:05.236201 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:30:05.734373 (Thread-4): SQL status: SUCCESS 1 in 0.50 seconds
2022-08-01 03:30:05.734575 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:30:05.734647 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:30:05.973555 (Thread-4): SQL status: SUCCESS 1 in 0.24 seconds
2022-08-01 03:30:05.974515 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:30:05.974649 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:30:05.974719 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:30:06.042354 (Thread-4): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:30:06.043303 (Thread-4): finished collecting timing info
2022-08-01 03:30:06.043464 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:30:06.156816 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551800e-ceba-4ede-93d9-3b28af8075cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673e3abe0>]}
2022-08-01 03:30:06.157155 (Thread-4): 22:30:06 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.94s]
2022-08-01 03:30:06.157280 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:30:06.192077 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:30:06.192493 (MainThread): Using snowflake connection "master".
2022-08-01 03:30:06.192611 (MainThread): On master: BEGIN
2022-08-01 03:30:06.192773 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:30:06.684368 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2022-08-01 03:30:06.684819 (MainThread): On master: COMMIT
2022-08-01 03:30:06.685150 (MainThread): Using snowflake connection "master".
2022-08-01 03:30:06.685309 (MainThread): On master: COMMIT
2022-08-01 03:30:06.818843 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:30:06.819316 (MainThread): On master: Close
2022-08-01 03:30:06.953959 (MainThread): 22:30:06 | 
2022-08-01 03:30:06.954207 (MainThread): 22:30:06 | Finished running 3 table models, 1 view model in 6.42s.
2022-08-01 03:30:06.954363 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:30:06.954473 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:30:06.954573 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:30:06.954668 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:30:06.954768 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:30:06.960524 (MainThread): 
2022-08-01 03:30:06.960706 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 03:30:06.960844 (MainThread): 
2022-08-01 03:30:06.960966 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:30:06.961075 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:30:06.961173 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:30:06.961270 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:30:06.961370 (MainThread): 
2022-08-01 03:30:06.961479 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 03:30:06.961581 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:30:06.961676 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:30:06.961768 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:30:06.961876 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 03:30:06.962068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673b69390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa671637cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa673b62da0>]}
2022-08-01 03:30:06.962282 (MainThread): Flushing usage events
2022-08-01 03:35:10.338903 (MainThread): Running with dbt=0.19.1
2022-08-01 03:35:11.238196 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 03:35:11.301243 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 03:35:11.305035 (MainThread): Tracking: tracking
2022-08-01 03:35:11.305515 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22b8ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230482be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230482470>]}
2022-08-01 03:35:11.318414 (MainThread): Partial parsing not enabled
2022-08-01 03:35:11.320346 (MainThread): Parsing macros/catalog.sql
2022-08-01 03:35:11.322945 (MainThread): Parsing macros/adapters.sql
2022-08-01 03:35:11.355789 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 03:35:11.358492 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 03:35:11.360350 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 03:35:11.364627 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 03:35:11.377401 (MainThread): Parsing macros/core.sql
2022-08-01 03:35:11.381945 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 03:35:11.392084 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 03:35:11.394436 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 03:35:11.481013 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 03:35:11.518330 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 03:35:11.539421 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 03:35:11.542306 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 03:35:11.549091 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 03:35:11.564445 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 03:35:11.573061 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 03:35:11.580296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 03:35:11.585870 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 03:35:11.587412 (MainThread): Parsing macros/etc/query.sql
2022-08-01 03:35:11.589175 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 03:35:11.591472 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 03:35:11.601184 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 03:35:11.603797 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 03:35:11.605868 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 03:35:11.648248 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 03:35:11.650550 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 03:35:11.652384 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 03:35:11.654471 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 03:35:11.662680 (MainThread): Partial parsing not enabled
2022-08-01 03:35:11.684533 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:35:11.694805 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:35:11.698568 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:35:11.704414 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:35:11.779363 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 03:35:11.779953 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23086bc88>]}
2022-08-01 03:35:11.796265 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230451518>]}
2022-08-01 03:35:11.796589 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 03:35:11.797487 (MainThread): 
2022-08-01 03:35:11.797808 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:35:11.798832 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 03:35:11.811087 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 03:35:11.811219 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 03:35:11.811298 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 03:35:12.749396 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2022-08-01 03:35:12.753490 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 03:35:12.875329 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:35:12.883692 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 03:35:12.883838 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 03:35:12.883943 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 03:35:13.673709 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.79 seconds
2022-08-01 03:35:13.675709 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 03:35:13.811164 (MainThread): Using snowflake connection "master".
2022-08-01 03:35:13.811380 (MainThread): On master: BEGIN
2022-08-01 03:35:13.811511 (MainThread): Opening a new connection, currently in state init
2022-08-01 03:35:14.345464 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 03:35:14.345781 (MainThread): On master: COMMIT
2022-08-01 03:35:14.346041 (MainThread): Using snowflake connection "master".
2022-08-01 03:35:14.346197 (MainThread): On master: COMMIT
2022-08-01 03:35:14.478003 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 03:35:14.478331 (MainThread): On master: Close
2022-08-01 03:35:14.602124 (MainThread): 22:35:14 | Concurrency: 8 threads (target='dev')
2022-08-01 03:35:14.602389 (MainThread): 22:35:14 | 
2022-08-01 03:35:14.604452 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:35:14.604697 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 03:35:14.604964 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 03:35:14.605318 (Thread-1): 22:35:14 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 03:35:14.605619 (Thread-2): 22:35:14 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 03:35:14.605885 (Thread-3): 22:35:14 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 03:35:14.606248 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:35:14.606917 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:35:14.607037 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 03:35:14.607215 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 03:35:14.607367 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 03:35:14.607510 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 03:35:14.617195 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:35:14.617296 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:35:14.622971 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:35:14.623213 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:35:14.623390 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 03:35:14.623512 (Thread-2): Opening a new connection, currently in state init
2022-08-01 03:35:14.623605 (Thread-3): Opening a new connection, currently in state init
2022-08-01 03:35:14.626504 (Thread-1): finished collecting timing info
2022-08-01 03:35:14.656459 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 03:35:14.658131 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:35:14.658376 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 03:35:14.658468 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 03:35:15.609247 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2022-08-01 03:35:15.609589 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:35:15.609752 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 03:35:16.031257 (Thread-2): SQL status: SUCCESS 0 in 1.41 seconds
2022-08-01 03:35:16.031976 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:35:16.036435 (Thread-2): finished collecting timing info
2022-08-01 03:35:16.039416 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 03:35:16.043555 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:35:16.043724 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 03:35:16.121841 (Thread-3): SQL status: SUCCESS 0 in 1.50 seconds
2022-08-01 03:35:16.122250 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 03:35:16.122896 (Thread-3): finished collecting timing info
2022-08-01 03:35:16.124744 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 03:35:16.125568 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:35:16.125652 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 03:35:16.136484 (Thread-2): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 03:35:16.136627 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 03:35:16.136702 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:35:16.166138 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2022-08-01 03:35:16.167309 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:35:16.167443 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 03:35:16.167514 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 03:35:16.220258 (Thread-3): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 03:35:16.220406 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 03:35:16.220475 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 03:35:16.223964 (Thread-2): Snowflake query id: 01a5fcf7-0000-af49-0002-a3d600014726
2022-08-01 03:35:16.224091 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:35:16.224259 (Thread-2): finished collecting timing info
2022-08-01 03:35:16.224369 (Thread-2): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 03:35:16.241433 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 03:35:16.250656 (Thread-1): finished collecting timing info
2022-08-01 03:35:16.250919 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 03:35:16.305607 (Thread-3): Snowflake query id: 01a5fcf7-0000-af89-0002-a3d6000161ca
2022-08-01 03:35:16.305821 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:35:16.305935 (Thread-3): finished collecting timing info
2022-08-01 03:35:16.306083 (Thread-3): On model.fivetran_poc.events: ROLLBACK
2022-08-01 03:35:16.352245 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 03:35:16.368860 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230d1bf60>]}
2022-08-01 03:35:16.369196 (Thread-1): 22:35:16 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.76s]
2022-08-01 03:35:16.369334 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 03:35:16.369781 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:35:16.369997 (Thread-4): 22:35:16 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 03:35:16.370321 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:35:16.370416 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 03:35:16.372186 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:35:16.372768 (Thread-4): finished collecting timing info
2022-08-01 03:35:16.388598 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 03:35:16.389943 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:35:16.390080 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 03:35:16.390152 (Thread-4): Opening a new connection, currently in state init
2022-08-01 03:35:16.439424 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 03:35:16.468324 (Thread-2): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:35:16.479246 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230e269e8>]}
2022-08-01 03:35:16.479558 (Thread-2): 22:35:16 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.87s]
2022-08-01 03:35:16.479672 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 03:35:16.579185 (Thread-3): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:35:16.636031 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230d5f8d0>]}
2022-08-01 03:35:16.641513 (Thread-3): 22:35:16 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 2.03s]
2022-08-01 03:35:16.654523 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 03:35:16.923321 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 03:35:16.923478 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:35:16.923548 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 03:35:17.144345 (Thread-4): SQL status: SUCCESS 1 in 0.22 seconds
2022-08-01 03:35:17.145408 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:35:17.145552 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 03:35:17.145621 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 03:35:17.224087 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 03:35:17.224923 (Thread-4): finished collecting timing info
2022-08-01 03:35:17.225193 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 03:35:17.358594 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3176f600-cb3b-4b2d-ad31-fe5642f17ee3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230cf1ba8>]}
2022-08-01 03:35:17.358977 (Thread-4): 22:35:17 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.99s]
2022-08-01 03:35:17.359101 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 03:35:17.431577 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 03:35:17.431877 (MainThread): Using snowflake connection "master".
2022-08-01 03:35:17.431962 (MainThread): On master: BEGIN
2022-08-01 03:35:17.432034 (MainThread): Opening a new connection, currently in state closed
2022-08-01 03:35:18.001345 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2022-08-01 03:35:18.001537 (MainThread): On master: COMMIT
2022-08-01 03:35:18.001668 (MainThread): Using snowflake connection "master".
2022-08-01 03:35:18.001737 (MainThread): On master: COMMIT
2022-08-01 03:35:18.138890 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 03:35:18.139065 (MainThread): On master: Close
2022-08-01 03:35:18.255934 (MainThread): 22:35:18 | 
2022-08-01 03:35:18.256098 (MainThread): 22:35:18 | Finished running 3 table models, 1 view model in 6.46s.
2022-08-01 03:35:18.256196 (MainThread): Connection 'master' was properly closed.
2022-08-01 03:35:18.256260 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 03:35:18.256317 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 03:35:18.256370 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 03:35:18.256422 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 03:35:18.266945 (MainThread): 
2022-08-01 03:35:18.267111 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 03:35:18.267211 (MainThread): 
2022-08-01 03:35:18.267297 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 03:35:18.267374 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:35:18.267443 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:35:18.267509 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 03:35:18.267580 (MainThread): 
2022-08-01 03:35:18.267655 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 03:35:18.267725 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 03:35:18.267798 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 03:35:18.267864 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 03:35:18.267938 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 03:35:18.268077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230705320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff230705240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2308f2be0>]}
2022-08-01 03:35:18.268242 (MainThread): Flushing usage events
2022-08-01 17:03:51.170286 (MainThread): Running with dbt=0.19.1
2022-08-01 17:03:54.829964 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:03:54.916919 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:03:54.925496 (MainThread): Tracking: tracking
2022-08-01 17:03:54.926025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b20d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b7593f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b7593f60>]}
2022-08-01 17:03:54.941220 (MainThread): Partial parsing not enabled
2022-08-01 17:03:54.948333 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:03:54.952491 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:03:55.007135 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:03:55.012212 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:03:55.015276 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:03:55.021582 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:03:55.040033 (MainThread): Parsing macros/core.sql
2022-08-01 17:03:55.047060 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:03:55.058508 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:03:55.062025 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:03:55.139360 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:03:55.176332 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:03:55.199572 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:03:55.203775 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:03:55.212612 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:03:55.234156 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:03:55.244916 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:03:55.253750 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:03:55.260639 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:03:55.263608 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:03:55.266446 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:03:55.270089 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:03:55.280646 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:03:55.284500 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:03:55.288534 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:03:55.331660 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:03:55.335119 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:03:55.338170 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:03:55.341527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:03:55.349876 (MainThread): Partial parsing not enabled
2022-08-01 17:03:55.372455 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:03:55.384069 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:03:55.387931 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:03:55.394364 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:03:55.473410 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:03:55.473918 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b8048048>]}
2022-08-01 17:03:55.489689 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b565e2b0>]}
2022-08-01 17:03:55.489998 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 17:03:55.490906 (MainThread): 
2022-08-01 17:03:55.491250 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:03:55.492353 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:03:55.504298 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:03:55.504451 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:03:55.504535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:03:56.743367 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.24 seconds
2022-08-01 17:03:56.750243 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:03:56.889299 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:03:56.897795 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:03:56.897931 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:03:56.898028 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:03:57.407699 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.51 seconds
2022-08-01 17:03:57.409521 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:03:57.551359 (MainThread): Using snowflake connection "master".
2022-08-01 17:03:57.551611 (MainThread): On master: BEGIN
2022-08-01 17:03:57.551777 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:03:58.078590 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 17:03:58.078907 (MainThread): On master: COMMIT
2022-08-01 17:03:58.079133 (MainThread): Using snowflake connection "master".
2022-08-01 17:03:58.079241 (MainThread): On master: COMMIT
2022-08-01 17:03:58.210841 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 17:03:58.211126 (MainThread): On master: Close
2022-08-01 17:03:58.345111 (MainThread): 12:03:58 | Concurrency: 8 threads (target='dev')
2022-08-01 17:03:58.345379 (MainThread): 12:03:58 | 
2022-08-01 17:03:58.347479 (Thread-2): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:03:58.347719 (Thread-1): Began running node model.fivetran_poc.candidates
2022-08-01 17:03:58.348058 (Thread-2): 12:03:58 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:03:58.348195 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 17:03:58.348482 (Thread-1): 12:03:58 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:03:58.348992 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:03:58.349225 (Thread-3): 12:03:58 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:03:58.349542 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:03:58.349693 (Thread-2): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:03:58.349997 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:03:58.350156 (Thread-1): Compiling model.fivetran_poc.candidates
2022-08-01 17:03:58.353727 (Thread-2): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:03:58.353834 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 17:03:58.359763 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:03:58.365753 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:03:58.365895 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:03:58.366051 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:03:58.366144 (Thread-2): finished collecting timing info
2022-08-01 17:03:58.366276 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:03:58.366461 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:03:58.396524 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:03:58.399883 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:03:58.400369 (Thread-2): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:03:58.400470 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:03:59.475693 (Thread-2): SQL status: SUCCESS 1 in 1.08 seconds
2022-08-01 17:03:59.475978 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:03:59.476138 (Thread-2): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:04:00.083865 (Thread-3): SQL status: SUCCESS 0 in 1.72 seconds
2022-08-01 17:04:00.084664 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:04:00.088820 (Thread-1): SQL status: SUCCESS 0 in 1.72 seconds
2022-08-01 17:04:00.089240 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:04:00.089541 (Thread-3): finished collecting timing info
2022-08-01 17:04:00.091637 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:04:00.096508 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:00.096664 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 17:04:00.096783 (Thread-1): finished collecting timing info
2022-08-01 17:04:00.100521 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:04:00.103569 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:00.103684 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-08-01 17:04:00.189752 (Thread-3): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 17:04:00.190093 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:00.190249 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:04:00.202139 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:04:00.202417 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:00.202570 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:04:00.211447 (Thread-2): SQL status: SUCCESS 1 in 0.74 seconds
2022-08-01 17:04:00.212814 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:04:00.212995 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:00.213091 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:04:00.272763 (Thread-3): Snowflake query id: 01a60020-0000-af49-0002-a3d60001486e
2022-08-01 17:04:00.273130 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:00.273493 (Thread-3): finished collecting timing info
2022-08-01 17:04:00.273854 (Thread-3): On model.fivetran_poc.events: ROLLBACK
2022-08-01 17:04:00.287836 (Thread-1): Snowflake query id: 01a60020-0000-af49-0002-a3d600014872
2022-08-01 17:04:00.288198 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:00.288534 (Thread-1): finished collecting timing info
2022-08-01 17:04:00.288877 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 17:04:00.295935 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:04:00.308063 (Thread-2): finished collecting timing info
2022-08-01 17:04:00.308223 (Thread-2): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:04:00.410084 (Thread-1): On model.fivetran_poc.candidates: Close
2022-08-01 17:04:00.417484 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 17:04:00.435633 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b84eb8d0>]}
2022-08-01 17:04:00.436120 (Thread-2): 12:04:00 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.09s]
2022-08-01 17:04:00.436316 (Thread-2): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:04:00.436781 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:00.437062 (Thread-4): 12:04:00 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:04:00.437441 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:00.437598 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:00.440147 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:04:00.440969 (Thread-4): finished collecting timing info
2022-08-01 17:04:00.459953 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:04:00.461154 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:00.461261 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:04:00.461336 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:04:00.552643 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 17:04:00.593428 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b8625780>]}
2022-08-01 17:04:00.553411 (Thread-3): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:04:00.593877 (Thread-1): 12:04:00 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 2.24s]
2022-08-01 17:04:00.594054 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b84a1be0>]}
2022-08-01 17:04:00.594209 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-08-01 17:04:00.594434 (Thread-3): 12:04:00 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 2.24s]
2022-08-01 17:04:00.594731 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 17:04:00.983774 (Thread-4): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 17:04:00.984187 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:00.984423 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:04:01.249608 (Thread-4): SQL status: SUCCESS 1 in 0.26 seconds
2022-08-01 17:04:01.251526 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:04:01.251804 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:01.251958 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:04:01.333998 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:04:01.335409 (Thread-4): finished collecting timing info
2022-08-01 17:04:01.335665 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:04:01.467129 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107d8914-0908-4128-b696-ae2da2ac9545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b8623f60>]}
2022-08-01 17:04:01.467628 (Thread-4): 12:04:01 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.03s]
2022-08-01 17:04:01.467864 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:01.569664 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:04:01.570269 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:01.570509 (MainThread): On master: BEGIN
2022-08-01 17:04:01.570735 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:04:02.117532 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 17:04:02.117970 (MainThread): On master: COMMIT
2022-08-01 17:04:02.118262 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:02.118411 (MainThread): On master: COMMIT
2022-08-01 17:04:02.251296 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 17:04:02.251526 (MainThread): On master: Close
2022-08-01 17:04:02.388498 (MainThread): 12:04:02 | 
2022-08-01 17:04:02.388738 (MainThread): 12:04:02 | Finished running 3 table models, 1 view model in 6.90s.
2022-08-01 17:04:02.388888 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:04:02.388992 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:04:02.389084 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:04:02.389172 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:04:02.389258 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:04:02.403202 (MainThread): 
2022-08-01 17:04:02.404428 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 17:04:02.404708 (MainThread): 
2022-08-01 17:04:02.404882 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 17:04:02.405041 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:04:02.426738 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:02.427394 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 17:04:02.427754 (MainThread): 
2022-08-01 17:04:02.427978 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 17:04:02.428158 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:04:02.428315 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:02.428464 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:04:02.428637 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 17:04:02.428855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b565e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b75356a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b864dac8>]}
2022-08-01 17:04:02.429113 (MainThread): Flushing usage events
2022-08-01 17:04:34.375196 (MainThread): Running with dbt=0.19.1
2022-08-01 17:04:35.422914 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:04:35.491825 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:04:35.494342 (MainThread): Tracking: tracking
2022-08-01 17:04:35.494994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1ad94ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1ad94f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1ad94cc0>]}
2022-08-01 17:04:35.508062 (MainThread): Partial parsing not enabled
2022-08-01 17:04:35.509579 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:04:35.512186 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:04:35.542780 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:04:35.545092 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:04:35.546838 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:04:35.551095 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:04:35.563258 (MainThread): Parsing macros/core.sql
2022-08-01 17:04:35.567661 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:04:35.576715 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:04:35.578904 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:04:35.657200 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:04:35.693256 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:04:35.716918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:04:35.719287 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:04:35.725646 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:04:35.740319 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:04:35.748216 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:04:35.755227 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:04:35.760186 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:04:35.762331 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:04:35.764323 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:04:35.766509 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:04:35.775701 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:04:35.778238 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:04:35.780304 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:04:35.820652 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:04:35.823045 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:04:35.825091 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:04:35.827120 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:04:35.835335 (MainThread): Partial parsing not enabled
2022-08-01 17:04:35.858535 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:35.869242 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:35.872760 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:35.878786 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:35.948686 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:04:35.949187 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1ba460b8>]}
2022-08-01 17:04:35.959220 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1a091828>]}
2022-08-01 17:04:35.959457 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 17:04:35.960193 (MainThread): 
2022-08-01 17:04:35.960472 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:04:35.961390 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:04:35.973473 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:04:35.973601 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:04:35.973674 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:04:36.816065 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.84 seconds
2022-08-01 17:04:36.821747 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:04:36.950399 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:04:36.958627 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:04:36.958808 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:04:36.958931 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:04:37.464950 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.51 seconds
2022-08-01 17:04:37.466831 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:04:37.592981 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:37.593179 (MainThread): On master: BEGIN
2022-08-01 17:04:37.593302 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:04:38.134616 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:04:38.134907 (MainThread): On master: COMMIT
2022-08-01 17:04:38.135112 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:38.135229 (MainThread): On master: COMMIT
2022-08-01 17:04:38.282774 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-08-01 17:04:38.283253 (MainThread): On master: Close
2022-08-01 17:04:38.437922 (MainThread): 12:04:38 | Concurrency: 8 threads (target='dev')
2022-08-01 17:04:38.438232 (MainThread): 12:04:38 | 
2022-08-01 17:04:38.440386 (Thread-2): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:04:38.440622 (Thread-1): Began running node model.fivetran_poc.candidates
2022-08-01 17:04:38.440947 (Thread-2): 12:04:38 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:04:38.441082 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 17:04:38.441365 (Thread-1): 12:04:38 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:04:38.441779 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:38.442059 (Thread-3): 12:04:38 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:04:38.442383 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:38.442540 (Thread-2): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:04:38.442832 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:38.442991 (Thread-1): Compiling model.fivetran_poc.candidates
2022-08-01 17:04:38.444551 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 17:04:38.447005 (Thread-2): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:04:38.453007 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:38.458523 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:38.458839 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:04:38.458948 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:04:38.459072 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:04:38.459249 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:04:38.459435 (Thread-2): finished collecting timing info
2022-08-01 17:04:38.489711 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:04:38.490859 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:38.490947 (Thread-2): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:04:38.491019 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:04:39.656861 (Thread-2): SQL status: SUCCESS 1 in 1.17 seconds
2022-08-01 17:04:39.657485 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:39.657699 (Thread-2): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:04:39.868748 (Thread-1): SQL status: SUCCESS 0 in 1.41 seconds
2022-08-01 17:04:39.869799 (Thread-1): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:04:39.871780 (Thread-3): SQL status: SUCCESS 0 in 1.41 seconds
2022-08-01 17:04:39.872453 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:04:39.872927 (Thread-1): finished collecting timing info
2022-08-01 17:04:39.875974 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:04:39.876463 (Thread-3): finished collecting timing info
2022-08-01 17:04:39.878799 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:04:39.880084 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:39.880334 (Thread-1): On model.fivetran_poc.candidates: BEGIN
2022-08-01 17:04:39.882008 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:39.882406 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 17:04:39.983560 (Thread-3): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:04:39.983969 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:04:39.984208 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:04:39.987168 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 17:04:39.987699 (Thread-1): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:04:39.988197 (Thread-1): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:04:40.074669 (Thread-3): Snowflake query id: 01a60020-0000-af49-0002-a3d60001489a
2022-08-01 17:04:40.074925 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:40.075179 (Thread-3): finished collecting timing info
2022-08-01 17:04:40.075430 (Thread-3): On model.fivetran_poc.events: ROLLBACK
2022-08-01 17:04:40.080628 (Thread-1): Snowflake query id: 01a60020-0000-afa9-0002-a3d6000180f6
2022-08-01 17:04:40.080837 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:40.081014 (Thread-1): finished collecting timing info
2022-08-01 17:04:40.081206 (Thread-1): On model.fivetran_poc.candidates: ROLLBACK
2022-08-01 17:04:40.222500 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 17:04:40.232698 (Thread-1): On model.fivetran_poc.candidates: Close
2022-08-01 17:04:40.267447 (Thread-2): SQL status: SUCCESS 1 in 0.61 seconds
2022-08-01 17:04:40.268902 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:04:40.269078 (Thread-2): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:04:40.269158 (Thread-2): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:04:40.375811 (Thread-2): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 17:04:40.389706 (Thread-2): finished collecting timing info
2022-08-01 17:04:40.389964 (Thread-2): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:04:40.393549 (Thread-1): Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model candidates (models/example/candidates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 17:04:40.393108 (Thread-3): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:04:40.404600 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1be31da0>]}
2022-08-01 17:04:40.404790 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1bca9240>]}
2022-08-01 17:04:40.405084 (Thread-1): 12:04:40 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.96s]
2022-08-01 17:04:40.405310 (Thread-3): 12:04:40 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 1.96s]
2022-08-01 17:04:40.405413 (Thread-1): Finished running node model.fivetran_poc.candidates
2022-08-01 17:04:40.405551 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 17:04:40.543881 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1bbcc278>]}
2022-08-01 17:04:40.544402 (Thread-2): 12:04:40 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.10s]
2022-08-01 17:04:40.544600 (Thread-2): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:04:40.545155 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:40.545436 (Thread-4): 12:04:40 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:04:40.545764 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:40.545900 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:40.548726 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:04:40.549600 (Thread-4): finished collecting timing info
2022-08-01 17:04:40.568759 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:04:40.569815 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:40.569921 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:04:40.569996 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:04:41.130451 (Thread-4): SQL status: SUCCESS 1 in 0.56 seconds
2022-08-01 17:04:41.130678 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:41.130803 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:04:41.359728 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2022-08-01 17:04:41.361268 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:04:41.361495 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:04:41.361639 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:04:41.447834 (Thread-4): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 17:04:41.449875 (Thread-4): finished collecting timing info
2022-08-01 17:04:41.450175 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:04:41.593871 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3347456a-ed43-46b1-bdea-750f3293444d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1bcb84a8>]}
2022-08-01 17:04:41.594364 (Thread-4): 12:04:41 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.05s]
2022-08-01 17:04:41.594563 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:04:41.630001 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:04:41.630608 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:41.630805 (MainThread): On master: BEGIN
2022-08-01 17:04:41.630933 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:04:42.182666 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 17:04:42.182920 (MainThread): On master: COMMIT
2022-08-01 17:04:42.183118 (MainThread): Using snowflake connection "master".
2022-08-01 17:04:42.183234 (MainThread): On master: COMMIT
2022-08-01 17:04:42.332834 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-08-01 17:04:42.333310 (MainThread): On master: Close
2022-08-01 17:04:42.477926 (MainThread): 12:04:42 | 
2022-08-01 17:04:42.478168 (MainThread): 12:04:42 | Finished running 3 table models, 1 view model in 6.52s.
2022-08-01 17:04:42.478324 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:04:42.478434 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:04:42.478534 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:04:42.478630 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:04:42.478727 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:04:42.484281 (MainThread): 
2022-08-01 17:04:42.484452 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 17:04:42.484584 (MainThread): 
2022-08-01 17:04:42.484709 (MainThread): Database Error in model candidates (models/example/candidates.sql)
2022-08-01 17:04:42.484820 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:04:42.484920 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:42.485017 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/candidates.sql
2022-08-01 17:04:42.485119 (MainThread): 
2022-08-01 17:04:42.485243 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 17:04:42.485335 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:04:42.485441 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:04:42.485527 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:04:42.485625 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 17:04:42.485788 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1b805278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1bb14ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec1bbcc278>]}
2022-08-01 17:04:42.485981 (MainThread): Flushing usage events
2022-08-01 17:12:29.777503 (MainThread): Running with dbt=0.19.1
2022-08-01 17:12:30.801513 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:12:30.867807 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:12:30.879275 (MainThread): Tracking: tracking
2022-08-01 17:12:30.879930 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15752efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15752ef28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15752ed68>]}
2022-08-01 17:12:30.892233 (MainThread): Partial parsing not enabled
2022-08-01 17:12:30.893689 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:12:30.896386 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:12:30.926164 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:12:30.928552 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:12:30.930557 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:12:30.934918 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:12:30.946134 (MainThread): Parsing macros/core.sql
2022-08-01 17:12:30.950418 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:12:30.959986 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:12:30.962090 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:12:31.039037 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:12:31.074339 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:12:31.095731 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:12:31.097900 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:12:31.104970 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:12:31.119676 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:12:31.127195 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:12:31.134644 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:12:31.140076 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:12:31.141561 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:12:31.142897 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:12:31.144852 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:12:31.154355 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:12:31.156978 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:12:31.159522 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:12:31.199572 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:12:31.201808 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:12:31.203706 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:12:31.205821 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:12:31.213594 (MainThread): Partial parsing not enabled
2022-08-01 17:12:31.234070 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:12:31.243677 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:12:31.247683 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:12:31.254180 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:12:31.326167 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:12:31.326690 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1577bacc0>]}
2022-08-01 17:12:31.341419 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1577cf320>]}
2022-08-01 17:12:31.341686 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-08-01 17:12:31.342513 (MainThread): 
2022-08-01 17:12:31.342823 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:12:31.343845 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:12:31.359592 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:12:31.359745 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:12:31.359846 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:12:32.257695 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2022-08-01 17:12:32.265363 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:12:32.417645 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:12:32.425857 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:12:32.426015 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:12:32.426127 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:12:32.975513 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.55 seconds
2022-08-01 17:12:32.977253 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:12:33.095210 (MainThread): Using snowflake connection "master".
2022-08-01 17:12:33.095398 (MainThread): On master: BEGIN
2022-08-01 17:12:33.095689 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:12:33.884444 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2022-08-01 17:12:33.884621 (MainThread): On master: COMMIT
2022-08-01 17:12:33.884745 (MainThread): Using snowflake connection "master".
2022-08-01 17:12:33.884813 (MainThread): On master: COMMIT
2022-08-01 17:12:34.036599 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-08-01 17:12:34.036931 (MainThread): On master: Close
2022-08-01 17:12:34.162825 (MainThread): 12:12:34 | Concurrency: 8 threads (target='dev')
2022-08-01 17:12:34.163043 (MainThread): 12:12:34 | 
2022-08-01 17:12:34.164776 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:12:34.164992 (Thread-3): Began running node model.fivetran_poc.candidates
2022-08-01 17:12:34.165301 (Thread-1): 12:12:34 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:12:34.165427 (Thread-2): Began running node model.fivetran_poc.events
2022-08-01 17:12:34.165711 (Thread-3): 12:12:34 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:12:34.166112 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:12:34.166321 (Thread-2): 12:12:34 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:12:34.166659 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:12:34.166765 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:12:34.167156 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:12:34.167356 (Thread-3): Compiling model.fivetran_poc.candidates
2022-08-01 17:12:34.168933 (Thread-2): Compiling model.fivetran_poc.events
2022-08-01 17:12:34.170976 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:12:34.176973 (Thread-3): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:12:34.181521 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:12:34.181730 (Thread-3): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:12:34.181834 (Thread-2): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:12:34.181943 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:12:34.182030 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:12:34.182706 (Thread-1): finished collecting timing info
2022-08-01 17:12:34.212994 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:12:34.256734 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:12:34.277350 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:12:34.277546 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:12:35.129914 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2022-08-01 17:12:35.130446 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:12:35.130833 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:12:35.676532 (Thread-3): SQL status: SUCCESS 0 in 1.49 seconds
2022-08-01 17:12:35.683727 (Thread-3): finished collecting timing info
2022-08-01 17:12:35.684022 (Thread-3): On model.fivetran_poc.candidates: Close
2022-08-01 17:12:35.821903 (Thread-3): Compilation Error in model candidates (models/example/candidates.sql)
  'tuple object' has no attribute 'print_table'
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'tuple object' has no attribute 'print_table'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  'tuple object' has no attribute 'print_table'
2022-08-01 17:12:35.852219 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157b499b0>]}
2022-08-01 17:12:35.852577 (Thread-3): 12:12:35 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 1.69s]
2022-08-01 17:12:35.852708 (Thread-3): Finished running node model.fivetran_poc.candidates
2022-08-01 17:12:35.901623 (Thread-2): SQL status: SUCCESS 0 in 1.72 seconds
2022-08-01 17:12:35.902123 (Thread-2): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:12:35.907884 (Thread-2): finished collecting timing info
2022-08-01 17:12:35.909985 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:12:35.914778 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:12:35.914904 (Thread-2): On model.fivetran_poc.events: BEGIN
2022-08-01 17:12:36.018569 (Thread-2): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:12:36.018862 (Thread-2): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:12:36.019020 (Thread-2): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:12:36.093697 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2022-08-01 17:12:36.096467 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:12:36.096733 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:12:36.096860 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:12:36.110021 (Thread-2): Snowflake query id: 01a60028-0000-af89-0002-a3d60001627e
2022-08-01 17:12:36.110275 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:12:36.110588 (Thread-2): finished collecting timing info
2022-08-01 17:12:36.110850 (Thread-2): On model.fivetran_poc.events: ROLLBACK
2022-08-01 17:12:36.181414 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:12:36.193981 (Thread-1): finished collecting timing info
2022-08-01 17:12:36.194198 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:12:36.265838 (Thread-2): On model.fivetran_poc.events: Close
2022-08-01 17:12:36.317341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157bb8b38>]}
2022-08-01 17:12:36.317926 (Thread-1): 12:12:36 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.15s]
2022-08-01 17:12:36.318129 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:12:36.318635 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:12:36.318936 (Thread-4): 12:12:36 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:12:36.319327 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:12:36.319487 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:12:36.322265 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:12:36.324333 (Thread-4): finished collecting timing info
2022-08-01 17:12:36.346942 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:12:36.348059 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:12:36.348240 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:12:36.348411 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:12:36.418062 (Thread-2): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:12:36.425723 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157f17470>]}
2022-08-01 17:12:36.426069 (Thread-2): 12:12:36 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 2.26s]
2022-08-01 17:12:36.426202 (Thread-2): Finished running node model.fivetran_poc.events
2022-08-01 17:12:36.866902 (Thread-4): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 17:12:36.867331 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:12:36.867593 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:12:37.218945 (Thread-4): SQL status: SUCCESS 1 in 0.35 seconds
2022-08-01 17:12:37.221166 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:12:37.221448 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:12:37.221612 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:12:37.340145 (Thread-4): SQL status: SUCCESS 1 in 0.12 seconds
2022-08-01 17:12:37.341232 (Thread-4): finished collecting timing info
2022-08-01 17:12:37.341431 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:12:37.462551 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8332b05b-a4e2-4976-9810-d1df8d8ac4b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157a9f3c8>]}
2022-08-01 17:12:37.463037 (Thread-4): 12:12:37 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.14s]
2022-08-01 17:12:37.463233 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:12:37.530733 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:12:37.531294 (MainThread): Using snowflake connection "master".
2022-08-01 17:12:37.531477 (MainThread): On master: BEGIN
2022-08-01 17:12:37.531647 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:12:38.069691 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:12:38.070180 (MainThread): On master: COMMIT
2022-08-01 17:12:38.070445 (MainThread): Using snowflake connection "master".
2022-08-01 17:12:38.070602 (MainThread): On master: COMMIT
2022-08-01 17:12:38.227859 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2022-08-01 17:12:38.228329 (MainThread): On master: Close
2022-08-01 17:12:38.357453 (MainThread): 12:12:38 | 
2022-08-01 17:12:38.357694 (MainThread): 12:12:38 | Finished running 3 table models, 1 view model in 7.01s.
2022-08-01 17:12:38.357851 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:12:38.357961 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:12:38.358065 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:12:38.358159 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:12:38.358253 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:12:38.371018 (MainThread): 
2022-08-01 17:12:38.371260 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 17:12:38.371417 (MainThread): 
2022-08-01 17:12:38.371567 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
2022-08-01 17:12:38.371704 (MainThread):   'tuple object' has no attribute 'print_table'
2022-08-01 17:12:38.371836 (MainThread): 
2022-08-01 17:12:38.371950 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 17:12:38.372056 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:12:38.372152 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:12:38.372245 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:12:38.372351 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 17:12:38.372541 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157b51b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff157a9f3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1576a0b38>]}
2022-08-01 17:12:38.372767 (MainThread): Flushing usage events
2022-08-01 17:29:03.221613 (MainThread): Running with dbt=0.19.1
2022-08-01 17:29:04.346054 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:29:04.412965 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:29:04.415648 (MainThread): Tracking: tracking
2022-08-01 17:29:04.416329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25866cf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25866cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25866cd68>]}
2022-08-01 17:29:04.429603 (MainThread): Partial parsing not enabled
2022-08-01 17:29:04.430958 (MainThread): Parsing macros/get_schema_list.sql
2022-08-01 17:29:04.431876 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:29:04.434376 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:29:04.465928 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:29:04.468285 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:29:04.470149 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:29:04.474463 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:29:04.487194 (MainThread): Parsing macros/core.sql
2022-08-01 17:29:04.491689 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:29:04.501095 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:29:04.503309 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:29:04.579105 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:29:04.615375 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:29:04.639188 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:29:04.641756 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:29:04.649106 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:29:04.663678 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:29:04.671329 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:29:04.678259 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:29:04.683801 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:29:04.685234 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:29:04.686778 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:29:04.688945 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:29:04.698316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:29:04.700798 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:29:04.702965 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:29:04.744918 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:29:04.747289 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:29:04.749678 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:29:04.752009 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:29:04.760373 (MainThread): Partial parsing not enabled
2022-08-01 17:29:04.781666 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:04.791300 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:04.794707 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:04.801776 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:04.884708 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:29:04.885400 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2589827f0>]}
2022-08-01 17:29:04.893947 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25896e438>]}
2022-08-01 17:29:04.894241 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-08-01 17:29:04.895206 (MainThread): 
2022-08-01 17:29:04.895582 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:29:04.896580 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:29:04.912800 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:29:04.912927 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:29:04.913009 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:29:05.892502 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.98 seconds
2022-08-01 17:29:05.895769 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:29:06.037237 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:29:06.045209 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:29:06.045342 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:29:06.045436 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:29:06.870223 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.82 seconds
2022-08-01 17:29:06.871395 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:29:07.294934 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:07.295149 (MainThread): On master: BEGIN
2022-08-01 17:29:07.295281 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:29:07.836385 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:29:07.836822 (MainThread): On master: COMMIT
2022-08-01 17:29:07.837092 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:07.837257 (MainThread): On master: COMMIT
2022-08-01 17:29:07.967597 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2022-08-01 17:29:07.967850 (MainThread): On master: Close
2022-08-01 17:29:08.118894 (MainThread): 12:29:08 | Concurrency: 8 threads (target='dev')
2022-08-01 17:29:08.119137 (MainThread): 12:29:08 | 
2022-08-01 17:29:08.120959 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:08.121078 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 17:29:08.121208 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 17:29:08.121466 (Thread-1): 12:29:08 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:29:08.121642 (Thread-2): 12:29:08 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:29:08.121812 (Thread-3): 12:29:08 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:29:08.122088 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:08.122309 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:08.122539 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:08.122652 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:08.122751 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 17:29:08.122843 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 17:29:08.128564 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:08.132889 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:08.133080 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
where table_schema ilike '%POC%'
2022-08-01 17:29:08.134708 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:29:08.134840 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:29:08.134959 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:29:08.135212 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:29:08.138343 (Thread-1): finished collecting timing info
2022-08-01 17:29:08.166757 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:29:08.168559 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:08.168744 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:29:08.168887 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:29:09.256015 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2022-08-01 17:29:09.256489 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:09.256783 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:29:09.958678 (Thread-3): SQL status: SUCCESS 0 in 1.82 seconds
2022-08-01 17:29:09.959175 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:29:09.960541 (Thread-3): finished collecting timing info
2022-08-01 17:29:09.962132 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:29:09.963042 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:09.963123 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 17:29:10.035112 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2022-08-01 17:29:10.036209 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:29:10.036351 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:10.036418 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:29:10.060087 (Thread-3): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:29:10.060223 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:10.060292 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:29:10.082504 (Thread-2): SQL status: SUCCESS 2 in 1.95 seconds
2022-08-01 17:29:10.084850 (Thread-2): finished collecting timing info
2022-08-01 17:29:10.085028 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 17:29:10.116513 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:29:10.130119 (Thread-1): finished collecting timing info
2022-08-01 17:29:10.130291 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:29:10.155493 (Thread-3): Snowflake query id: 01a60039-0000-af49-0002-a3d600014922
2022-08-01 17:29:10.155882 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:29:10.156242 (Thread-3): finished collecting timing info
2022-08-01 17:29:10.156640 (Thread-3): On model.fivetran_poc.events: ROLLBACK
2022-08-01 17:29:10.220029 (Thread-2): Compilation Error in model candidates (models/example/candidates.sql)
  'tuple object' has no attribute 'print_table'
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 17, in top-level template code
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'tuple object' has no attribute 'print_table'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model candidates (models/example/candidates.sql)
  'tuple object' has no attribute 'print_table'
2022-08-01 17:29:10.232376 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25904dcf8>]}
2022-08-01 17:29:10.232854 (Thread-2): 12:29:10 | 2 of 4 ERROR creating table model PUBLIC.candidates.................. [ERROR in 2.11s]
2022-08-01 17:29:10.233051 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 17:29:10.253004 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25545cb00>]}
2022-08-01 17:29:10.253467 (Thread-1): 12:29:10 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.13s]
2022-08-01 17:29:10.253664 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:10.254147 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:10.254402 (Thread-4): 12:29:10 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:29:10.254826 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:10.254984 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:10.257565 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:29:10.258680 (Thread-4): finished collecting timing info
2022-08-01 17:29:10.277035 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:29:10.278004 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:10.278096 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:29:10.278171 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:29:10.303401 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 17:29:10.460096 (Thread-3): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:29:10.563856 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25900c5c0>]}
2022-08-01 17:29:10.564179 (Thread-3): 12:29:10 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 2.44s]
2022-08-01 17:29:10.564344 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 17:29:10.806175 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2022-08-01 17:29:10.806606 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:10.806846 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:29:11.033602 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2022-08-01 17:29:11.034548 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:29:11.034683 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:11.034753 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:29:11.111985 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:29:11.112723 (Thread-4): finished collecting timing info
2022-08-01 17:29:11.112851 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:29:11.250943 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73d42501-9097-4572-9760-fd406c00a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb258ca7860>]}
2022-08-01 17:29:11.251339 (Thread-4): 12:29:11 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.00s]
2022-08-01 17:29:11.251462 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:11.330144 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:29:11.330845 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:11.331088 (MainThread): On master: BEGIN
2022-08-01 17:29:11.331254 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:29:11.918269 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2022-08-01 17:29:11.918886 (MainThread): On master: COMMIT
2022-08-01 17:29:11.919235 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:11.919404 (MainThread): On master: COMMIT
2022-08-01 17:29:12.057864 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 17:29:12.058024 (MainThread): On master: Close
2022-08-01 17:29:12.183523 (MainThread): 12:29:12 | 
2022-08-01 17:29:12.183695 (MainThread): 12:29:12 | Finished running 3 table models, 1 view model in 7.29s.
2022-08-01 17:29:12.183796 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:29:12.183872 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:29:12.183956 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:29:12.184062 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:29:12.184161 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:29:12.188305 (MainThread): 
2022-08-01 17:29:12.188436 (MainThread): Completed with 2 errors and 0 warnings:
2022-08-01 17:29:12.188550 (MainThread): 
2022-08-01 17:29:12.188696 (MainThread): Compilation Error in model candidates (models/example/candidates.sql)
2022-08-01 17:29:12.188802 (MainThread):   'tuple object' has no attribute 'print_table'
2022-08-01 17:29:12.188960 (MainThread): 
2022-08-01 17:29:12.189066 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 17:29:12.189148 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:29:12.189229 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:29:12.189323 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:29:12.189424 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-08-01 17:29:12.189614 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2589133c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2587aca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25863d630>]}
2022-08-01 17:29:12.189842 (MainThread): Flushing usage events
2022-08-01 17:29:25.460454 (MainThread): Running with dbt=0.19.1
2022-08-01 17:29:26.620497 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:29:26.686513 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:29:26.688961 (MainThread): Tracking: tracking
2022-08-01 17:29:26.689694 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04dd4ceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04dd4cf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04dd4cd30>]}
2022-08-01 17:29:26.704234 (MainThread): Partial parsing not enabled
2022-08-01 17:29:26.705720 (MainThread): Parsing macros/get_schema_list.sql
2022-08-01 17:29:26.706817 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:29:26.709440 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:29:26.740126 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:29:26.742690 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:29:26.744766 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:29:26.749058 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:29:26.761616 (MainThread): Parsing macros/core.sql
2022-08-01 17:29:26.766133 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:29:26.775723 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:29:26.777970 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:29:26.851650 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:29:26.886750 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:29:26.908621 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:29:26.911086 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:29:26.918303 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:29:26.932451 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:29:26.939594 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:29:26.946095 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:29:26.951390 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:29:26.952884 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:29:26.954519 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:29:26.956521 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:29:26.965422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:29:26.967854 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:29:26.970018 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:29:27.012319 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:29:27.014720 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:29:27.016802 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:29:27.018894 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:29:27.027060 (MainThread): Partial parsing not enabled
2022-08-01 17:29:27.049208 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:27.059428 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:27.063563 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:27.070399 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:27.156034 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:29:27.156662 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e065780>]}
2022-08-01 17:29:27.172568 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04deb40f0>]}
2022-08-01 17:29:27.172837 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-08-01 17:29:27.173754 (MainThread): 
2022-08-01 17:29:27.174089 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:29:27.175189 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:29:27.187147 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:29:27.187245 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:29:27.187378 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:29:28.003776 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.82 seconds
2022-08-01 17:29:28.007211 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:29:28.177295 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:29:28.183141 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:29:28.183273 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:29:28.183352 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:29:28.927843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.74 seconds
2022-08-01 17:29:28.928750 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:29:29.045564 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:29.045707 (MainThread): On master: BEGIN
2022-08-01 17:29:29.045790 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:29:29.631130 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2022-08-01 17:29:29.631316 (MainThread): On master: COMMIT
2022-08-01 17:29:29.631446 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:29.631514 (MainThread): On master: COMMIT
2022-08-01 17:29:29.772909 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 17:29:29.773095 (MainThread): On master: Close
2022-08-01 17:29:29.900407 (MainThread): 12:29:29 | Concurrency: 8 threads (target='dev')
2022-08-01 17:29:29.900675 (MainThread): 12:29:29 | 
2022-08-01 17:29:29.902856 (Thread-3): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:29.903038 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 17:29:29.903175 (Thread-1): Began running node model.fivetran_poc.events
2022-08-01 17:29:29.903474 (Thread-3): 12:29:29 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:29:29.903725 (Thread-2): 12:29:29 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:29:29.903955 (Thread-1): 12:29:29 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:29:29.904418 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:29.904814 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:29.905176 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:29.905352 (Thread-3): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:29.905502 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 17:29:29.905649 (Thread-1): Compiling model.fivetran_poc.events
2022-08-01 17:29:29.913305 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:29.915522 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:29:29.920570 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:29.920697 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
where table_schema ilike '%POC%'
2022-08-01 17:29:29.920894 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
select distinct TABLE_SCHEMA from information_schema.tables
where table_schema ilike '%POC%'
2022-08-01 17:29:29.920996 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:29:29.921082 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:29:29.923776 (Thread-3): finished collecting timing info
2022-08-01 17:29:29.955342 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:29:29.957054 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:29.957236 (Thread-3): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:29:29.957369 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:29:31.697071 (Thread-2): SQL status: SUCCESS 2 in 1.78 seconds
2022-08-01 17:29:31.698238 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:29:31.701239 (Thread-2): finished collecting timing info
2022-08-01 17:29:31.704455 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:29:31.708585 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:31.708747 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 17:29:31.755119 (Thread-1): SQL status: SUCCESS 0 in 1.83 seconds
2022-08-01 17:29:31.755630 (Thread-1): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:29:31.758557 (Thread-1): finished collecting timing info
2022-08-01 17:29:31.761029 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:29:31.768849 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:31.769208 (Thread-1): On model.fivetran_poc.events: BEGIN
2022-08-01 17:29:31.821306 (Thread-2): SQL status: SUCCESS 1 in 0.11 seconds
2022-08-01 17:29:31.821738 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:31.822059 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (






    
    




with source_data as (
    
    select * , 'POC_CLIENT_1_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_1_PUBLIC.candidates
    union all
    
    select * , 'POC_CLIENT_2_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_2_PUBLIC.candidates
    
    
)
select *
from source_data
      );
2022-08-01 17:29:31.871861 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:29:31.872090 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:29:31.872193 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (








with source_data as (
    
)
select *
from source_data
      );
2022-08-01 17:29:31.957600 (Thread-1): Snowflake query id: 01a60039-0000-af89-0002-a3d60001630e
2022-08-01 17:29:31.957755 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:29:31.957900 (Thread-1): finished collecting timing info
2022-08-01 17:29:31.958051 (Thread-1): On model.fivetran_poc.events: ROLLBACK
2022-08-01 17:29:32.720072 (Thread-2): SQL status: SUCCESS 1 in 0.90 seconds
2022-08-01 17:29:32.721391 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 17:29:32.721520 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:29:32.721588 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 17:29:32.825070 (Thread-2): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:29:32.835828 (Thread-2): finished collecting timing info
2022-08-01 17:29:32.836008 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 17:29:32.983733 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e065588>]}
2022-08-01 17:29:32.984267 (Thread-2): 12:29:32 | 2 of 4 OK created table model PUBLIC.candidates...................... [SUCCESS 1 in 3.08s]
2022-08-01 17:29:32.984482 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 17:29:33.043293 (Thread-3): SQL status: SUCCESS 1 in 3.09 seconds
2022-08-01 17:29:33.043488 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:33.043601 (Thread-3): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:29:33.111728 (Thread-1): On model.fivetran_poc.events: Close
2022-08-01 17:29:33.252644 (Thread-1): Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 588, in execute
    errvalue)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/anaconda3/envs/warehouse/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model events (models/example/events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected ')'.
  compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:29:33.267187 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e590128>]}
2022-08-01 17:29:33.267666 (Thread-1): 12:29:33 | 3 of 4 ERROR creating table model PUBLIC.events...................... [ERROR in 3.36s]
2022-08-01 17:29:33.267863 (Thread-1): Finished running node model.fivetran_poc.events
2022-08-01 17:29:33.744053 (Thread-3): SQL status: SUCCESS 1 in 0.70 seconds
2022-08-01 17:29:33.746300 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:29:33.746593 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:29:33.746759 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:29:33.831466 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:29:33.833108 (Thread-3): finished collecting timing info
2022-08-01 17:29:33.833384 (Thread-3): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:29:33.975463 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e540dd8>]}
2022-08-01 17:29:33.975825 (Thread-3): 12:29:33 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 4.07s]
2022-08-01 17:29:33.975991 (Thread-3): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:29:33.976358 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:33.976585 (Thread-4): 12:29:33 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:29:33.976862 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:33.976973 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:33.979025 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:29:33.979693 (Thread-4): finished collecting timing info
2022-08-01 17:29:33.995552 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:29:33.996486 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:33.996576 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:29:33.996650 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:29:34.536639 (Thread-4): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:29:34.537080 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:34.537244 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:29:34.755710 (Thread-4): SQL status: SUCCESS 1 in 0.22 seconds
2022-08-01 17:29:34.756964 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:29:34.757101 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:29:34.757182 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:29:34.831266 (Thread-4): SQL status: SUCCESS 1 in 0.07 seconds
2022-08-01 17:29:34.831973 (Thread-4): finished collecting timing info
2022-08-01 17:29:34.832110 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:29:34.958038 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e193e41c-f8ff-4f60-af28-517ac4c4dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e69d748>]}
2022-08-01 17:29:34.958566 (Thread-4): 12:29:34 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.98s]
2022-08-01 17:29:34.958847 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:29:34.981225 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:29:34.981855 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:34.982119 (MainThread): On master: BEGIN
2022-08-01 17:29:34.982397 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:29:35.536814 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 17:29:35.536990 (MainThread): On master: COMMIT
2022-08-01 17:29:35.537135 (MainThread): Using snowflake connection "master".
2022-08-01 17:29:35.537205 (MainThread): On master: COMMIT
2022-08-01 17:29:35.702544 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2022-08-01 17:29:35.702855 (MainThread): On master: Close
2022-08-01 17:29:35.837301 (MainThread): 12:29:35 | 
2022-08-01 17:29:35.837552 (MainThread): 12:29:35 | Finished running 3 table models, 1 view model in 8.66s.
2022-08-01 17:29:35.837728 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:29:35.837869 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:29:35.837980 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:29:35.838078 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:29:35.838174 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:29:35.851782 (MainThread): 
2022-08-01 17:29:35.852020 (MainThread): Completed with 1 error and 0 warnings:
2022-08-01 17:29:35.852194 (MainThread): 
2022-08-01 17:29:35.852387 (MainThread): Database Error in model events (models/example/events.sql)
2022-08-01 17:29:35.852534 (MainThread):   001003 (42000): SQL compilation error:
2022-08-01 17:29:35.852669 (MainThread):   syntax error line 13 at position 0 unexpected ')'.
2022-08-01 17:29:35.852857 (MainThread):   compiled SQL at target/run/fivetran_poc/models/example/events.sql
2022-08-01 17:29:35.853055 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-08-01 17:29:35.853308 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04bed4630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e540dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04e0334a8>]}
2022-08-01 17:29:35.853658 (MainThread): Flushing usage events
2022-08-01 17:31:53.674895 (MainThread): Running with dbt=0.19.1
2022-08-01 17:31:54.698462 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 17:31:54.767993 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 17:31:54.770257 (MainThread): Tracking: tracking
2022-08-01 17:31:54.770919 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec681e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec681f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec681e80>]}
2022-08-01 17:31:54.785802 (MainThread): Partial parsing not enabled
2022-08-01 17:31:54.787306 (MainThread): Parsing macros/catalog.sql
2022-08-01 17:31:54.790002 (MainThread): Parsing macros/adapters.sql
2022-08-01 17:31:54.820147 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 17:31:54.822431 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 17:31:54.824283 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 17:31:54.828471 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 17:31:54.840480 (MainThread): Parsing macros/core.sql
2022-08-01 17:31:54.845023 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 17:31:54.853915 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 17:31:54.856066 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 17:31:54.932687 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 17:31:54.968572 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 17:31:54.990117 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 17:31:54.992602 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 17:31:54.998965 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 17:31:55.014848 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 17:31:55.021977 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 17:31:55.029496 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 17:31:55.034911 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 17:31:55.036632 (MainThread): Parsing macros/etc/query.sql
2022-08-01 17:31:55.038186 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 17:31:55.040076 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 17:31:55.049202 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 17:31:55.051897 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 17:31:55.054008 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 17:31:55.095514 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 17:31:55.098068 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 17:31:55.100493 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 17:31:55.102669 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 17:31:55.110527 (MainThread): Partial parsing not enabled
2022-08-01 17:31:55.130972 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:31:55.140542 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:31:55.144138 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:31:55.150609 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:31:55.231592 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 17:31:55.232212 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed1bd278>]}
2022-08-01 17:31:55.242130 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec674710>]}
2022-08-01 17:31:55.242384 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-08-01 17:31:55.243240 (MainThread): 
2022-08-01 17:31:55.243641 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:31:55.244553 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 17:31:55.255882 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 17:31:55.255989 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 17:31:55.256102 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 17:31:56.268214 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.01 seconds
2022-08-01 17:31:56.271493 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 17:31:56.390860 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:31:56.399099 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 17:31:56.399278 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 17:31:56.399399 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 17:31:57.074219 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.67 seconds
2022-08-01 17:31:57.075163 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 17:31:57.215161 (MainThread): Using snowflake connection "master".
2022-08-01 17:31:57.215329 (MainThread): On master: BEGIN
2022-08-01 17:31:57.215422 (MainThread): Opening a new connection, currently in state init
2022-08-01 17:31:57.927432 (MainThread): SQL status: SUCCESS 1 in 0.71 seconds
2022-08-01 17:31:57.927669 (MainThread): On master: COMMIT
2022-08-01 17:31:57.927803 (MainThread): Using snowflake connection "master".
2022-08-01 17:31:57.927865 (MainThread): On master: COMMIT
2022-08-01 17:31:58.064107 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 17:31:58.064284 (MainThread): On master: Close
2022-08-01 17:31:58.205065 (MainThread): 12:31:58 | Concurrency: 8 threads (target='dev')
2022-08-01 17:31:58.205426 (MainThread): 12:31:58 | 
2022-08-01 17:31:58.207660 (Thread-3): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:31:58.207877 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 17:31:58.208033 (Thread-1): Began running node model.fivetran_poc.events
2022-08-01 17:31:58.208385 (Thread-3): 12:31:58 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 17:31:58.208650 (Thread-2): 12:31:58 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 17:31:58.208963 (Thread-1): 12:31:58 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 17:31:58.209535 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:31:58.209810 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:31:58.210191 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 17:31:58.210326 (Thread-3): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 17:31:58.210462 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 17:31:58.210593 (Thread-1): Compiling model.fivetran_poc.events
2022-08-01 17:31:58.219334 (Thread-3): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:31:58.219486 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:31:58.224553 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:31:58.224784 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
where table_schema ilike '%POC%'
2022-08-01 17:31:58.224913 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
  select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
  where table_schema ilike '%POC%'
2022-08-01 17:31:58.225055 (Thread-2): Opening a new connection, currently in state init
2022-08-01 17:31:58.225167 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 17:31:58.226463 (Thread-3): finished collecting timing info
2022-08-01 17:31:58.255740 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 17:31:58.257838 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:31:58.258009 (Thread-3): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 17:31:58.258156 (Thread-3): Opening a new connection, currently in state init
2022-08-01 17:31:59.159130 (Thread-3): SQL status: SUCCESS 1 in 0.90 seconds
2022-08-01 17:31:59.159568 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:31:59.159733 (Thread-3): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 17:31:59.636348 (Thread-2): SQL status: SUCCESS 2 in 1.41 seconds
2022-08-01 17:31:59.637505 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:31:59.638796 (Thread-2): finished collecting timing info
2022-08-01 17:31:59.641554 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 17:31:59.643331 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:31:59.643454 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 17:31:59.714323 (Thread-3): SQL status: SUCCESS 1 in 0.55 seconds
2022-08-01 17:31:59.715334 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:31:59.715478 (Thread-3): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 17:31:59.715549 (Thread-3): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 17:31:59.738550 (Thread-2): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 17:31:59.738678 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:31:59.738750 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (






    
    




with source_data as (
    
    select * , 'POC_CLIENT_1_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_1_PUBLIC.candidates
    union all
    
    select * , 'POC_CLIENT_2_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_2_PUBLIC.candidates
    
    
)
select *
from source_data
      );
2022-08-01 17:31:59.796511 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:31:59.804741 (Thread-3): finished collecting timing info
2022-08-01 17:31:59.804889 (Thread-3): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 17:31:59.836300 (Thread-1): SQL status: SUCCESS 2 in 1.61 seconds
2022-08-01 17:31:59.836818 (Thread-1): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 17:31:59.837560 (Thread-1): finished collecting timing info
2022-08-01 17:31:59.839035 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 17:31:59.840146 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:31:59.840220 (Thread-1): On model.fivetran_poc.events: BEGIN
2022-08-01 17:31:59.936942 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed5cb7f0>]}
2022-08-01 17:31:59.937866 (Thread-3): 12:31:59 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 1.73s]
2022-08-01 17:31:59.938325 (Thread-3): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 17:31:59.940472 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 17:31:59.960003 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:31:59.960195 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:31:59.960627 (Thread-4): 12:31:59 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 17:31:59.983454 (Thread-1): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (




    
    




with source_data as (
    
    select * , 'POC_CLIENT_1_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_1_PUBLIC.events
    union all
    
    select * , 'POC_CLIENT_2_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_2_PUBLIC.events
    
    
)
select *
from source_data
      );
2022-08-01 17:31:59.984101 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:31:59.984455 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 17:31:59.986445 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:31:59.987945 (Thread-4): finished collecting timing info
2022-08-01 17:32:00.010728 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 17:32:00.011693 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:32:00.011797 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 17:32:00.011873 (Thread-4): Opening a new connection, currently in state init
2022-08-01 17:32:00.407517 (Thread-2): SQL status: SUCCESS 1 in 0.67 seconds
2022-08-01 17:32:00.408705 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 17:32:00.408896 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 17:32:00.408984 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 17:32:00.484163 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:32:00.485604 (Thread-2): finished collecting timing info
2022-08-01 17:32:00.485876 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 17:32:00.547718 (Thread-4): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:32:00.548254 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:32:00.548779 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 17:32:00.618283 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed610668>]}
2022-08-01 17:32:00.618818 (Thread-2): 12:32:00 | 2 of 4 OK created table model PUBLIC.candidates...................... [SUCCESS 1 in 2.41s]
2022-08-01 17:32:00.619020 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 17:32:00.780185 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2022-08-01 17:32:00.781231 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:32:00.781362 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 17:32:00.781427 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 17:32:00.867374 (Thread-4): SQL status: SUCCESS 1 in 0.09 seconds
2022-08-01 17:32:00.868046 (Thread-4): finished collecting timing info
2022-08-01 17:32:00.868174 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 17:32:00.985775 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed725f28>]}
2022-08-01 17:32:00.986150 (Thread-4): 12:32:00 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.00s]
2022-08-01 17:32:00.986292 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 17:32:01.402196 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2022-08-01 17:32:01.404306 (Thread-1): On model.fivetran_poc.events: COMMIT
2022-08-01 17:32:01.404613 (Thread-1): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 17:32:01.404790 (Thread-1): On model.fivetran_poc.events: COMMIT
2022-08-01 17:32:01.486200 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 17:32:01.487715 (Thread-1): finished collecting timing info
2022-08-01 17:32:01.487982 (Thread-1): On model.fivetran_poc.events: Close
2022-08-01 17:32:01.618652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1175acd-6c65-4418-9508-a67a2fb18889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed60fac8>]}
2022-08-01 17:32:01.619005 (Thread-1): 12:32:01 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 3.41s]
2022-08-01 17:32:01.619127 (Thread-1): Finished running node model.fivetran_poc.events
2022-08-01 17:32:01.633357 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 17:32:01.633567 (MainThread): Using snowflake connection "master".
2022-08-01 17:32:01.633646 (MainThread): On master: BEGIN
2022-08-01 17:32:01.633713 (MainThread): Opening a new connection, currently in state closed
2022-08-01 17:32:02.175920 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2022-08-01 17:32:02.176256 (MainThread): On master: COMMIT
2022-08-01 17:32:02.176595 (MainThread): Using snowflake connection "master".
2022-08-01 17:32:02.176818 (MainThread): On master: COMMIT
2022-08-01 17:32:02.327051 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-08-01 17:32:02.327308 (MainThread): On master: Close
2022-08-01 17:32:02.457027 (MainThread): 12:32:02 | 
2022-08-01 17:32:02.457216 (MainThread): 12:32:02 | Finished running 3 table models, 1 view model in 7.21s.
2022-08-01 17:32:02.457405 (MainThread): Connection 'master' was properly closed.
2022-08-01 17:32:02.457495 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 17:32:02.457652 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 17:32:02.457772 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 17:32:02.457867 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 17:32:02.462706 (MainThread): 
2022-08-01 17:32:02.462836 (MainThread): Completed successfully
2022-08-01 17:32:02.462985 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-08-01 17:32:02.463224 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaed57d6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec61b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaec674710>]}
2022-08-01 17:32:02.463424 (MainThread): Flushing usage events
2022-08-01 18:46:00.171454 (MainThread): Running with dbt=0.19.1
2022-08-01 18:46:01.332795 (MainThread): You have an incompatible version of 'pyarrow' installed, please install a version that adheres to: 'pyarrow<0.18.0,>=0.17.0; extra == "pandas"'
2022-08-01 18:46:01.403619 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/neelshgupta/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-08-01 18:46:01.405623 (MainThread): Tracking: tracking
2022-08-01 18:46:01.406094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde05a6ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde05a6f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde05a6cc0>]}
2022-08-01 18:46:01.420576 (MainThread): Partial parsing not enabled
2022-08-01 18:46:01.422007 (MainThread): Parsing macros/catalog.sql
2022-08-01 18:46:01.424855 (MainThread): Parsing macros/adapters.sql
2022-08-01 18:46:01.457434 (MainThread): Parsing macros/materializations/merge.sql
2022-08-01 18:46:01.459850 (MainThread): Parsing macros/materializations/view.sql
2022-08-01 18:46:01.461658 (MainThread): Parsing macros/materializations/table.sql
2022-08-01 18:46:01.466093 (MainThread): Parsing macros/materializations/incremental.sql
2022-08-01 18:46:01.480034 (MainThread): Parsing macros/core.sql
2022-08-01 18:46:01.485007 (MainThread): Parsing macros/materializations/helpers.sql
2022-08-01 18:46:01.494840 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-08-01 18:46:01.497317 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-08-01 18:46:01.577122 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-08-01 18:46:01.614240 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-08-01 18:46:01.637009 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-08-01 18:46:01.639297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-08-01 18:46:01.646260 (MainThread): Parsing macros/materializations/common/merge.sql
2022-08-01 18:46:01.661616 (MainThread): Parsing macros/materializations/table/table.sql
2022-08-01 18:46:01.669688 (MainThread): Parsing macros/materializations/view/view.sql
2022-08-01 18:46:01.676746 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-08-01 18:46:01.682301 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-08-01 18:46:01.684046 (MainThread): Parsing macros/etc/query.sql
2022-08-01 18:46:01.685476 (MainThread): Parsing macros/etc/is_incremental.sql
2022-08-01 18:46:01.687479 (MainThread): Parsing macros/etc/datetime.sql
2022-08-01 18:46:01.696895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-08-01 18:46:01.699673 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-08-01 18:46:01.702149 (MainThread): Parsing macros/adapters/common.sql
2022-08-01 18:46:01.746228 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-08-01 18:46:01.748519 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-08-01 18:46:01.750460 (MainThread): Parsing macros/schema_tests/unique.sql
2022-08-01 18:46:01.753455 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-08-01 18:46:01.761459 (MainThread): Partial parsing not enabled
2022-08-01 18:46:01.785630 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 18:46:01.795823 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 18:46:01.799662 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:01.807259 (MainThread): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:01.901333 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2022-08-01 18:46:01.902086 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde08bdc50>]}
2022-08-01 18:46:01.917237 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde08a9080>]}
2022-08-01 18:46:01.917541 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-08-01 18:46:01.918357 (MainThread): 
2022-08-01 18:46:01.918647 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 18:46:01.919586 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_COMBINE_DW".
2022-08-01 18:46:01.931854 (ThreadPoolExecutor-0_0): Using snowflake connection "list_COMBINE_DW".
2022-08-01 18:46:01.931984 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW"} */

    show terse schemas in database COMBINE_DW
    limit 10000
2022-08-01 18:46:01.932062 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-08-01 18:46:02.974477 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.04 seconds
2022-08-01 18:46:02.980621 (ThreadPoolExecutor-0_0): On list_COMBINE_DW: Close
2022-08-01 18:46:03.105969 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 18:46:03.112953 (ThreadPoolExecutor-1_0): Using snowflake connection "list_COMBINE_DW_PUBLIC".
2022-08-01 18:46:03.113108 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "connection_name": "list_COMBINE_DW_PUBLIC"} */

    show terse objects in COMBINE_DW.PUBLIC
2022-08-01 18:46:03.113194 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-08-01 18:46:03.705355 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.59 seconds
2022-08-01 18:46:03.706255 (ThreadPoolExecutor-1_0): On list_COMBINE_DW_PUBLIC: Close
2022-08-01 18:46:03.832703 (MainThread): Using snowflake connection "master".
2022-08-01 18:46:03.832843 (MainThread): On master: BEGIN
2022-08-01 18:46:03.832920 (MainThread): Opening a new connection, currently in state init
2022-08-01 18:46:04.356916 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 18:46:04.357251 (MainThread): On master: COMMIT
2022-08-01 18:46:04.357533 (MainThread): Using snowflake connection "master".
2022-08-01 18:46:04.357702 (MainThread): On master: COMMIT
2022-08-01 18:46:04.505226 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2022-08-01 18:46:04.505405 (MainThread): On master: Close
2022-08-01 18:46:04.625098 (MainThread): 13:46:04 | Concurrency: 8 threads (target='dev')
2022-08-01 18:46:04.625276 (MainThread): 13:46:04 | 
2022-08-01 18:46:04.626568 (Thread-1): Began running node model.fivetran_poc.my_first_dbt_model
2022-08-01 18:46:04.626727 (Thread-2): Began running node model.fivetran_poc.candidates
2022-08-01 18:46:04.626834 (Thread-3): Began running node model.fivetran_poc.events
2022-08-01 18:46:04.627031 (Thread-1): 13:46:04 | 1 of 4 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-08-01 18:46:04.627207 (Thread-2): 13:46:04 | 2 of 4 START table model PUBLIC.candidates........................... [RUN]
2022-08-01 18:46:04.627374 (Thread-3): 13:46:04 | 3 of 4 START table model PUBLIC.events............................... [RUN]
2022-08-01 18:46:04.627738 (Thread-1): Acquiring new snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 18:46:04.627995 (Thread-2): Acquiring new snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:04.628242 (Thread-3): Acquiring new snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:04.628365 (Thread-1): Compiling model.fivetran_poc.my_first_dbt_model
2022-08-01 18:46:04.628499 (Thread-2): Compiling model.fivetran_poc.candidates
2022-08-01 18:46:04.628627 (Thread-3): Compiling model.fivetran_poc.events
2022-08-01 18:46:04.630964 (Thread-1): Writing injected SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 18:46:04.635961 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:04.640989 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:04.641212 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */

    
select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
where table_schema ilike '%POC%'
2022-08-01 18:46:04.641333 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */

    
  select distinct TABLE_SCHEMA from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables
  where table_schema ilike '%POC%'
2022-08-01 18:46:04.641445 (Thread-2): Opening a new connection, currently in state init
2022-08-01 18:46:04.641552 (Thread-3): Opening a new connection, currently in state init
2022-08-01 18:46:04.643946 (Thread-1): finished collecting timing info
2022-08-01 18:46:04.674032 (Thread-1): Writing runtime SQL for node "model.fivetran_poc.my_first_dbt_model"
2022-08-01 18:46:04.675967 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 18:46:04.676063 (Thread-1): On model.fivetran_poc.my_first_dbt_model: BEGIN
2022-08-01 18:46:04.676137 (Thread-1): Opening a new connection, currently in state closed
2022-08-01 18:46:05.589142 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2022-08-01 18:46:05.589319 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 18:46:05.589428 (Thread-1): On model.fivetran_poc.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_first_dbt_model"} */


      create or replace transient table COMBINE_DW.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-08-01 18:46:06.694998 (Thread-3): SQL status: SUCCESS 2 in 2.05 seconds
2022-08-01 18:46:06.697951 (Thread-3): Writing injected SQL for node "model.fivetran_poc.events"
2022-08-01 18:46:06.704766 (Thread-3): finished collecting timing info
2022-08-01 18:46:06.708210 (Thread-3): Writing runtime SQL for node "model.fivetran_poc.events"
2022-08-01 18:46:06.712712 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:06.712859 (Thread-3): On model.fivetran_poc.events: BEGIN
2022-08-01 18:46:06.746110 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2022-08-01 18:46:06.747204 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 18:46:06.747358 (Thread-1): Using snowflake connection "model.fivetran_poc.my_first_dbt_model".
2022-08-01 18:46:06.747458 (Thread-1): On model.fivetran_poc.my_first_dbt_model: COMMIT
2022-08-01 18:46:06.813339 (Thread-3): SQL status: SUCCESS 1 in 0.10 seconds
2022-08-01 18:46:06.813632 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:06.813794 (Thread-3): On model.fivetran_poc.events: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.events"} */


      create or replace transient table COMBINE_DW.PUBLIC.events  as
      (




    
    




with source_data as (
    
    select * , 'POC_CLIENT_1_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_1_PUBLIC.events
    union all
    
    select * , 'POC_CLIENT_2_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_2_PUBLIC.events
    
    
)
select *
from source_data
      );
2022-08-01 18:46:06.828967 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 18:46:06.842140 (Thread-1): finished collecting timing info
2022-08-01 18:46:06.842337 (Thread-1): On model.fivetran_poc.my_first_dbt_model: Close
2022-08-01 18:46:06.846963 (Thread-2): SQL status: SUCCESS 2 in 2.21 seconds
2022-08-01 18:46:06.847557 (Thread-2): Writing injected SQL for node "model.fivetran_poc.candidates"
2022-08-01 18:46:06.852642 (Thread-2): finished collecting timing info
2022-08-01 18:46:06.854773 (Thread-2): Writing runtime SQL for node "model.fivetran_poc.candidates"
2022-08-01 18:46:06.859422 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:06.859563 (Thread-2): On model.fivetran_poc.candidates: BEGIN
2022-08-01 18:46:06.961629 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0e2e9e8>]}
2022-08-01 18:46:06.962132 (Thread-1): 13:46:06 | 1 of 4 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.33s]
2022-08-01 18:46:06.962340 (Thread-1): Finished running node model.fivetran_poc.my_first_dbt_model
2022-08-01 18:46:06.962925 (Thread-4): Began running node model.fivetran_poc.my_second_dbt_model
2022-08-01 18:46:06.963251 (Thread-4): 13:46:06 | 4 of 4 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-08-01 18:46:06.963660 (Thread-4): Acquiring new snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 18:46:06.963828 (Thread-4): Compiling model.fivetran_poc.my_second_dbt_model
2022-08-01 18:46:06.966648 (Thread-4): Writing injected SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 18:46:06.968029 (Thread-4): finished collecting timing info
2022-08-01 18:46:06.978825 (Thread-2): SQL status: SUCCESS 1 in 0.12 seconds
2022-08-01 18:46:06.985288 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:06.985402 (Thread-2): On model.fivetran_poc.candidates: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.candidates"} */


      create or replace transient table COMBINE_DW.PUBLIC.candidates  as
      (






    
    




with source_data as (
    
    select * , 'POC_CLIENT_1_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_1_PUBLIC.candidates
    union all
    
    select * , 'POC_CLIENT_2_PUBLIC' as client_name
    from FIVETRAN_DATABASE.POC_CLIENT_2_PUBLIC.candidates
    
    
)
select *
from source_data
      );
2022-08-01 18:46:06.986449 (Thread-4): Writing runtime SQL for node "model.fivetran_poc.my_second_dbt_model"
2022-08-01 18:46:06.988532 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 18:46:06.988656 (Thread-4): On model.fivetran_poc.my_second_dbt_model: BEGIN
2022-08-01 18:46:06.989040 (Thread-4): Opening a new connection, currently in state init
2022-08-01 18:46:07.509935 (Thread-4): SQL status: SUCCESS 1 in 0.52 seconds
2022-08-01 18:46:07.510255 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 18:46:07.510427 (Thread-4): On model.fivetran_poc.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "fivetran_poc", "target_name": "dev", "node_id": "model.fivetran_poc.my_second_dbt_model"} */

  create or replace  view COMBINE_DW.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from COMBINE_DW.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-08-01 18:46:07.718495 (Thread-4): SQL status: SUCCESS 1 in 0.21 seconds
2022-08-01 18:46:07.719450 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 18:46:07.719583 (Thread-4): Using snowflake connection "model.fivetran_poc.my_second_dbt_model".
2022-08-01 18:46:07.719653 (Thread-4): On model.fivetran_poc.my_second_dbt_model: COMMIT
2022-08-01 18:46:07.752034 (Thread-2): SQL status: SUCCESS 1 in 0.77 seconds
2022-08-01 18:46:07.752968 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 18:46:07.753096 (Thread-2): Using snowflake connection "model.fivetran_poc.candidates".
2022-08-01 18:46:07.753166 (Thread-2): On model.fivetran_poc.candidates: COMMIT
2022-08-01 18:46:07.798513 (Thread-4): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 18:46:07.799541 (Thread-4): finished collecting timing info
2022-08-01 18:46:07.799813 (Thread-4): On model.fivetran_poc.my_second_dbt_model: Close
2022-08-01 18:46:07.830577 (Thread-2): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 18:46:07.831291 (Thread-2): finished collecting timing info
2022-08-01 18:46:07.831420 (Thread-2): On model.fivetran_poc.candidates: Close
2022-08-01 18:46:07.833930 (Thread-3): SQL status: SUCCESS 1 in 1.02 seconds
2022-08-01 18:46:07.834901 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 18:46:07.835097 (Thread-3): Using snowflake connection "model.fivetran_poc.events".
2022-08-01 18:46:07.835168 (Thread-3): On model.fivetran_poc.events: COMMIT
2022-08-01 18:46:07.917988 (Thread-3): SQL status: SUCCESS 1 in 0.08 seconds
2022-08-01 18:46:07.919276 (Thread-3): finished collecting timing info
2022-08-01 18:46:07.919428 (Thread-3): On model.fivetran_poc.events: Close
2022-08-01 18:46:07.920529 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0cd3ef0>]}
2022-08-01 18:46:07.920801 (Thread-4): 13:46:07 | 4 of 4 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 0.96s]
2022-08-01 18:46:07.921129 (Thread-4): Finished running node model.fivetran_poc.my_second_dbt_model
2022-08-01 18:46:07.959374 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0d17b00>]}
2022-08-01 18:46:07.960122 (Thread-2): 13:46:07 | 2 of 4 OK created table model PUBLIC.candidates...................... [SUCCESS 1 in 3.33s]
2022-08-01 18:46:07.960354 (Thread-2): Finished running node model.fivetran_poc.candidates
2022-08-01 18:46:08.039480 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ab8879-7d31-40e3-b2eb-ff022e83bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0d0e3c8>]}
2022-08-01 18:46:08.039809 (Thread-3): 13:46:08 | 3 of 4 OK created table model PUBLIC.events.......................... [SUCCESS 1 in 3.41s]
2022-08-01 18:46:08.039923 (Thread-3): Finished running node model.fivetran_poc.events
2022-08-01 18:46:08.045912 (MainThread): Acquiring new snowflake connection "master".
2022-08-01 18:46:08.046097 (MainThread): Using snowflake connection "master".
2022-08-01 18:46:08.046230 (MainThread): On master: BEGIN
2022-08-01 18:46:08.046311 (MainThread): Opening a new connection, currently in state closed
2022-08-01 18:46:08.560268 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2022-08-01 18:46:08.560702 (MainThread): On master: COMMIT
2022-08-01 18:46:08.561028 (MainThread): Using snowflake connection "master".
2022-08-01 18:46:08.561213 (MainThread): On master: COMMIT
2022-08-01 18:46:08.699785 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2022-08-01 18:46:08.699994 (MainThread): On master: Close
2022-08-01 18:46:08.830736 (MainThread): 13:46:08 | 
2022-08-01 18:46:08.830915 (MainThread): 13:46:08 | Finished running 3 table models, 1 view model in 6.91s.
2022-08-01 18:46:08.831015 (MainThread): Connection 'master' was properly closed.
2022-08-01 18:46:08.831079 (MainThread): Connection 'model.fivetran_poc.my_first_dbt_model' was properly closed.
2022-08-01 18:46:08.831137 (MainThread): Connection 'model.fivetran_poc.candidates' was properly closed.
2022-08-01 18:46:08.831191 (MainThread): Connection 'model.fivetran_poc.events' was properly closed.
2022-08-01 18:46:08.831244 (MainThread): Connection 'model.fivetran_poc.my_second_dbt_model' was properly closed.
2022-08-01 18:46:08.841466 (MainThread): 
2022-08-01 18:46:08.841613 (MainThread): Completed successfully
2022-08-01 18:46:08.841732 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-08-01 18:46:08.841924 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0cb8cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0cc0f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffde0c93358>]}
2022-08-01 18:46:08.842108 (MainThread): Flushing usage events
